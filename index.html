<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>HANNAH</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Home";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> HANNAH
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href=".">Home</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="fallacies/">Fallacies and Pitfalls</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="configuration/configuration/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="configuration/configuration/multi_gpu/">Multi-GPU support</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Compression</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="compression/compression/quantization/">Quantization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="compression/compression/pruning/">Pruning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="compression/compression/clustering/">Clustering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="compression/compression/decomposition/">Tensor Decompositions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="compression/compresseion/knowledge_distillation/">Knowledge Distillation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Optimization</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="optimization/optimization/hyperparameter/">Hyperparameter Optimization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="optimization/optimization/nas/">Neural Architecture Search</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="deployment/deployment/torchmobile/">Torch Mobile</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="deployment/deployment/trax-Ultratrail/">T-Rax Ultratrail</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="deployment/deployment/tvm/">TVM</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Evaluation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="evaluation/eval/">Evaluation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="development/devel/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="development/devel/debugging/">Debugging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="development/devel/profiling/">Profiling</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="development/devel/api/">API Documentation</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">HANNAH</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Home</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <!--
Copyright (c) 2022 University of TÃ¼bingen.

This file is part of hannah.
See https://atreus.informatik.uni-tuebingen.de/ties/ai/hannah/hannah for further info.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<h1 id="hannah-hardware-accelerator-and-neural-network-search">HANNAH - Hardware Accelerator and Neural network searcH</h1>
<h1 id="getting-started">Getting Started</h1>
<h2 id="installing-dependencies">Installing dependencies</h2>
<p>Dependencies and virtual environments are managed using <a href="https://python-poetry.org/">poetry</a>.</p>
<ul>
<li>python (&gt;=3.8 &lt;3.10) and development headers</li>
<li>libsndfile and development headers</li>
<li>libsox and development headers</li>
<li>a blas implementation and development headers</li>
<li>git-lfs for management of checkpoints</li>
</ul>
<h3 id="ubuntu-2004">Ubuntu 20.04+</h3>
<p>Install dependencies:</p>
<pre><code>sudo apt update
sudo apt -y install python3-dev libblas-dev liblapack-dev libsndfile1-dev libsox-dev git-lfs
</code></pre>
<h3 id="centos-rhel-scientific-linux-7">Centos / RHEL / Scientific Linux: 7+</h3>
<p>Install dependencies:</p>
<pre><code>sudo yum install portaudio-devel libsndfile1-devel libsox-devel -y
</code></pre>
<p>Install a python 3.8 or python 3.9 version using <a href="https://github.com/pyenv/pyenv">pyenv</a>.</p>
<h3 id="install-poetry">Install poetry</h3>
<pre><code>curl -sSL https://install.python-poetry.org/ | python3
</code></pre>
<p>For alternative installation methods see:  https://python-poetry.org/docs/#installation</p>
<p><strong>Caution</strong>: this usually install poetry to ~/.local/bin if this folder is not in your path you might need to run poetry as:</p>
<pre><code>~/.local/bin/poetry
</code></pre>
<h2 id="software-installation">Software installation</h2>
<p>In the root directory of the project run:</p>
<pre><code>git submodule update --init --recursive
poetry install
</code></pre>
<p>This creates a virtual environment under ~/.cache/pypoetry/virtualenvs.</p>
<p>The environment can be activated using:</p>
<pre><code>poetry shell
</code></pre>
<h3 id="optional-dependencies">Optional Dependencies</h3>
<p>Vision models require additional dependencies, these can be installed using:</p>
<pre><code>poetry install -E vision
</code></pre>
<h3 id="installation-tips">Installation Tips</h3>
<p>1.) venv location</p>
<p>poetry installs the dependencies to a virtual environment in ~/.cache/pypoetry/virtualenvs</p>
<p>You can change the location of this directory using:</p>
<pre><code>poetry config virtualenvs.path  &lt;desired virtual environment path&gt;
</code></pre>
<p>Or move it to a subdirectory of the project directory using:</p>
<pre><code>poetry config virtualenvs.in-project true
</code></pre>
<p>2.) On lucille</p>
<p>Put the following in <code>.config/pip/pip.conf</code> until</p>
<pre><code>[global]
timeout = 60
extra-index-url = https://atreus.informatik.uni-tuebingen.de/~gerum/dist/
</code></pre>
<p>And install pytorch manually in your poetry env.</p>
<pre><code>poetry shell
pip install torch==1.8.1 torchvision torchaudio
</code></pre>
<p>And you might need to deactivate your conda environment:</p>
<pre><code>conda deactivate
</code></pre>
<h2 id="installing-the-datasets">Installing the datasets</h2>
<p>Datasets are downloaded automatically to the datasets data folder by default this is a subfolder of the dataset's data folder.</p>
<p>For the VAD Dataset the following Flag is needed to Download/Override the Dataset</p>
<pre><code>dataset.override=True
</code></pre>
<h2 id="training-keyword-spotting">Training - Keyword Spotting</h2>
<p>Training is invoked by</p>
<pre><code>hannah-train
</code></pre>
<p>If available the first GPU of the system will be used by default. Selecting another GPU is possible using the argument trainer.<code>gpus=[number]</code>
e.g. for GPU 2 use:</p>
<pre><code>hannah-train trainer.gpus=[2]
</code></pre>
<p>Trained models are saved under <code>trained_models/&lt;experiment_id&gt;/&lt;model_name&gt;</code>.</p>
<h2 id="training-vad">Training - VAD</h2>
<p>Training of VAD is invoked by</p>
<pre><code>hannah-train dataset=vad model.n_labels=2
</code></pre>
<p>Training of VAD_Extended is invoked by</p>
<pre><code>hannah-train dataset=vad_extended model.n_labels=2
</code></pre>
<h3 id="vad-dataset-variants">VAD dataset variants</h3>
<p>Selection of other Voice Dataset use  <code>dataset.variants="[UWNU, de, en, it, fr, es]"</code></p>
<pre><code>hannah-train dataset=vad model.n_labels=2 dataset.variants="[UWNU, de, en, it, fr, es]"
</code></pre>
<p>Selection of other Noise Datasets use  <code>dataset.noise_dataset="[TUT]"</code></p>
<pre><code>hannah-train dataset=vad model.n_labels=2 dataset.noise_dataset="[TUT]"
</code></pre>
<p>Selection of dataset Split use  <code>dataset.data_split="vad_balanced"</code></p>
<pre><code>hannah-train dataset=vad model.n_labels=2 dataset.data_split="vad_balanced"
</code></pre>
<p>Create Vad_small Dataset</p>
<pre><code>hannah-train dataset=vad model.n_labels=2 dataset.variants="[UWNU]" dataset.noise_dataset="[TUT]" dataset.data_split="vad_balanced"
</code></pre>
<p>Create VAD_big Dataset</p>
<pre><code>hannah-train dataset=vad model.n_labels=2 dataset.variants="[UWNU, en, de, fr, es, it]" dataset.noise_dataset="[TUT, FSD50K]" dataset.data_split="vad_balanced"
</code></pre>
<h2 id="training-pamap2">Training - PAMAP2</h2>
<p>Training of PAMAP2 human activity detection dataset is invoked by:</p>
<pre><code>hannah-train -cn config_activity
</code></pre>
<h2 id="training-emergency-siren-dataset">Training - Emergency Siren Dataset</h2>
<p>Training of emergency siren detection dataset is invoked by:</p>
<pre><code>hannah-train -cn config_siren_detection
</code></pre>
<h1 id="parallel-launchers">Parallel Launchers</h1>
<p>To launch multiple optimizations in parallel you can use a hydra launcher. The optuna Package must be installed first</p>
<pre><code>poetry run pip install hydra-optuna-sweeper==1.1.1
</code></pre>
<p>Joblib launcher is installed by default:</p>
<p>hannah-train --multirun hydra/sweeper=optuna hydra/launcher=joblib optimizer.lr='interval(0.0001,0.1)' optimizer.weight_decay='interval(0, 0.1)' hydra.launcher.n_jobs=5</p>
<p>Launches optimizer hyperparameter optimization with 5 parallel jobs.</p>
<h1 id="early-stopping">Early stopping</h1>
<p>To stop training early when a validation metric does not improve, you can use lightning's early stopping callback:</p>
<pre><code>hannah-train early_stopping=default
</code></pre>
<h1 id="showing-graphical-results">Showing graphical results</h1>
<p>All experiments are logged to tensorboard: To visualize the results use:</p>
<pre><code>tensorboard --logdir trained_models
</code></pre>
<p>or a subdirectory of trained models if only one experiment or model is of interest.</p>
<h1 id="development">Development</h1>
<p>This project uses precommit hooks for auto formatting and static code analysis.
To enable precommit hooks run the following command in a <code>poetry shell</code>.</p>
<pre><code> pre-commit install
</code></pre>
<p>Try to follow <a href="https://pep8.org/#naming-conventions">pep8</a> naming conventions and the rest of pep8 to the
best of your abilities.</p>
<h2 id="resolving-merge-conflicts-in-poetrylock">Resolving merge conflicts in <code>poetry.lock</code></h2>
<p>If you have changed <code>poetry.lock</code> this can result in merge conflicts.</p>
<p>The easiest way to resolve them is:</p>
<pre><code>git checkout --theirs poetry.lock
poetry lock --no-update
</code></pre>
<p>Try to avoid running <code>poetry update</code> on feature branches.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="fallacies/" class="btn btn-neutral float-right" title="Fallacies and Pitfalls">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="fallacies/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

<!--
MkDocs version : 1.4.2
Build Date UTC : 2022-12-23 21:24:21.773355+00:00
-->
