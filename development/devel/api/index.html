<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>API Documentation - HANNAH</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API Documentation";
        var mkdocs_page_input_path = "development/devel/api.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> HANNAH
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../fallacies/">Fallacies and Pitfalls</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../publications/">Publications</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../experiments/">Experiment Management</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../configuration/configuration/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../configuration/configuration/multi_gpu/">Multi-GPU support</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Compression</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../compression/compression/quantization/">Quantization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../compression/compression/pruning/">Pruning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../compression/compression/clustering/">Clustering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../compression/compression/decomposition/">Tensor Decompositions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../compression/compression/knowledge_distillation/">Knowledge Distillation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Optimization</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../optimization/optimization/hyperparameter/">Hyperparameter Optimization</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Neural Architecture Search</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../neural-architecture-search/nas/legacy/">NAS (Legacy)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../neural-architecture-search/nas/usage/">Usage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../neural-architecture-search/nas/search_spaces/">Search Spaces</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../neural-architecture-search/nas/parametrization/">Parametrization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../neural-architecture-search/nas/search/">Search</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../neural-architecture-search/nas/eval/">Evaluating Results</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../neural-architecture-search/nas/metrics/">Optimization Metrics</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../deployment/deployment/torchmobile/">Torch Mobile</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../deployment/deployment/trax-Ultratrail/">T-Rax Ultratrail</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../deployment/deployment/tvm/">TVM</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../deployment/deployment/tensorrt/">TensorRT</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Evaluation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../evaluation/eval/">Evaluation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Specific applications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../specific-applications/applications/seizure_detection/">Seizure Detection</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../debugging/">Debugging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../profiling/">Profiling</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">API Documentation</a>
    <ul class="current">
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">HANNAH</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Development</li>
      <li class="breadcrumb-item active">API Documentation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p><a id="hannah.trainer.cross_validation"></a></p>
<h1 id="hannahtrainercross_validation">hannah.trainer.cross_validation</h1>
<p><a id="hannah.trainer"></a></p>
<h1 id="hannahtrainer">hannah.trainer</h1>
<p><a id="hannah.visualization"></a></p>
<h1 id="hannahvisualization">hannah.visualization</h1>
<p><a id="hannah.backends.onnxrt"></a></p>
<h1 id="hannahbackendsonnxrt">hannah.backends.onnxrt</h1>
<p><a id="hannah.backends.onnxrt.OnnxruntimeBackend"></a></p>
<h2 id="onnxruntimebackend-objects">OnnxruntimeBackend Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">OnnxruntimeBackend</span><span class="p">(</span><span class="n">InferenceBackendBase</span><span class="p">)</span>
</code></pre></div>

<p>Inference Backend for tensorflow</p>
<p><a id="hannah.backends.base"></a></p>
<h1 id="hannahbackendsbase">hannah.backends.base</h1>
<p><a id="hannah.backends.base.ProfilingResult"></a></p>
<h2 id="profilingresult-objects">ProfilingResult Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ProfilingResult</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">)</span>
</code></pre></div>

<p>Result of a profiling run</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>outputs</code> - the outputs of the model on the given input batch</li>
<li><code>metrics</code> - a dictionary containing the combined metrics obtained from the profiling run</li>
<li><code>profile</code> - the raw profile in a backend-specific format</li>
</ul>
<p><a id="hannah.backends.base.AbstractBackend"></a></p>
<h2 id="abstractbackend-objects">AbstractBackend Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AbstractBackend</span><span class="p">(</span><span class="n">ABC</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.backends.base.AbstractBackend.prepare"></a></p>
<h4 id="prepare">prepare</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">ClassifierModule</span><span class="p">)</span>
</code></pre></div>

<p>Prepare the model for execution on the target device</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>module</code> - the classifier module to be exported</li>
</ul>
<p><a id="hannah.backends.base.AbstractBackend.run"></a></p>
<h4 id="run">run</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>
</code></pre></div>

<p>Run a batch on the target device</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li>
<p><code>inputs</code> - a list of torch tensors representing the inputs to be run on the target device, each tensor represents a whole batched input, so for models taking 1 parameter, the list will contain 1 tensor of shape (batch_size, *input_shape)</p>
</li>
<li>
<p><code>Returns</code> - the output(s) of the model as a torch tensor or a Sequence of torch tensors for models producing multiple outputs</p>
</li>
</ul>
<p><a id="hannah.backends.base.AbstractBackend.profile"></a></p>
<h4 id="profile">profile</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProfilingResult</span>
</code></pre></div>

<p>Do a profiling run on the target device</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li>
<p><code>inputs</code> - a list of torch tensors representing the inputs to be run on the target device, each tensor represents a whole batched input, so for models taking 1 parameter, the list will contain 1 tensor of shape (batch_size, *input_shape)</p>
</li>
<li>
<p><code>Returns</code> - a ProfilingResult object containing the outputs of the model, the metrics obtained from the profiling run and the raw profile in a backend-specific format</p>
</li>
</ul>
<p><a id="hannah.backends.base.AbstractBackend.available"></a></p>
<h4 id="available">available</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">available</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>Check if the backend is available</p>
<p>Returns: True if the backend is available, False otherwise</p>
<p><a id="hannah.backends.base.AbstractBackend.export"></a></p>
<h4 id="export">export</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">export</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Export the model through the target backend</p>
<p><a id="hannah.backends.base.InferenceBackendBase"></a></p>
<h2 id="inferencebackendbase-objects">InferenceBackendBase Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">InferenceBackendBase</span><span class="p">(</span><span class="n">AbstractBackend</span><span class="p">)</span>
</code></pre></div>

<p>Base class for backends, it is only here for backwards compatibility reasons, use AbstractBackend instead</p>
<p><a id="hannah.backends.torch_mobile"></a></p>
<h1 id="hannahbackendstorch_mobile">hannah.backends.torch_mobile</h1>
<p><a id="hannah.backends.torch_mobile.TorchMobileBackend"></a></p>
<h2 id="torchmobilebackend-objects">TorchMobileBackend Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TorchMobileBackend</span><span class="p">(</span><span class="n">InferenceBackendBase</span><span class="p">)</span>
</code></pre></div>

<p>Inference backend for torch mobile</p>
<p><a id="hannah.backends.utils"></a></p>
<h1 id="hannahbackendsutils">hannah.backends.utils</h1>
<p><a id="hannah.backends.utils.symbolic_batch_dim"></a></p>
<h4 id="symbolic_batch_dim">symbolic_batch_dim</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">symbolic_batch_dim</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>make the batch dimension symbolic for onnx models</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>model</code> - onnx model</li>
</ul>
<p><a id="hannah.backends.tensorrt"></a></p>
<h1 id="hannahbackendstensorrt">hannah.backends.tensorrt</h1>
<p><a id="hannah.backends.tensorrt.TensorRTBackend"></a></p>
<h2 id="tensorrtbackend-objects">TensorRTBackend Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TensorRTBackend</span><span class="p">(</span><span class="n">InferenceBackendBase</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.backends.tensorrt.TensorRTBackend.output_spec"></a></p>
<h4 id="output_spec">output_spec</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">output_spec</span><span class="p">()</span>
</code></pre></div>

<p>Get the specs for the output tensor of the network. Useful to prepare memory allocations.</p>
<p><strong>Returns</strong>:</p>
<p>Two items, the shape of the output tensor and its (numpy) datatype.</p>
<p><a id="hannah.backends"></a></p>
<h1 id="hannahbackends">hannah.backends</h1>
<p><a id="hannah.nn.quantized"></a></p>
<h1 id="hannahnnquantized">hannah.nn.quantized</h1>
<p><a id="hannah.nn.qat"></a></p>
<h1 id="hannahnnqat">hannah.nn.qat</h1>
<p>Implementations of torch.nn.intrinsics qat with an optional
quantize bias parameter.</p>
<p>Qconfigs can support an optional bias quantization funciton which should be returned by
 <code>qconfig.bias()</code> else biases will be quantized with <code>qconfig.activation()</code></p>
<p><a id="hannah.nn.qat._ConvBnNd"></a></p>
<h2 id="_convbnnd-objects">_ConvBnNd Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">_ConvBnNd</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">conv</span><span class="o">.</span><span class="n">_ConvNd</span><span class="p">,</span> <span class="n">_ConvForwardMixin</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nn.qat._ConvBnNd.train"></a></p>
<h4 id="train">train</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

<p>Batchnorm's training behavior is using the self.training flag. Prevent
changing it if BN is frozen. This makes sure that calling <code>model.train()</code>
on a model with a frozen BN will behave properly.</p>
<p><a id="hannah.nn.qat._ConvBnNd.from_float"></a></p>
<h4 id="from_float">from_float</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_float</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</code></pre></div>

<p>Create a qat module from a float module or qparams_dict
Args: <code>mod</code> a float module, either produced by torch.quantization utilities
or directly from user</p>
<p><a id="hannah.nn.qat.ConvBn1d"></a></p>
<h2 id="convbn1d-objects">ConvBn1d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConvBn1d</span><span class="p">(</span><span class="n">_ConvBnNd</span><span class="p">)</span>
</code></pre></div>

<p>A ConvBn1d module is a module fused from Conv1d and BatchNorm1d,
attached with FakeQuantize modules for weight,
used in quantization aware training.
We combined the interface of :class:<code>torch.nn.Conv1d</code> and
:class:<code>torch.nn.BatchNorm1d</code>.
Similar to :class:<code>torch.nn.Conv1d</code>, with FakeQuantize modules initialized
to default.</p>
<p><strong>Attributes</strong>:</p>
<p>freeze_bn:
- <code>weight_fake_quant</code> - fake quant module for weight</p>
<p><a id="hannah.nn.qat.ConvBnReLU1d"></a></p>
<h2 id="convbnrelu1d-objects">ConvBnReLU1d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConvBnReLU1d</span><span class="p">(</span><span class="n">ConvBn1d</span><span class="p">)</span>
</code></pre></div>

<p>A ConvBnReLU1d module is a module fused from Conv1d, BatchNorm1d and ReLU,
attached with FakeQuantize modules for weight,
used in quantization aware training.
We combined the interface of :class:<code>torch.nn.Conv1d</code> and
:class:<code>torch.nn.BatchNorm1d</code> and :class:<code>torch.nn.ReLU</code>.
Similar to <code>torch.nn.Conv1d</code>, with FakeQuantize modules initialized to
default.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>weight_fake_quant</code> - fake quant module for weight</li>
</ul>
<p><a id="hannah.nn.qat.ConvBn2d"></a></p>
<h2 id="convbn2d-objects">ConvBn2d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConvBn2d</span><span class="p">(</span><span class="n">_ConvBnNd</span><span class="p">)</span>
</code></pre></div>

<p>A ConvBn2d module is a module fused from Conv2d and BatchNorm2d,
attached with FakeQuantize modules for weight,
used in quantization aware training.
We combined the interface of :class:<code>torch.nn.Conv2d</code> and
:class:<code>torch.nn.BatchNorm2d</code>.
Similar to :class:<code>torch.nn.Conv2d</code>, with FakeQuantize modules initialized
to default.</p>
<p><strong>Attributes</strong>:</p>
<p>freeze_bn:
- <code>weight_fake_quant</code> - fake quant module for weight</p>
<p><a id="hannah.nn.qat.ConvBnReLU2d"></a></p>
<h2 id="convbnrelu2d-objects">ConvBnReLU2d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConvBnReLU2d</span><span class="p">(</span><span class="n">ConvBn2d</span><span class="p">)</span>
</code></pre></div>

<p>A ConvBnReLU2d module is a module fused from Conv2d, BatchNorm2d and ReLU,
attached with FakeQuantize modules for weight,
used in quantization aware training.
We combined the interface of :class:<code>torch.nn.Conv2d</code> and
:class:<code>torch.nn.BatchNorm2d</code> and :class:<code>torch.nn.ReLU</code>.
Similar to <code>torch.nn.Conv2d</code>, with FakeQuantize modules initialized to
default.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>weight_fake_quant</code> - fake quant module for weight</li>
</ul>
<p><a id="hannah.nn.qat.ConvReLU2d"></a></p>
<h2 id="convrelu2d-objects">ConvReLU2d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConvReLU2d</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">,</span> <span class="n">_ConvForwardMixin</span><span class="p">)</span>
</code></pre></div>

<p>A ConvReLU2d module is a fused module of Conv2d and ReLU, attached with
FakeQuantize modules for weight for
quantization aware training.
We combined the interface of :class:<code>~torch.nn.Conv2d</code> and
:class:<code>~torch.nn.BatchNorm2d</code>.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>weight_fake_quant</code> - fake quant module for weight</li>
</ul>
<p><a id="hannah.nn.qat.ConvReLU1d"></a></p>
<h2 id="convrelu1d-objects">ConvReLU1d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConvReLU1d</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">,</span> <span class="n">_ConvForwardMixin</span><span class="p">)</span>
</code></pre></div>

<p>A ConvReLU1d module is fused module of Conv1d and ReLU, attached with
FakeQuantize modules for quantization aware training</p>
<p><a id="hannah.nn.qat.Conv1d"></a></p>
<h2 id="conv1d-objects">Conv1d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Conv1d</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">,</span> <span class="n">_ConvForwardMixin</span><span class="p">)</span>
</code></pre></div>

<p>A Conv1d module is a Conv1d module , attached with
FakeQuantize modules for weight for
quantization aware training.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>weight_fake_quant</code> - fake quant module for weight</li>
<li><code>bias_fake_quant</code> - fake quant module for bias</li>
<li><code>activation_post_process</code> - fake_quant_module for activations</li>
</ul>
<p><a id="hannah.nn.qat.Conv2d"></a></p>
<h2 id="conv2d-objects">Conv2d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Conv2d</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">,</span> <span class="n">_ConvForwardMixin</span><span class="p">)</span>
</code></pre></div>

<p>A Conv2d module is a Conv2d module , attached with
FakeQuantize modules for weight for
quantization aware training.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>weight_fake_quant</code> - fake quant module for weight</li>
<li><code>bias_fake_quant</code> - fake quant module for bias</li>
<li><code>activation_post_process</code> - fake_quant_module for activations</li>
</ul>
<p><a id="hannah.nn.qat.Linear"></a></p>
<h2 id="linear-objects">Linear Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Linear</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">)</span>
</code></pre></div>

<p>A linear module attached with FakeQuantize modules for weight,
used for quantization aware training.</p>
<p>We adopt the same interface as <code>torch.nn.Linear</code>, please see
https://pytorch.org/docs/stable/nn.html#torch.nn.Linear
for documentation.</p>
<p>Similar to <code>torch.nn.Linear</code>, with FakeQuantize modules initialized to
default.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>weight</code> - fake quant module for weight</li>
</ul>
<p><a id="hannah.nn.qat.Linear.from_float"></a></p>
<h4 id="from_float_1">from_float</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_float</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</code></pre></div>

<p>Create a qat module from a float module or qparams_dict</p>
<p>Args: <code>mod</code> a float module, either produced by torch.quantization utilities
or directly from user</p>
<p><a id="hannah.nn.qat.LinearReLU"></a></p>
<h2 id="linearrelu-objects">LinearReLU Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">LinearReLU</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">)</span>
</code></pre></div>

<p>A linear module attached with FakeQuantize modules and ReLU for weight,
used for quantization aware training.</p>
<p>We adopt the same interface as <code>torch.nn.Linear</code>, please see
https://pytorch.org/docs/stable/nn.html#torch.nn.Linear
for documentation.</p>
<p>Similar to <code>torch.nn.Linear</code>, with FakeQuantize modules initialized to
default.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li><code>weight</code> - fake quant module for weight</li>
</ul>
<p><a id="hannah.nn.qat.LinearReLU.from_float"></a></p>
<h4 id="from_float_2">from_float</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_float</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</code></pre></div>

<p>Create a qat module from a float module or qparams_dict</p>
<p>Args: <code>mod</code> a float module, either produced by torch.quantization utilities
or directly from user</p>
<p><a id="hannah.nn.qat.Identity"></a></p>
<h2 id="identity-objects">Identity Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Identity</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">)</span>
</code></pre></div>

<p>A identity module attached with FakeQuantize modules for weight,
used for quantization aware training.</p>
<p>We adopt the same interface as <code>torch.nn.Identity</code>, please see
https://pytorch.org/docs/stable/nn.html#torch.nn.Identity
for documentation.</p>
<p>Similar to <code>torch.nn.Identity</code>, with FakeQuantize modules initialized to
default.</p>
<p><a id="hannah.nn.qat.Identity.from_float"></a></p>
<h4 id="from_float_3">from_float</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_float</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</code></pre></div>

<p>Create a qat module from a float module or qparams_dict</p>
<p>Args: <code>mod</code> a float module, either produced by torch.quantization utilities
or directly from user</p>
<p><a id="hannah.datasets.pickle_set"></a></p>
<h1 id="hannahdatasetspickle_set">hannah.datasets.pickle_set</h1>
<p><a id="hannah.datasets.pickle_set.PickleDataset"></a></p>
<h2 id="pickledataset-objects">PickleDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PickleDataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p>A dataset loading data from a number of pickle files</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.loader"></a></p>
<h4 id="loader">loader</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">loader</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p>Return the data loader for the dataset</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.prepare"></a></p>
<h4 id="prepare_1">prepare</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>

<p>Prepare the dataset</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.splits"></a></p>
<h4 id="splits">splits</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">splits</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>

<p>Return the dataset splits</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.class_names"></a></p>
<h4 id="class_names">class_names</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_names</span><span class="p">()</span>
</code></pre></div>

<p>Return the class names</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.class_counts"></a></p>
<h4 id="class_counts">class_counts</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_counts</span><span class="p">()</span>
</code></pre></div>

<p>Return the class counts</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.__getitem__"></a></p>
<h4 id="__getitem__">__getitem__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>

<p>Return the item at the index</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.__len__"></a></p>
<h4 id="__len__">__len__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">()</span>
</code></pre></div>

<p>Return the length of the dataset</p>
<p><a id="hannah.datasets.pickle_set.PickleDataset.max_workers"></a></p>
<h4 id="max_workers">max_workers</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">max_workers</span><span class="p">()</span>
</code></pre></div>

<p>Not really needed as the number of workers processes is defined by the loader() method</p>
<p><a id="hannah.datasets.DatasetSplit"></a></p>
<h1 id="hannahdatasetsdatasetsplit">hannah.datasets.DatasetSplit</h1>
<p><a id="hannah.datasets.emergency"></a></p>
<h1 id="hannahdatasetsemergency">hannah.datasets.emergency</h1>
<p><a id="hannah.datasets.emergency.EmergencySirenDataset"></a></p>
<h2 id="emergencysirendataset-objects">EmergencySirenDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">EmergencySirenDataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p>Emergency Dataset</p>
<p><a id="hannah.datasets.NoiseDataset"></a></p>
<h1 id="hannahdatasetsnoisedataset">hannah.datasets.NoiseDataset</h1>
<p><a id="hannah.datasets.Downsample"></a></p>
<h1 id="hannahdatasetsdownsample">hannah.datasets.Downsample</h1>
<p><a id="hannah.datasets.speech"></a></p>
<h1 id="hannahdatasetsspeech">hannah.datasets.speech</h1>
<p><a id="hannah.datasets.speech.SpeechDataset"></a></p>
<h2 id="speechdataset-objects">SpeechDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SpeechDataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p>Base Class for speech datasets</p>
<p><a id="hannah.datasets.speech.SpeechDataset.preprocess"></a></p>
<h4 id="preprocess">preprocess</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">silence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<p>Run preprocessing and feature extraction</p>
<p><a id="hannah.datasets.speech.SpeechCommandsDataset"></a></p>
<h2 id="speechcommandsdataset-objects">SpeechCommandsDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SpeechCommandsDataset</span><span class="p">(</span><span class="n">SpeechDataset</span><span class="p">)</span>
</code></pre></div>

<p>This class implements reading and preprocessing of speech commands like
dataset</p>
<p><a id="hannah.datasets.speech.SpeechHotwordDataset"></a></p>
<h2 id="speechhotworddataset-objects">SpeechHotwordDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SpeechHotwordDataset</span><span class="p">(</span><span class="n">SpeechDataset</span><span class="p">)</span>
</code></pre></div>

<p>Dataset Class for Hotword dataset e.g. Hey Snips!</p>
<p><a id="hannah.datasets.speech.SpeechHotwordDataset.splits"></a></p>
<h4 id="splits_1">splits</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">splits</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div>

<p>Splits the dataset in training, devlopment and test set and returns
the three sets as List</p>
<p><a id="hannah.datasets.speech.VadDataset"></a></p>
<h2 id="vaddataset-objects">VadDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">VadDataset</span><span class="p">(</span><span class="n">SpeechDataset</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.datasets.speech.VadDataset.splits"></a></p>
<h4 id="splits_2">splits</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">splits</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div>

<p>Splits the dataset in training, devlopment and test set and returns
the three sets as List</p>
<p><a id="hannah.datasets.eeg_chb"></a></p>
<h1 id="hannahdatasetseeg_chb">hannah.datasets.eeg_chb</h1>
<p><a id="hannah.datasets.eeg_chb.EEGDataset"></a></p>
<h2 id="eegdataset-objects">EEGDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">EEGDataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.datasets.eeg_chb.EEGDataset.class_names"></a></p>
<h4 id="class_names_1">class_names</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

<p>Returns the names of the classes in the classification dataset</p>
<p><a id="hannah.datasets.eeg_chb.EEGDataset.class_counts"></a></p>
<h4 id="class_counts_1">class_counts</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_counts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</code></pre></div>

<p>Returns the number of items in each class of the dataset</p>
<p>If this is not applicable to a dataset type e.g. ASR, Semantic Segmentation,
it may return None</p>
<p><a id="hannah.datasets.eeg_chb.EEGDataset.size"></a></p>
<h4 id="size">size</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">size</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

<p>Returns dimension of output without batch dimension</p>
<p><a id="hannah.datasets.base"></a></p>
<h1 id="hannahdatasetsbase">hannah.datasets.base</h1>
<p><a id="hannah.datasets.base.DatasetType"></a></p>
<h2 id="datasettype-objects">DatasetType Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DatasetType</span><span class="p">(</span><span class="n">Enum</span><span class="p">)</span>
</code></pre></div>

<p>The type of a dataset partition e.g. train, dev, test</p>
<p><a id="hannah.datasets.base.AbstractDataset"></a></p>
<h2 id="abstractdataset-objects">AbstractDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AbstractDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">ABC</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.datasets.base.AbstractDataset.prepare"></a></p>
<h4 id="prepare_2">prepare</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Prepare the dataset.</p>
<p>This method is run at the beginning of the dataset training.</p>
<p>If possible it should download the dataset from its original source, if
it is available for public download.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> <em>Dict[Any]</em> - The dataset configuration</li>
</ul>
<p><a id="hannah.datasets.base.AbstractDataset.splits"></a></p>
<h4 id="splits_3">splits</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">splits</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;AbstractDataset&quot;</span><span class="p">,</span> <span class="s2">&quot;AbstractDataset&quot;</span><span class="p">,</span> <span class="s2">&quot;AbstractDataset&quot;</span><span class="p">]</span>
</code></pre></div>

<p>Returns the test, validation and train split according to the Dataset config</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> <em>[type]</em> - [description]</li>
</ul>
<p><a id="hannah.datasets.base.AbstractDataset.class_names"></a></p>
<h4 id="class_names_2">class_names</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">class_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

<p>Returns the names of the classes in the classification dataset</p>
<p><a id="hannah.datasets.base.AbstractDataset.class_counts"></a></p>
<h4 id="class_counts_2">class_counts</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">class_counts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</code></pre></div>

<p>Returns the number of items in each class of the dataset</p>
<p>If this is not applicable to a dataset type e.g. ASR, Semantic Segementation,
it may return None</p>
<p><a id="hannah.datasets.base.AbstractDataset.__getitem__"></a></p>
<h4 id="__getitem___1">__getitem__</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
</code></pre></div>

<p>Returns a torch.Tensor for the data item at the corresponding index</p>
<p>The length of the list depends on the dataset item to use</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>index</code> <em>int</em> - the index of the data item</li>
</ul>
<p><a id="hannah.datasets.base.AbstractDataset.__len__"></a></p>
<h4 id="__len___1">__len__</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="fm">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

<p>Returns number of samples in dataset</p>
<p><a id="hannah.datasets.base.AbstractDataset.size"></a></p>
<h4 id="size_1">size</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">size</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

<p>Returns dimension of output without batch dimension</p>
<p><a id="hannah.datasets.base.AbstractDataset.std"></a></p>
<h4 id="std">std</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">std</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</code></pre></div>

<p>Returns channel-wise standard deviation for dataset if applicable</p>
<p><a id="hannah.datasets.base.AbstractDataset.mean"></a></p>
<h4 id="mean">mean</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">mean</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</code></pre></div>

<p>Returns channel-wise means for dataset if applicable</p>
<p><a id="hannah.datasets.base.AbstractDataset.resolution"></a></p>
<h4 id="resolution">resolution</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">resolution</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</code></pre></div>

<p>Returns resolution for dataset if applicable</p>
<p><a id="hannah.datasets.base.AbstractDataset.weights"></a></p>
<h4 id="weights">weights</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">weights</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

<p>Class weights for weighted sampling</p>
<p><a id="hannah.datasets.base.AbstractDataset.sequential"></a></p>
<h4 id="sequential">sequential</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">sequential</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>Returns true if this dataset should only be iterated sequentially</p>
<p><a id="hannah.datasets.base.AbstractDataset.max_workers"></a></p>
<h4 id="max_workers_1">max_workers</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">max_workers</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

<p>Returns the maximum number of workers useable for this dataset</p>
<p><a id="hannah.datasets.eeg_tusz"></a></p>
<h1 id="hannahdatasetseeg_tusz">hannah.datasets.eeg_tusz</h1>
<p><a id="hannah.datasets.eeg_tusz.EEGDataset"></a></p>
<h2 id="eegdataset-objects_1">EEGDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">EEGDataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.datasets.eeg_tusz.EEGDataset.class_names"></a></p>
<h4 id="class_names_3">class_names</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

<p>Returns the names of the classes in the classification dataset</p>
<p><a id="hannah.datasets.eeg_tusz.EEGDataset.class_counts"></a></p>
<h4 id="class_counts_3">class_counts</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_counts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</code></pre></div>

<p>Returns the number of items in each class of the dataset</p>
<p>If this is not applicable to a dataset type e.g. ASR, Semantic Segmentation,
it may return None</p>
<p><a id="hannah.datasets.eeg_tusz.EEGDataset.size"></a></p>
<h4 id="size_2">size</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">size</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

<p>Returns dimension of output without batch dimension</p>
<p><a id="hannah.datasets.Kitti"></a></p>
<h1 id="hannahdatasetskitti">hannah.datasets.Kitti</h1>
<p><a id="hannah.datasets.Kitti.Kitti"></a></p>
<h2 id="kitti-objects">Kitti Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Kitti</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.datasets.Kitti.Kitti.splits"></a></p>
<h4 id="splits_4">splits</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">splits</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div>

<p>Splits the dataset in training, devlopment and test set and returns
the three sets as List</p>
<p><a id="hannah.datasets.directional"></a></p>
<h1 id="hannahdatasetsdirectional">hannah.datasets.directional</h1>
<p><a id="hannah.datasets.directional.DirectionalDataset"></a></p>
<h2 id="directionaldataset-objects">DirectionalDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DirectionalDataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p>Directional Dataset</p>
<p><a id="hannah.datasets.fake1d"></a></p>
<h1 id="hannahdatasetsfake1d">hannah.datasets.fake1d</h1>
<p><a id="hannah.datasets.physio"></a></p>
<h1 id="hannahdatasetsphysio">hannah.datasets.physio</h1>
<p><a id="hannah.datasets.physio.AtrialFibrillationDataset"></a></p>
<h2 id="atrialfibrillationdataset-objects">AtrialFibrillationDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AtrialFibrillationDataset</span><span class="p">(</span><span class="n">PhysioDataset</span><span class="p">)</span>
</code></pre></div>

<p>Atrial Fibrillation Database (https://physionet.org/content/afdb/1.0.0/)</p>
<p><a id="hannah.datasets.collate"></a></p>
<h1 id="hannahdatasetscollate">hannah.datasets.collate</h1>
<p><a id="hannah.datasets.collate.vision_collate_fn"></a></p>
<h4 id="vision_collate_fn">vision_collate_fn</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">vision_collate_fn</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</code></pre></div>

<p>Function that takes in a batch of data and puts the elements within the batch
into a tensor with an additional outer dimension - batch size. The exact output type can be
a :class:<code>torch.Tensor</code>, a <code>Sequence</code> of :class:<code>torch.Tensor</code>, a
Collection of :class:<code>torch.Tensor</code>, or left unchanged, depending on the input type.
This is used as the default function for collation for vision tasks
<code>batch_size</code> or <code>batch_sampler</code> is defined in :class:<code>~torch.utils.data.DataLoader</code>.</p>
<p>Here is the general input type (based on the type of the element within the batch) to output type mapping:</p>
<ul>
<li>:class:<code>torch.Tensor</code> -&gt; :class:<code>torch.Tensor</code> (with an added outer dimension batch size)</li>
<li>NumPy Arrays -&gt; :class:<code>torch.Tensor</code></li>
<li><code>float</code> -&gt; :class:<code>torch.Tensor</code></li>
<li><code>int</code> -&gt; :class:<code>torch.Tensor</code></li>
<li><code>str</code> -&gt; <code>str</code> (unchanged)</li>
<li><code>bytes</code> -&gt; <code>bytes</code> (unchanged)</li>
<li><code>Mapping[K, V_i]</code> -&gt; <code>Mapping[K, vision_collate([V_1, V_2, ...])]</code></li>
<li><code>NamedTuple[V1_i, V2_i, ...]</code> -&gt; <code>NamedTuple[vision_collate([V1_1, V1_2, ...]),
vision_collate([V2_1, V2_2, ...]), ...]</code></li>
<li><code>Sequence[V1_i, V2_i, ...]</code> -&gt; <code>Sequence[vision_collate([V1_1, V1_2, ...]),
vision_collate([V2_1, V2_2, ...]), ...]</code></li>
</ul>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>batch</code> - a single batch to be collated</li>
</ul>
<p><strong>Examples</strong>:</p>
<blockquote>
<blockquote>
<blockquote>
<h1 id="example-with-a-batch-of-ints">Example with a batch of <code>int</code>s:</h1>
<p>vision_collate([0, 1, 2, 3])
  tensor([0, 1, 2, 3])</p>
<h1 id="example-with-a-batch-of-strs">Example with a batch of <code>str</code>s:</h1>
<p>vision_collate(['a', 'b', 'c'])
  ['a', 'b', 'c']</p>
<h1 id="example-with-map-inside-the-batch">Example with <code>Map</code> inside the batch:</h1>
<p>vision_collate([{'A': 0, 'B': 1}, {'A': 100, 'B': 100}])
- <code>{'A'</code> - tensor([  0, 100]), 'B': tensor([  1, 100])}</p>
<h1 id="example-with-namedtuple-inside-the-batch">Example with <code>NamedTuple</code> inside the batch:</h1>
<p>Point = namedtuple('Point', ['x', 'y'])
vision_collate([Point(0, 0), Point(1, 1)])
  Point(x=tensor([0, 1]), y=tensor([0, 1]))</p>
<h1 id="example-with-tuple-inside-the-batch">Example with <code>Tuple</code> inside the batch:</h1>
<p>vision_collate([(0, 1), (2, 3)])
  [tensor([0, 2]), tensor([1, 3])]</p>
<h1 id="example-with-list-inside-the-batch">Example with <code>List</code> inside the batch:</h1>
<p>vision_collate([[0, 1], [2, 3]])
  [tensor([0, 2]), tensor([1, 3])]</p>
</blockquote>
</blockquote>
</blockquote>
<p><a id="hannah.datasets.collate.ctc_collate_fn"></a></p>
<h4 id="ctc_collate_fn">ctc_collate_fn</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">ctc_collate_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

<p>Creates mini-batch tensors from the list of tuples (src_seq, trg_seq).
We should build a custom collate_fn rather than using default collate_fn,
because merging sequences (including padding) is not supported in default.
Sequences are padded to the maximum length of mini-batch sequences (dynamic padding).</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>data</code> - list of tuple (src_seq, src_length, trg_seq, trg_length).</li>
<li>src_seq: torch tensor of shape (x,?); variable length.</li>
<li>src length: torch tenso of shape 1x1</li>
<li>trg_seq: torch tensor of shape (?); variable length.</li>
<li>trg_length: torch_tensor of shape (1x1)</li>
<li><code>Returns</code> - tuple of four torch tensors</li>
<li><code>src_seqs</code> - torch tensor of shape (batch_size, x, padded_length).</li>
<li><code>src_lengths</code> - torch_tensor of shape (batch_size); valid length for each padded source sequence.</li>
<li><code>trg_seqs</code> - torch tensor of shape (batch_size, x, padded_length).</li>
<li><code>trg_lengths</code> - torch tensor of shape (batch_size); valid length for each padded target sequence.</li>
</ul>
<p><a id="hannah.datasets.vision.kvasir"></a></p>
<h1 id="hannahdatasetsvisionkvasir">hannah.datasets.vision.kvasir</h1>
<p><a id="hannah.datasets.vision.dresden_capsule"></a></p>
<h1 id="hannahdatasetsvisiondresden_capsule">hannah.datasets.vision.dresden_capsule</h1>
<p>Rhode island gastroenterology video capsule endoscopy dataset</p>
<p>https://www.nature.com/articles/s41597-022-01726-3
https://github.com/acharoen/Rhode-Island-GI-VCE-Technical-Validation</p>
<p><a id="hannah.datasets.vision.base"></a></p>
<h1 id="hannahdatasetsvisionbase">hannah.datasets.vision.base</h1>
<p><a id="hannah.datasets.vision.base.TorchvisionDatasetBase"></a></p>
<h2 id="torchvisiondatasetbase-objects">TorchvisionDatasetBase Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TorchvisionDatasetBase</span><span class="p">(</span><span class="n">VisionDatasetBase</span><span class="p">)</span>
</code></pre></div>

<p>Wrapper around torchvision classification datasets</p>
<p><a id="hannah.datasets.vision.base.ImageDatasetBase"></a></p>
<h2 id="imagedatasetbase-objects">ImageDatasetBase Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ImageDatasetBase</span><span class="p">(</span><span class="n">VisionDatasetBase</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.datasets.vision.base.ImageDatasetBase.__init__"></a></p>
<h4 id="__init__">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>Initialize vision dataset</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>X</code> <em>List[str]</em> - List of paths to image files</li>
<li><code>y</code> <em>List[str]</em> - Class id of corresponding image</li>
<li><code>classes</code> <em>List[str]</em> - List of class names, names are ordered by numeric class id</li>
<li><code>bbox</code> <em>Dict[str]</em> - Dict with filename as keys, bbox coordinates as numpy arrays</li>
<li><code>transform</code> <em>Callable[image,image], optional</em> - Optional transformation/augmentation of input images. Defaults to None.</li>
</ul>
<p><a id="hannah.datasets.vision.ri_capsule"></a></p>
<h1 id="hannahdatasetsvisionri_capsule">hannah.datasets.vision.ri_capsule</h1>
<p>Rhode island gastroenterology video capsule endoscopy dataset</p>
<p>https://www.nature.com/articles/s41597-022-01726-3
https://github.com/acharoen/Rhode-Island-GI-VCE-Technical-Validation</p>
<p><a id="hannah.datasets.vision.ri_capsule.split_train_set"></a></p>
<h4 id="split_train_set">split_train_set</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">split_train_set</span><span class="p">(</span><span class="n">csv_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">drop_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

<p>Split train set in two and save as separate csv files.</p>
<p><a id="hannah.datasets.vision.kvasir_unlabeled"></a></p>
<h1 id="hannahdatasetsvisionkvasir_unlabeled">hannah.datasets.vision.kvasir_unlabeled</h1>
<p><a id="hannah.datasets.vision.kvasir_unlabeled.KvasirCapsuleUnlabeled"></a></p>
<h2 id="kvasircapsuleunlabeled-objects">KvasirCapsuleUnlabeled Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">KvasirCapsuleUnlabeled</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p>Dataset representing unlabelled videos</p>
<p><a id="hannah.datasets.vision.kvasir_unlabeled.KvasirCapsuleUnlabeled.sequential"></a></p>
<h4 id="sequential_1">sequential</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">sequential</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>Returns true if this dataset should only be iterated sequentially</p>
<p><a id="hannah.datasets.vision.kvasir_unlabeled.KvasirCapsuleUnlabeled.max_workers"></a></p>
<h4 id="max_workers_2">max_workers</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">max_workers</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

<p>Returns the maximum number of workers useable for this dataset</p>
<p><a id="hannah.datasets.vision.cifar"></a></p>
<h1 id="hannahdatasetsvisioncifar">hannah.datasets.vision.cifar</h1>
<p><a id="hannah.datasets.vision.fake"></a></p>
<h1 id="hannahdatasetsvisionfake">hannah.datasets.vision.fake</h1>
<p><a id="hannah.datasets.vision.utils.naneye"></a></p>
<h1 id="hannahdatasetsvisionutilsnaneye">hannah.datasets.vision.utils.naneye</h1>
<p><a id="hannah.datasets.vision.utils.naneye.read_naneye"></a></p>
<h4 id="read_naneye">read_naneye</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read_naneye</span><span class="p">(</span><span class="n">data_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span>
</code></pre></div>

<p>Read a naneye raw aimage and decode bayer pattern</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>data_file</code> <em>Union[str, Path]</em> - path to the datafile</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>np.ndarray</code> - uint8 array of decoded image data</li>
</ul>
<p><a id="hannah.datasets.vision.utils"></a></p>
<h1 id="hannahdatasetsvisionutils">hannah.datasets.vision.utils</h1>
<p><a id="hannah.datasets.vision"></a></p>
<h1 id="hannahdatasetsvision">hannah.datasets.vision</h1>
<p><a id="hannah.datasets.activity"></a></p>
<h1 id="hannahdatasetsactivity">hannah.datasets.activity</h1>
<p><a id="hannah.datasets.activity.Data3D"></a></p>
<h2 id="data3d-objects">Data3D Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Data3D</span><span class="p">()</span>
</code></pre></div>

<p>3D-Data</p>
<p><a id="hannah.datasets.activity.PAMPAP2_IMUData"></a></p>
<h2 id="pampap2_imudata-objects">PAMPAP2_IMUData Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PAMPAP2_IMUData</span><span class="p">()</span>
</code></pre></div>

<p>A IMU set defined by temperature (°C)
3D-acceleration data (ms -2 ), scale: ±16g, resolution: 13-bit
3D-acceleration data (ms -2 ), scale: ±6g, resolution: 13-bit
3D-gyroscope data (rad/s)
3D-magnetometer data (μT)
orientation (invalid in this data collection)</p>
<p><a id="hannah.datasets.activity.PAMAP2_DataPoint"></a></p>
<h2 id="pamap2_datapoint-objects">PAMAP2_DataPoint Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PAMAP2_DataPoint</span><span class="p">()</span>
</code></pre></div>

<p>A temporal datapoint in the dataset</p>
<p><a id="hannah.datasets.activity.PAMAP2_DataChunk"></a></p>
<h2 id="pamap2_datachunk-objects">PAMAP2_DataChunk Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PAMAP2_DataChunk</span><span class="p">()</span>
</code></pre></div>

<p>A DataChunk is a item of the pytorch dataset</p>
<p><a id="hannah.datasets.activity.PAMAP2_Dataset"></a></p>
<h2 id="pamap2_dataset-objects">PAMAP2_Dataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PAMAP2_Dataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p>Class for the PAMAP2 activity dataset
https://archive.ics.uci.edu/ml/datasets/pamap2+physical+activity+monitoring</p>
<p><a id="hannah.datasets.utils.md5"></a></p>
<h1 id="hannahdatasetsutilsmd5">hannah.datasets.utils.md5</h1>
<p><a id="hannah.datasets.utils.cache"></a></p>
<h1 id="hannahdatasetsutilscache">hannah.datasets.utils.cache</h1>
<p><a id="hannah.datasets.utils"></a></p>
<h1 id="hannahdatasetsutils">hannah.datasets.utils</h1>
<p><a id="hannah.datasets"></a></p>
<h1 id="hannahdatasets">hannah.datasets</h1>
<p><a id="hannah.datasets.eeg_chbrt"></a></p>
<h1 id="hannahdatasetseeg_chbrt">hannah.datasets.eeg_chbrt</h1>
<p><a id="hannah.datasets.eeg_chbrt.EEGRTDataset"></a></p>
<h2 id="eegrtdataset-objects">EEGRTDataset Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">EEGRTDataset</span><span class="p">(</span><span class="n">AbstractDataset</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.datasets.eeg_chbrt.EEGRTDataset.class_names"></a></p>
<h4 id="class_names_4">class_names</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

<p>Returns the names of the classes in the classification dataset</p>
<p><a id="hannah.datasets.eeg_chbrt.EEGRTDataset.class_counts"></a></p>
<h4 id="class_counts_4">class_counts</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">class_counts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</code></pre></div>

<p>Returns the number of items in each class of the dataset</p>
<p>If this is not applicable to a dataset type e.g. ASR, Semantic Segmentation,
it may return None</p>
<p><a id="hannah.datasets.eeg_chbrt.EEGRTDataset.size"></a></p>
<h4 id="size_3">size</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">size</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

<p>Returns dimension of output without batch dimension</p>
<p><a id="hannah.tools.objectdetection_eval"></a></p>
<h1 id="hannahtoolsobjectdetection_eval">hannah.tools.objectdetection_eval</h1>
<p><a id="hannah.tools.objectdetection_eval.eval_train"></a></p>
<h4 id="eval_train">eval_train</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">eval_train</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - param module:</li>
<li><code>test</code> - Default value = True)
  module:</li>
</ul>
<p><a id="hannah.tools.objectdetection_eval.eval_steps"></a></p>
<h4 id="eval_steps">eval_steps</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">eval_steps</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">hparams</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - param module:</li>
<li><code>hparams</code> - param checkpoint:
  module:
  checkpoint:</li>
</ul>
<p><a id="hannah.tools.objectdetection_eval.eval_checkpoint"></a></p>
<h4 id="eval_checkpoint">eval_checkpoint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">eval_checkpoint</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - DictConfig:
  checkpoint:</li>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
</ul>
<p><a id="hannah.tools.objectdetection_eval.eval"></a></p>
<h4 id="eval">eval</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
</ul>
<p><a id="hannah.tools.objectdetection_eval.main"></a></p>
<h4 id="main">main</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@hydra</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;objectdetection_eval&quot;</span><span class="p">,</span>
            <span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;../conf&quot;</span><span class="p">,</span>
            <span class="n">version_base</span><span class="o">=</span><span class="s2">&quot;1.2&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
</ul>
<p><a id="hannah.tools.train"></a></p>
<h1 id="hannahtoolstrain">hannah.tools.train</h1>
<p><a id="hannah.tools.eval"></a></p>
<h1 id="hannahtoolseval">hannah.tools.eval</h1>
<p><a id="hannah.tools.eval.eval_checkpoint"></a></p>
<h4 id="eval_checkpoint_1">eval_checkpoint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">eval_checkpoint</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - DictConfig:
  checkpoint:</li>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
</ul>
<p><a id="hannah.tools.eval.eval"></a></p>
<h4 id="eval_1">eval</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
</ul>
<p><a id="hannah.tools.eval.main"></a></p>
<h4 id="main_1">main</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@hydra</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;eval&quot;</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span> <span class="n">version_base</span><span class="o">=</span><span class="s2">&quot;1.2&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
</ul>
<p><a id="hannah.tools.characterize"></a></p>
<h1 id="hannahtoolscharacterize">hannah.tools.characterize</h1>
<p><a id="hannah.tools.characterize.main"></a></p>
<h4 id="main_2">main</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@hydra</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;characterize&quot;</span><span class="p">,</span>
            <span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;../conf&quot;</span><span class="p">,</span>
            <span class="n">version_base</span><span class="o">=</span><span class="s2">&quot;1.2&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
<li><code>config</code> - DictConfig:</li>
</ul>
<p><a id="hannah.tools"></a></p>
<h1 id="hannahtools">hannah.tools</h1>
<p><a id="hannah.callbacks.pruning"></a></p>
<h1 id="hannahcallbackspruning">hannah.callbacks.pruning</h1>
<p><a id="hannah.callbacks.pruning.PruningAmountScheduler"></a></p>
<h2 id="pruningamountscheduler-objects">PruningAmountScheduler Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PruningAmountScheduler</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.callbacks.pruning.FilteredPruning"></a></p>
<h2 id="filteredpruning-objects">FilteredPruning Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FilteredPruning</span><span class="p">(</span><span class="n">ModelPruning</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.callbacks.pruning.FilteredPruning.setup"></a></p>
<h4 id="setup">setup</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="n">trainer</span><span class="p">:</span> <span class="n">Trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.pruning.FilteredPruning.filter_parameters_to_prune"></a></p>
<h4 id="filter_parameters_to_prune">filter_parameters_to_prune</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_parameters_to_prune</span><span class="p">(</span><span class="n">parameters_to_prune</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>Filter out unprunable parameters</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>parameters_to_prune</code> - (Default value = None)</li>
</ul>
<p><a id="hannah.callbacks.pruning.FilteredPruning.on_test_end"></a></p>
<h4 id="on_test_end">on_test_end</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_test_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.prediction_logger"></a></p>
<h1 id="hannahcallbacksprediction_logger">hannah.callbacks.prediction_logger</h1>
<p><a id="hannah.callbacks.dump_layers"></a></p>
<h1 id="hannahcallbacksdump_layers">hannah.callbacks.dump_layers</h1>
<p><a id="hannah.callbacks.dump_layers.TestDumperCallback"></a></p>
<h2 id="testdumpercallback-objects">TestDumperCallback Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TestDumperCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.callbacks.dump_layers.TestDumperCallback.on_test_start"></a></p>
<h4 id="on_test_start">on_test_start</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_test_start</span><span class="p">(</span><span class="n">pl_trainer</span><span class="p">,</span> <span class="n">pl_model</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>pl_trainer:
  pl_model:</p>
<p><a id="hannah.callbacks.fine_tuning"></a></p>
<h1 id="hannahcallbacksfine_tuning">hannah.callbacks.fine_tuning</h1>
<p><a id="hannah.callbacks.backbone_finetuning"></a></p>
<h1 id="hannahcallbacksbackbone_finetuning">hannah.callbacks.backbone_finetuning</h1>
<p><a id="hannah.callbacks.optimization"></a></p>
<h1 id="hannahcallbacksoptimization">hannah.callbacks.optimization</h1>
<p><a id="hannah.callbacks.optimization.HydraOptCallback"></a></p>
<h2 id="hydraoptcallback-objects">HydraOptCallback Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">HydraOptCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.callbacks.optimization.HydraOptCallback.on_test_end"></a></p>
<h4 id="on_test_end_1">on_test_end</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_test_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.optimization.HydraOptCallback.on_validation_end"></a></p>
<h4 id="on_validation_end">on_validation_end</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_validation_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.optimization.HydraOptCallback.test_result"></a></p>
<h4 id="test_result">test_result</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">test_result</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.callbacks.optimization.HydraOptCallback.val_result"></a></p>
<h4 id="val_result">val_result</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">val_result</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.callbacks.optimization.HydraOptCallback.result"></a></p>
<h4 id="result">result</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="nb">dict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>dict</code> - (Default value = False)</li>
</ul>
<p><a id="hannah.callbacks.optimization.HydraOptCallback.curves"></a></p>
<h4 id="curves">curves</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">curves</span><span class="p">(</span><span class="nb">dict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>dict</code> - (Default value = False)</li>
</ul>
<p><a id="hannah.callbacks.summaries"></a></p>
<h1 id="hannahcallbackssummaries">hannah.callbacks.summaries</h1>
<p><a id="hannah.callbacks.summaries.walk_model"></a></p>
<h4 id="walk_model">walk_model</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">walk_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dummy_input</span><span class="p">)</span>
</code></pre></div>

<p>Adapted from IntelLabs Distiller</p>
<p><strong>Arguments</strong>:</p>
<p>model:
  dummy_input:</p>
<p><a id="hannah.callbacks.summaries.MacSummaryCallback"></a></p>
<h2 id="macsummarycallback-objects">MacSummaryCallback Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MacSummaryCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.callbacks.summaries.MacSummaryCallback.predict"></a></p>
<h4 id="predict">predict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">pl_module</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>pl_module:</p>
<p><a id="hannah.callbacks.summaries.MacSummaryCallback.on_train_start"></a></p>
<h4 id="on_train_start">on_train_start</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@rank_zero_only</span>
<span class="k">def</span> <span class="nf">on_train_start</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.summaries.MacSummaryCallback.on_test_end"></a></p>
<h4 id="on_test_end_2">on_test_end</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@rank_zero_only</span>
<span class="k">def</span> <span class="nf">on_test_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.summaries.MacSummaryCallback.on_validation_epoch_end"></a></p>
<h4 id="on_validation_epoch_end">on_validation_epoch_end</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@rank_zero_only</span>
<span class="k">def</span> <span class="nf">on_validation_epoch_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.summaries.MacSummaryCallback.estimate"></a></p>
<h4 id="estimate">estimate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="n">pl_module</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>Generate Summary Metrics for neural network</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pl_module(pytorch_lightning.LightningModule)</code> - pytorch lightning module to summarize</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>dict[str, float]: Dict of MetricName =&gt; Metric Value</p>
<p><a id="hannah.callbacks.summaries.prod"></a></p>
<h4 id="prod">prod</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">prod</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>seq:</p>
<p><a id="hannah.callbacks.svd_compress"></a></p>
<h1 id="hannahcallbackssvd_compress">hannah.callbacks.svd_compress</h1>
<p><a id="hannah.callbacks.svd_compress.SVD"></a></p>
<h2 id="svd-objects">SVD Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SVD</span><span class="p">(</span><span class="n">Callback</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.callbacks.svd_compress.SVD.on_train_epoch_start"></a></p>
<h4 id="on_train_epoch_start">on_train_epoch_start</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_train_epoch_start</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.clustering"></a></p>
<h1 id="hannahcallbacksclustering">hannah.callbacks.clustering</h1>
<p><a id="hannah.callbacks.clustering.clustering"></a></p>
<h4 id="clustering">clustering</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">clustering</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">inertia</span><span class="p">,</span> <span class="n">cluster</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>params:
  inertia:
  cluster:</p>
<p><a id="hannah.callbacks.clustering.kMeans"></a></p>
<h2 id="kmeans-objects">kMeans Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">kMeans</span><span class="p">(</span><span class="n">Callback</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.callbacks.clustering.kMeans.on_test_epoch_start"></a></p>
<h4 id="on_test_epoch_start">on_test_epoch_start</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_test_epoch_start</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.clustering.kMeans.on_train_epoch_end"></a></p>
<h4 id="on_train_epoch_end">on_train_epoch_end</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_train_epoch_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>trainer:
  pl_module:</p>
<p><a id="hannah.callbacks.backends"></a></p>
<h1 id="hannahcallbacksbackends">hannah.callbacks.backends</h1>
<p><a id="hannah.callbacks"></a></p>
<h1 id="hannahcallbacks">hannah.callbacks</h1>
<p><a id="hannah.test_linear_classifier"></a></p>
<h1 id="hannahtest_linear_classifier">hannah.test_linear_classifier</h1>
<p><a id="hannah.features"></a></p>
<h1 id="hannahfeatures">hannah.features</h1>
<p><a id="hannah.features.MFCC"></a></p>
<h2 id="mfcc-objects">MFCC Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MFCC</span><span class="p">(</span><span class="n">torchaudio</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">MFCC</span><span class="p">)</span>
</code></pre></div>

<p>A simple wrapper around torchaudio mfcc, but melkwargs are given as direct named arguments instead of a dictionary</p>
<p><a id="hannah.features.SincConv"></a></p>
<h2 id="sincconv-objects">SincConv Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SincConv</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Sinc convolution:</p>
<p><strong>Arguments</strong>:</p>
<hr />
<ul>
<li><code>in_channels</code> - No. of input channels(must be 1)</li>
<li><code>out_channels</code> - No. of filters(40)</li>
<li><code>sample_rate</code> - sampling rate, default set at 32000</li>
<li><code>kernel_size</code> - Filter length(101)</li>
</ul>
<p><a id="hannah.features.LogSpectrogram"></a></p>
<h2 id="logspectrogram-objects">LogSpectrogram Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">LogSpectrogram</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Create a spectrogram from a audio signal.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>n_fft</code> <em>int, optional</em> - Size of FFT, creates <code>n_fft // 2 + 1</code> bins. (Default: <code>400</code>)</li>
<li><code>win_length</code> <em>int or None, optional</em> - Window size. (Default: <code>n_fft</code>)</li>
<li><code>hop_length</code> <em>int or None, optional</em> - Length of hop between STFT windows. (Default: <code>win_length // 2</code>)</li>
<li><code>pad</code> <em>int, optional</em> - Two sided padding of signal. (Default: <code>0</code>)</li>
<li><code>window_fn</code> <em>Callable[..., Tensor], optional</em> - A function to create a window tensor
  that is applied/multiplied to each frame/window. (Default: <code>torch.hann_window</code>)</li>
<li><code>power</code> <em>float or None, optional</em> - Exponent for the magnitude spectrogram,
  (must be &gt; 0) e.g., 1 for energy, 2 for power, etc.
  If None, then the complex spectrum is returned instead. (Default: <code>2</code>)</li>
<li><code>normalized</code> <em>bool, optional</em> - Whether to normalize by magnitude after stft. (Default: <code>False</code>)</li>
<li><code>wkwargs</code> <em>dict or None, optional</em> - Arguments for window function. (Default: <code>None</code>)</li>
<li><code>center</code> <em>bool, optional</em> - whether to pad :attr:<code>waveform</code> on both sides so
  that the :math:<code>t</code>-th frame is centered at time :math:<code>t \times \text{hop\_length}</code>.</li>
<li><code>Default</code> - <code>True</code></li>
<li><code>pad_mode</code> <em>string, optional</em> - controls the padding method used when
  :attr:<code>center</code> is <code>True</code>. Default: <code>"reflect"</code></li>
<li><code>onesided</code> <em>bool, optional</em> - controls whether to return half of results to
  avoid redundancy Default: <code>True</code></li>
</ul>
<p><a id="hannah.features.LogSpectrogram.forward"></a></p>
<h4 id="forward">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">waveform</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>waveform</code> <em>Tensor</em> - Tensor of audio of dimension (..., time).</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>Tensor</code> - Dimension (..., freq, time), where freq is
  <code>n_fft // 2 + 1</code> where <code>n_fft</code> is the number of
  Fourier bins, and time is the number of window hops (n_frame).</li>
</ul>
<p><a id="hannah.ssl.hard_labeling"></a></p>
<h1 id="hannahsslhard_labeling">hannah.ssl.hard_labeling</h1>
<p><a id="hannah.ssl.hard_labeling.HardLabeling"></a></p>
<h2 id="hardlabeling-objects">HardLabeling Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">HardLabeling</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.ssl.hard_labeling.HardLabeling.training_step"></a></p>
<h4 id="training_step">training_step</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="n">unlabeled_data</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                  <span class="n">trainer</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Trainer</span><span class="p">,</span>
                  <span class="n">pl_module</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LightningModule</span><span class="p">,</span>
                  <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

<p>Calculate pseudo label loss from unlabeled data.</p>
<p><a id="hannah.ssl.hard_labeling.HardLabeling.get_dropout_layers"></a></p>
<h4 id="get_dropout_layers">get_dropout_layers</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_dropout_layers</span><span class="p">()</span>
</code></pre></div>

<p>Returns all model layers of class dropout or dropblock.</p>
<p><a id="hannah.ssl.hard_labeling.HardLabeling.compute_loss"></a></p>
<h4 id="compute_loss">compute_loss</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_loss</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">logits</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>Helper function to compute loss, possibly with consistency
regularization by augmentations (FixMatch).</p>
<p><a id="hannah.ssl.hard_labeling.HardLabeling.negative_cre_loss"></a></p>
<h4 id="negative_cre_loss">negative_cre_loss</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">negative_cre_loss</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
</code></pre></div>

<p>Cross Entropy Loss for negative learning which requires a mutli-
class and multi-label loss function.</p>
<p><a id="hannah.ssl"></a></p>
<h1 id="hannahssl">hannah.ssl</h1>
<p><a id="hannah.models.simple1d"></a></p>
<h1 id="hannahmodelssimple1d">hannah.models.simple1d</h1>
<p><a id="hannah.models.embedded_vision_net.operators"></a></p>
<h1 id="hannahmodelsembedded_vision_netoperators">hannah.models.embedded_vision_net.operators</h1>
<p><a id="hannah.models.embedded_vision_net.expressions"></a></p>
<h1 id="hannahmodelsembedded_vision_netexpressions">hannah.models.embedded_vision_net.expressions</h1>
<p><a id="hannah.models.embedded_vision_net.utils"></a></p>
<h1 id="hannahmodelsembedded_vision_netutils">hannah.models.embedded_vision_net.utils</h1>
<p><a id="hannah.models.embedded_vision_net.blocks"></a></p>
<h1 id="hannahmodelsembedded_vision_netblocks">hannah.models.embedded_vision_net.blocks</h1>
<p><a id="hannah.models.embedded_vision_net.models"></a></p>
<h1 id="hannahmodelsembedded_vision_netmodels">hannah.models.embedded_vision_net.models</h1>
<p><a id="hannah.models.embedded_vision_net.parameters"></a></p>
<h1 id="hannahmodelsembedded_vision_netparameters">hannah.models.embedded_vision_net.parameters</h1>
<p><a id="hannah.models.mobilenet.operators"></a></p>
<h1 id="hannahmodelsmobilenetoperators">hannah.models.mobilenet.operators</h1>
<p><a id="hannah.models.mobilenet.expressions"></a></p>
<h1 id="hannahmodelsmobilenetexpressions">hannah.models.mobilenet.expressions</h1>
<p><a id="hannah.models.mobilenet.expressions.padding_expression"></a></p>
<h4 id="padding_expression">padding_expression</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">padding_expression</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Symbolically calculate padding such that for a given kernel_size, stride and dilation
the padding is such that the output dimension is kept the same(stride=1) or halved(stride=2).
Note: If the input dimension is 1 and stride = 2, the calculated padding will result in
an output with also dimension 1.</p>
<h2 id="parameters">Parameters</h2>
<p>kernel_size : Union[int, Expression]
stride : Union[int, Expression]
dilation : Union[int, Expression], optional
<em>description</em>, by default 1</p>
<h2 id="returns">Returns</h2>
<p>Expression</p>
<p><a id="hannah.models.mobilenet.models"></a></p>
<h1 id="hannahmodelsmobilenetmodels">hannah.models.mobilenet.models</h1>
<p><a id="hannah.models.resnet.operators"></a></p>
<h1 id="hannahmodelsresnetoperators">hannah.models.resnet.operators</h1>
<p><a id="hannah.models.resnet.expressions"></a></p>
<h1 id="hannahmodelsresnetexpressions">hannah.models.resnet.expressions</h1>
<p><a id="hannah.models.resnet.expressions.padding_expression"></a></p>
<h4 id="padding_expression_1">padding_expression</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">padding_expression</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Symbolically calculate padding such that for a given kernel_size, stride and dilation
the padding is such that the output dimension is kept the same(stride=1) or halved(stride=2).
Note: If the input dimension is 1 and stride = 2, the calculated padding will result in
an output with also dimension 1.</p>
<h2 id="parameters_1">Parameters</h2>
<p>kernel_size : Union[int, Expression]
stride : Union[int, Expression]
dilation : Union[int, Expression], optional
<em>description</em>, by default 1</p>
<h2 id="returns_1">Returns</h2>
<p>Expression</p>
<p><a id="hannah.models.resnet.models_lazy"></a></p>
<h1 id="hannahmodelsresnetmodels_lazy">hannah.models.resnet.models_lazy</h1>
<p><a id="hannah.models.resnet.models_lazy.padding_expression"></a></p>
<h4 id="padding_expression_2">padding_expression</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">padding_expression</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Symbolically calculate padding such that for a given kernel_size, stride and dilation
the padding is such that the output dimension is kept the same(stride=1) or halved(stride=2).
Note: If the input dimension is 1 and stride = 2, the calculated padding will result in
an output with also dimension 1.</p>
<h2 id="parameters_2">Parameters</h2>
<p>kernel_size : Union[int, Expression]
stride : Union[int, Expression]
dilation : Union[int, Expression], optional
<em>description</em>, by default 1</p>
<h2 id="returns_2">Returns</h2>
<p>Expression</p>
<p><a id="hannah.models.resnet.blocks"></a></p>
<h1 id="hannahmodelsresnetblocks">hannah.models.resnet.blocks</h1>
<p><a id="hannah.models.resnet.models"></a></p>
<h1 id="hannahmodelsresnetmodels">hannah.models.resnet.models</h1>
<p><a id="hannah.models.resnet"></a></p>
<h1 id="hannahmodelsresnet">hannah.models.resnet</h1>
<p><a id="hannah.models.timm"></a></p>
<h1 id="hannahmodelstimm">hannah.models.timm</h1>
<p><a id="hannah.models.timm.DefaultAnomalyDetector"></a></p>
<h2 id="defaultanomalydetector-objects">DefaultAnomalyDetector Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DefaultAnomalyDetector</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.timm.DefaultAnomalyDetector.forward"></a></p>
<h4 id="forward_1">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p>Simple anomaly detection head for a neural network</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li>
<p><code>x</code> - Tensor of logits</p>
</li>
<li>
<p><code>Returns</code> - A single element floating point tensor representing the anomaly score</p>
</li>
</ul>
<p><a id="hannah.models.timm.DefaultClassifierHead"></a></p>
<h2 id="defaultclassifierhead-objects">DefaultClassifierHead Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DefaultClassifierHead</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.timm.DefaultClassifierHead.forward"></a></p>
<h4 id="forward_2">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x (torch.Tensor):</p>
<p><strong>Returns</strong>:</p>
<p>Resulting torch.Tensor after applying classification</p>
<p><a id="hannah.models.timm.DefaultProjectionHead"></a></p>
<h2 id="defaultprojectionhead-objects">DefaultProjectionHead Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DefaultProjectionHead</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Default projection head for semi supervised classification learning</p>
<p><a id="hannah.models.timm.DefaultProjectionHead.forward"></a></p>
<h4 id="forward_3">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

<p>Forward function for default Projection Head</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>x</code> - Input tensor</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>output tensor</p>
<p><a id="hannah.models.timm.DefaultDecoderHead"></a></p>
<h2 id="defaultdecoderhead-objects">DefaultDecoderHead Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DefaultDecoderHead</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.timm.DefaultDecoderHead.__init__"></a></p>
<h4 id="__init___1">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">latent_shape</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">)</span>
</code></pre></div>

<p>Default Decoder Head for autoencoders using TransposedConv2D</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>latent_shape(Tuple)</code> - Shape (CxHxW) of the latent representation of the autoencoder</li>
<li><code>input_shape(Tuple)</code> - Shape (CxHxW) of the reconstructed image</li>
</ul>
<p><a id="hannah.models.timm.DefaultDecoderHead.forward"></a></p>
<h4 id="forward_4">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.timm.TimmModel"></a></p>
<h2 id="timmmodel-objects">TimmModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TimmModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.timm.TimmModel.forward"></a></p>
<h4 id="forward_5">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>x</code> - torch.Tensor:</li>
<li><code>x</code> - torch.Tensor:</li>
</ul>
<p><a id="hannah.models.vad.models"></a></p>
<h1 id="hannahmodelsvadmodels">hannah.models.vad.models</h1>
<p><a id="hannah.models.vad.models.BottleneckVad"></a></p>
<h2 id="bottleneckvad-objects">BottleneckVad Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BottleneckVad</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.vad.models.BottleneckVad.forward"></a></p>
<h4 id="forward_6">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.BottleneckVad.num_flat_features"></a></p>
<h4 id="num_flat_features">num_flat_features</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">num_flat_features</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.SmallVad"></a></p>
<h2 id="smallvad-objects">SmallVad Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SmallVad</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.vad.models.SmallVad.forward"></a></p>
<h4 id="forward_7">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.SmallVad.num_flat_features"></a></p>
<h4 id="num_flat_features_1">num_flat_features</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">num_flat_features</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.SimpleVad"></a></p>
<h2 id="simplevad-objects">SimpleVad Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SimpleVad</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.vad.models.SimpleVad.forward"></a></p>
<h4 id="forward_8">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.SimpleVad.num_flat_features"></a></p>
<h4 id="num_flat_features_2">num_flat_features</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">num_flat_features</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.BottleneckVadModel"></a></p>
<h2 id="bottleneckvadmodel-objects">BottleneckVadModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BottleneckVadModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.vad.models.BottleneckVadModel.forward"></a></p>
<h4 id="forward_9">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.SimpleVadModel"></a></p>
<h2 id="simplevadmodel-objects">SimpleVadModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SimpleVadModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.vad.models.SimpleVadModel.forward"></a></p>
<h4 id="forward_10">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad.models.SmallVadModel"></a></p>
<h2 id="smallvadmodel-objects">SmallVadModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SmallVadModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.vad.models.SmallVadModel.forward"></a></p>
<h4 id="forward_11">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.vad"></a></p>
<h1 id="hannahmodelsvad">hannah.models.vad</h1>
<p><a id="hannah.models.objectdetection.loss"></a></p>
<h1 id="hannahmodelsobjectdetectionloss">hannah.models.objectdetection.loss</h1>
<p><a id="hannah.models.objectdetection.loss.bbox_iou"></a></p>
<h4 id="bbox_iou">bbox_iou</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">bbox_iou</span><span class="p">(</span><span class="n">box1</span><span class="p">,</span>
             <span class="n">box2</span><span class="p">,</span>
             <span class="n">x1y1x2y2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">GIoU</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">DIoU</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">CIoU</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">eps</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>box1:
  box2:
- <code>x1y1x2y2</code> - (Default value = True)
- <code>GIoU</code> - (Default value = False)
- <code>DIoU</code> - (Default value = False)
- <code>CIoU</code> - (Default value = False)
- <code>eps</code> - (Default value = 1e-7)</p>
<p><a id="hannah.models.objectdetection.loss.is_parallel"></a></p>
<h4 id="is_parallel">is_parallel</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">is_parallel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>model:</p>
<p><a id="hannah.models.objectdetection.loss.BCEBlurWithLogitsLoss"></a></p>
<h2 id="bceblurwithlogitsloss-objects">BCEBlurWithLogitsLoss Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BCEBlurWithLogitsLoss</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>eps</code> - (Default value = 0.1)</li>
<li><code>)</code> - # https://github.com/ultralytics/yolov3/issues/238#issuecomment-598028441# return positive:
  negative label smoothing BCE targetsreturn 1.0 - 0.5 * eps:
  0.5 * epsclass BCEBlurWithLogitsLoss(nn.Module:</li>
<li><code>)</code> - # https://github.com/ultralytics/yolov3/issues/238#issuecomment-598028441# return positive:</li>
</ul>
<p><a id="hannah.models.objectdetection.loss.BCEBlurWithLogitsLoss.forward"></a></p>
<h4 id="forward_12">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>pred:
  true:</p>
<p><a id="hannah.models.objectdetection.loss.FocalLoss"></a></p>
<h2 id="focalloss-objects">FocalLoss Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FocalLoss</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.objectdetection.loss.FocalLoss.forward"></a></p>
<h4 id="forward_13">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>pred:
  true:</p>
<p><a id="hannah.models.objectdetection.loss.QFocalLoss"></a></p>
<h2 id="qfocalloss-objects">QFocalLoss Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">QFocalLoss</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.objectdetection.loss.QFocalLoss.forward"></a></p>
<h4 id="forward_14">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>pred:
  true:</p>
<p><a id="hannah.models.objectdetection.loss.ComputeLoss"></a></p>
<h2 id="computeloss-objects">ComputeLoss Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ComputeLoss</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.objectdetection.loss.ComputeLoss.build_targets"></a></p>
<h4 id="build_targets">build_targets</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build_targets</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>p:
  targets:</p>
<p><a id="hannah.models.objectdetection.models"></a></p>
<h1 id="hannahmodelsobjectdetectionmodels">hannah.models.objectdetection.models</h1>
<p><a id="hannah.models.objectdetection.models.FasterRCNN"></a></p>
<h2 id="fasterrcnn-objects">FasterRCNN Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FasterRCNN</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.objectdetection.models.FasterRCNN.forward"></a></p>
<h4 id="forward_15">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:
- <code>y</code> - (Default value = None)</p>
<p><a id="hannah.models.objectdetection.models.FasterRCNN.transformOutput"></a></p>
<h4 id="transformoutput">transformOutput</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">transformOutput</span><span class="p">(</span><span class="n">cocoGt</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>cocoGt:
  output:
  x:
  y:</p>
<p><a id="hannah.models.objectdetection.models.UltralyticsYolo"></a></p>
<h2 id="ultralyticsyolo-objects">UltralyticsYolo Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">UltralyticsYolo</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.objectdetection.models.UltralyticsYolo.forward"></a></p>
<h4 id="forward_16">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:
- <code>y</code> - (Default value = None)</p>
<p><a id="hannah.models.objectdetection.models.UltralyticsYolo.train"></a></p>
<h4 id="train_1">train</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>mode</code> - (Default value = True)</li>
</ul>
<p><a id="hannah.models.objectdetection.models.UltralyticsYolo.transformOutput"></a></p>
<h4 id="transformoutput_1">transformOutput</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">transformOutput</span><span class="p">(</span><span class="n">cocoGt</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>cocoGt:
  output:
  x:
  y:</p>
<p><a id="hannah.models.objectdetection"></a></p>
<h1 id="hannahmodelsobjectdetection">hannah.models.objectdetection</h1>
<p><a id="hannah.models.ekut.models"></a></p>
<h1 id="hannahmodelsekutmodels">hannah.models.ekut.models</h1>
<p><a id="hannah.models.ekut.models.conv_bn"></a></p>
<h4 id="conv_bn">conv_bn</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">conv_bn</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">oup</span><span class="p">,</span> <span class="n">stride</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>inp:
  oup:
  stride:</p>
<p><a id="hannah.models.ekut.models.conv_1x1_bn"></a></p>
<h4 id="conv_1x1_bn">conv_1x1_bn</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">conv_1x1_bn</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">oup</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>inp:
  oup:</p>
<p><a id="hannah.models.ekut.models.InvertedResidual"></a></p>
<h2 id="invertedresidual-objects">InvertedResidual Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">InvertedResidual</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.ekut.models.InvertedResidual.forward"></a></p>
<h4 id="forward_17">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.ekut.models.RawSpeechModel"></a></p>
<h2 id="rawspeechmodel-objects">RawSpeechModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">RawSpeechModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Speech Recognition on RAW Data using Wolfgang Fuhls Networks</p>
<p><a id="hannah.models.ekut.models.RawSpeechModel.forward"></a></p>
<h4 id="forward_18">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.ekut.models.RawSpeechModelInvertedResidual"></a></p>
<h2 id="rawspeechmodelinvertedresidual-objects">RawSpeechModelInvertedResidual Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">RawSpeechModelInvertedResidual</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.ekut.models.RawSpeechModelInvertedResidual.forward"></a></p>
<h4 id="forward_19">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.ekut"></a></p>
<h1 id="hannahmodelsekut">hannah.models.ekut</h1>
<p><a id="hannah.models.functional_net_test.expressions"></a></p>
<h1 id="hannahmodelsfunctional_net_testexpressions">hannah.models.functional_net_test.expressions</h1>
<p><a id="hannah.models.functional_net_test.expressions.padding_expression"></a></p>
<h4 id="padding_expression_3">padding_expression</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">padding_expression</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Symbolically calculate padding such that for a given kernel_size, stride and dilation
the padding is such that the output dimension is kept the same(stride=1) or halved(stride=2).
Note: If the input dimension is 1 and stride = 2, the calculated padding will result in
an output with also dimension 1.</p>
<h2 id="parameters_3">Parameters</h2>
<p>kernel_size : Union[int, Expression]
stride : Union[int, Expression]
dilation : Union[int, Expression], optional
<em>description</em>, by default 1</p>
<h2 id="returns_3">Returns</h2>
<p>Expression</p>
<p><a id="hannah.models.functional_net_test.models"></a></p>
<h1 id="hannahmodelsfunctional_net_testmodels">hannah.models.functional_net_test.models</h1>
<p><a id="hannah.models.utils"></a></p>
<h1 id="hannahmodelsutils">hannah.models.utils</h1>
<p><a id="hannah.models.utils.next_power_of2"></a></p>
<h4 id="next_power_of2">next_power_of2</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">next_power_of2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout"></a></p>
<h1 id="hannahmodels_vendorresnet_mc_dropout">hannah.models._vendor.resnet_mc_dropout</h1>
<p>PyTorch ResNet</p>
<p>This started as a copy of https://github.com/pytorch/vision 'resnet.py' (BSD-3-Clause) with
additional dropout and dynamic global avg/max pool.</p>
<p>ResNeXt, SE-ResNeXt, SENet, and MXNet Gluon stem/downsample variants, tiered stems added by Ross Wightman</p>
<p>Copyright 2019, Ross Wightman</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ResNet"></a></p>
<h2 id="resnet-objects">ResNet Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ResNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>ResNet / ResNeXt / SE-ResNeXt / SE-Net</p>
<p>This class implements all variants of ResNet, ResNeXt, SE-ResNeXt, and SENet that
  * have &gt; 1 stride in the 3x3 conv layer of bottleneck
  * have conv-bn-act ordering</p>
<p>This ResNet impl supports a number of stem and downsample options based on the v1c, v1d, v1e, and v1s
variants included in the MXNet Gluon ResNetV1b model. The C and D variants are also discussed in the
'Bag of Tricks' paper: https://arxiv.org/pdf/1812.01187. The B variant is equivalent to torchvision default.</p>
<p>ResNet variants (the same modifications can be used in SE/ResNeXt models as well):
  * normal, b - 7x7 stem, stem_width = 64, same as torchvision ResNet, NVIDIA ResNet 'v1.5', Gluon v1b
  * c - 3 layer deep 3x3 stem, stem_width = 32 (32, 32, 64)
  * d - 3 layer deep 3x3 stem, stem_width = 32 (32, 32, 64), average pool in downsample
  * e - 3 layer deep 3x3 stem, stem_width = 64 (64, 64, 128), average pool in downsample
  * s - 3 layer deep 3x3 stem, stem_width = 64 (64, 64, 128)
  * t - 3 layer deep 3x3 stem, stem width = 32 (24, 48, 64), average pool in downsample
  * tn - 3 layer deep 3x3 stem, stem width = 32 (24, 32, 64), average pool in downsample</p>
<p>ResNeXt
  * normal - 7x7 stem, stem_width = 64, standard cardinality and base widths
  * same c,d, e, s variants as ResNet can be enabled</p>
<p>SE-ResNeXt
  * normal - 7x7 stem, stem_width = 64
  * same c, d, e, s variants as ResNet can be enabled</p>
<p>SENet-154 - 3 layer deep 3x3 stem (same as v1c-v1s), stem_width = 64, cardinality=64,
    reduction by 2 on width of first bottleneck convolution, 3x3 downsample convs after first block</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ResNet.__init__"></a></p>
<h4 id="__init___2">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">block</span><span class="p">,</span>
             <span class="n">layers</span><span class="p">,</span>
             <span class="n">num_classes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
             <span class="n">in_chans</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
             <span class="n">output_stride</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
             <span class="n">global_pool</span><span class="o">=</span><span class="s2">&quot;avg&quot;</span><span class="p">,</span>
             <span class="n">cardinality</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">base_width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
             <span class="n">stem_width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
             <span class="n">stem_type</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
             <span class="n">replace_stem_pool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">block_reduce_first</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">down_kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">avg_down</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">act_layer</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">,</span>
             <span class="n">norm_layer</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">,</span>
             <span class="n">aa_layer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">drop_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">drop_path_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">drop_block_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">zero_init_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">block_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>block</code> <em>nn.Module</em> - class for the residual block. Options are BasicBlock, Bottleneck.
  layers (List[int]) : number of layers in each block</li>
<li><code>num_classes</code> <em>int</em> - number of classification classes (default 1000)</li>
<li><code>in_chans</code> <em>int</em> - number of input (color) channels. (default 3)</li>
<li><code>output_stride</code> <em>int</em> - output stride of the network, 32, 16, or 8. (default 32)</li>
<li><code>global_pool</code> <em>str</em> - Global pooling type. One of 'avg', 'max', 'avgmax', 'catavgmax' (default 'avg')</li>
<li><code>cardinality</code> <em>int</em> - number of convolution groups for 3x3 conv in Bottleneck. (default 1)</li>
<li><code>base_width</code> <em>int</em> - bottleneck channels factor. <code>planes * base_width / 64 * cardinality</code> (default 64)</li>
<li><code>stem_width</code> <em>int</em> - number of channels in stem convolutions (default 64)</li>
<li><code>stem_type</code> <em>str</em> - The type of stem (default ''):</li>
<li>'', default - a single 7x7 conv with a width of stem_width</li>
<li>'deep' - three 3x3 convolution layers of widths stem_width, stem_width, stem_width * 2</li>
<li>'deep_tiered' - three 3x3 conv layers of widths stem_width//4 * 3, stem_width, stem_width * 2</li>
<li><code>replace_stem_pool</code> <em>bool</em> - replace stem max-pooling layer with a 3x3 stride-2 convolution</li>
<li><code>block_reduce_first</code> <em>int</em> - Reduction factor for first convolution output width of residual blocks,
  1 for all archs except senets, where 2 (default 1)</li>
<li><code>down_kernel_size</code> <em>int</em> - kernel size of residual block downsample path,
  1x1 for most, 3x3 for senets (default: 1)</li>
<li><code>avg_down</code> <em>bool</em> - use avg pooling for projection skip connection between stages/downsample (default False)</li>
<li><code>act_layer</code> <em>str, nn.Module</em> - activation layer</li>
<li><code>norm_layer</code> <em>str, nn.Module</em> - normalization layer</li>
<li><code>aa_layer</code> <em>nn.Module</em> - anti-aliasing layer</li>
<li><code>drop_rate</code> <em>float</em> - Dropout probability before classifier, for training (default 0.)</li>
<li><code>drop_path_rate</code> <em>float</em> - Stochastic depth drop-path rate (default 0.)</li>
<li><code>drop_block_rate</code> <em>float</em> - Drop block rate (default 0.)</li>
<li><code>zero_init_last</code> <em>bool</em> - zero-init the last weight in residual path (usually last BN affine weight)</li>
<li><code>block_args</code> <em>dict</em> - Extra kwargs to pass through to block module</li>
</ul>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet10t_mc_dropout"></a></p>
<h4 id="resnet10t_mc_dropout">resnet10t_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet10t_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-10-T model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet14t_mc_dropout"></a></p>
<h4 id="resnet14t_mc_dropout">resnet14t_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet14t_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-14-T model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet18_mc_dropout"></a></p>
<h4 id="resnet18_mc_dropout">resnet18_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet18_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-18 model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet18d_mc_dropout"></a></p>
<h4 id="resnet18d_mc_dropout">resnet18d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet18d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-18-D model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet34_mc_dropout"></a></p>
<h4 id="resnet34_mc_dropout">resnet34_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet34_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-34 model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet34d_mc_dropout"></a></p>
<h4 id="resnet34d_mc_dropout">resnet34d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet34d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-34-D model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet26_mc_dropout"></a></p>
<h4 id="resnet26_mc_dropout">resnet26_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet26_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-26 model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet26t_mc_dropout"></a></p>
<h4 id="resnet26t_mc_dropout">resnet26t_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet26t_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-26-T model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet26d_mc_dropout"></a></p>
<h4 id="resnet26d_mc_dropout">resnet26d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet26d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-26-D model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet50_mc_dropout"></a></p>
<h4 id="resnet50_mc_dropout">resnet50_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet50_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50 model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet50d_mc_dropout"></a></p>
<h4 id="resnet50d_mc_dropout">resnet50d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet50d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResNet</span>
</code></pre></div>

<p>Constructs a ResNet-50-D model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet50t_mc_dropout"></a></p>
<h4 id="resnet50t_mc_dropout">resnet50t_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet50t_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50-T model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet101_mc_dropout"></a></p>
<h4 id="resnet101_mc_dropout">resnet101_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet101_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-101 model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet101d_mc_dropout"></a></p>
<h4 id="resnet101d_mc_dropout">resnet101d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet101d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-101-D model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet152_mc_dropout"></a></p>
<h4 id="resnet152_mc_dropout">resnet152_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet152_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-152 model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet152d_mc_dropout"></a></p>
<h4 id="resnet152d_mc_dropout">resnet152d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet152d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-152-D model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet200_mc_dropout"></a></p>
<h4 id="resnet200_mc_dropout">resnet200_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet200_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-200 model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet200d_mc_dropout"></a></p>
<h4 id="resnet200d_mc_dropout">resnet200d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet200d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-200-D model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.tv_resnet34_mc_dropout"></a></p>
<h4 id="tv_resnet34_mc_dropout">tv_resnet34_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">tv_resnet34_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-34 model with original Torchvision weights.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.tv_resnet50_mc_dropout"></a></p>
<h4 id="tv_resnet50_mc_dropout">tv_resnet50_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">tv_resnet50_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50 model with original Torchvision weights.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.tv_resnet101_mc_dropout"></a></p>
<h4 id="tv_resnet101_mc_dropout">tv_resnet101_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">tv_resnet101_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-101 model w/ Torchvision pretrained weights.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.tv_resnet152_mc_dropout"></a></p>
<h4 id="tv_resnet152_mc_dropout">tv_resnet152_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">tv_resnet152_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-152 model w/ Torchvision pretrained weights.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.wide_resnet50_2_mc_dropout"></a></p>
<h4 id="wide_resnet50_2_mc_dropout">wide_resnet50_2_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">wide_resnet50_2_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a Wide ResNet-50-2 model.
The model is the same as ResNet except for the bottleneck number of channels
which is twice larger in every block. The number of channels in outer 1x1
convolutions is the same, e.g. last block in ResNet-50 has 2048-512-2048
channels, and in Wide ResNet-50-2 has 2048-1024-2048.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.wide_resnet101_2_mc_dropout"></a></p>
<h4 id="wide_resnet101_2_mc_dropout">wide_resnet101_2_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">wide_resnet101_2_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a Wide ResNet-101-2 model.
The model is the same as ResNet except for the bottleneck number of channels
which is twice larger in every block. The number of channels in outer 1x1
convolutions is the same.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnet50_gn_mc_dropout"></a></p>
<h4 id="resnet50_gn_mc_dropout">resnet50_gn_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnet50_gn_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50 model w/ GroupNorm</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnext50_32x4d_mc_dropout"></a></p>
<h4 id="resnext50_32x4d_mc_dropout">resnext50_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnext50_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt50-32x4d model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnext50d_32x4d_mc_dropout"></a></p>
<h4 id="resnext50d_32x4d_mc_dropout">resnext50d_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnext50d_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt50d-32x4d model. ResNext50 w/ deep stem &amp; avg pool downsample</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnext101_32x4d_mc_dropout"></a></p>
<h4 id="resnext101_32x4d_mc_dropout">resnext101_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnext101_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt-101 32x4d model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnext101_32x8d_mc_dropout"></a></p>
<h4 id="resnext101_32x8d_mc_dropout">resnext101_32x8d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnext101_32x8d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt-101 32x8d model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnext101_64x4d_mc_dropout"></a></p>
<h4 id="resnext101_64x4d_mc_dropout">resnext101_64x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnext101_64x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt101-64x4d model.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.tv_resnext50_32x4d_mc_dropout"></a></p>
<h4 id="tv_resnext50_32x4d_mc_dropout">tv_resnext50_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">tv_resnext50_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt50-32x4d model with original Torchvision weights.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ig_resnext101_32x8d_mc_dropout"></a></p>
<h4 id="ig_resnext101_32x8d_mc_dropout">ig_resnext101_32x8d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ig_resnext101_32x8d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt-101 32x8 model pre-trained on weakly-supervised data
and finetuned on ImageNet from Figure 5 in
<code>"Exploring the Limits of Weakly Supervised Pretraining" &lt;https://arxiv.org/abs/1805.00932&gt;</code>_
Weights from https://pytorch.org/hub/facebookresearch_WSL-Images_resnext/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ig_resnext101_32x16d_mc_dropout"></a></p>
<h4 id="ig_resnext101_32x16d_mc_dropout">ig_resnext101_32x16d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ig_resnext101_32x16d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt-101 32x16 model pre-trained on weakly-supervised data
and finetuned on ImageNet from Figure 5 in
<code>"Exploring the Limits of Weakly Supervised Pretraining" &lt;https://arxiv.org/abs/1805.00932&gt;</code>_
Weights from https://pytorch.org/hub/facebookresearch_WSL-Images_resnext/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ig_resnext101_32x32d_mc_dropout"></a></p>
<h4 id="ig_resnext101_32x32d_mc_dropout">ig_resnext101_32x32d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ig_resnext101_32x32d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt-101 32x32 model pre-trained on weakly-supervised data
and finetuned on ImageNet from Figure 5 in
<code>"Exploring the Limits of Weakly Supervised Pretraining" &lt;https://arxiv.org/abs/1805.00932&gt;</code>_
Weights from https://pytorch.org/hub/facebookresearch_WSL-Images_resnext/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ig_resnext101_32x48d_mc_dropout"></a></p>
<h4 id="ig_resnext101_32x48d_mc_dropout">ig_resnext101_32x48d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ig_resnext101_32x48d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNeXt-101 32x48 model pre-trained on weakly-supervised data
and finetuned on ImageNet from Figure 5 in
<code>"Exploring the Limits of Weakly Supervised Pretraining" &lt;https://arxiv.org/abs/1805.00932&gt;</code>_
Weights from https://pytorch.org/hub/facebookresearch_WSL-Images_resnext/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ssl_resnet18_mc_dropout"></a></p>
<h4 id="ssl_resnet18_mc_dropout">ssl_resnet18_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ssl_resnet18_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-supervised ResNet-18 model pre-trained on YFCC100M dataset and finetuned on ImageNet
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ssl_resnet50_mc_dropout"></a></p>
<h4 id="ssl_resnet50_mc_dropout">ssl_resnet50_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ssl_resnet50_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-supervised ResNet-50 model pre-trained on YFCC100M dataset and finetuned on ImageNet
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ssl_resnext50_32x4d_mc_dropout"></a></p>
<h4 id="ssl_resnext50_32x4d_mc_dropout">ssl_resnext50_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ssl_resnext50_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-supervised ResNeXt-50 32x4 model pre-trained on YFCC100M dataset and finetuned on ImageNet
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ssl_resnext101_32x4d_mc_dropout"></a></p>
<h4 id="ssl_resnext101_32x4d_mc_dropout">ssl_resnext101_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ssl_resnext101_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-supervised ResNeXt-101 32x4 model pre-trained on YFCC100M dataset and finetuned on ImageNet
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ssl_resnext101_32x8d_mc_dropout"></a></p>
<h4 id="ssl_resnext101_32x8d_mc_dropout">ssl_resnext101_32x8d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ssl_resnext101_32x8d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-supervised ResNeXt-101 32x8 model pre-trained on YFCC100M dataset and finetuned on ImageNet
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ssl_resnext101_32x16d_mc_dropout"></a></p>
<h4 id="ssl_resnext101_32x16d_mc_dropout">ssl_resnext101_32x16d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ssl_resnext101_32x16d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-supervised ResNeXt-101 32x16 model pre-trained on YFCC100M dataset and finetuned on ImageNet
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.swsl_resnet18_mc_dropout"></a></p>
<h4 id="swsl_resnet18_mc_dropout">swsl_resnet18_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">swsl_resnet18_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-weakly supervised Resnet-18 model pre-trained on 1B weakly supervised
image dataset and finetuned on ImageNet.
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.swsl_resnet50_mc_dropout"></a></p>
<h4 id="swsl_resnet50_mc_dropout">swsl_resnet50_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">swsl_resnet50_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-weakly supervised ResNet-50 model pre-trained on 1B weakly supervised
image dataset and finetuned on ImageNet.
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.swsl_resnext50_32x4d_mc_dropout"></a></p>
<h4 id="swsl_resnext50_32x4d_mc_dropout">swsl_resnext50_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">swsl_resnext50_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-weakly supervised ResNeXt-50 32x4 model pre-trained on 1B weakly supervised
image dataset and finetuned on ImageNet.
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.swsl_resnext101_32x4d_mc_dropout"></a></p>
<h4 id="swsl_resnext101_32x4d_mc_dropout">swsl_resnext101_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">swsl_resnext101_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-weakly supervised ResNeXt-101 32x4 model pre-trained on 1B weakly supervised
image dataset and finetuned on ImageNet.
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.swsl_resnext101_32x8d_mc_dropout"></a></p>
<h4 id="swsl_resnext101_32x8d_mc_dropout">swsl_resnext101_32x8d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">swsl_resnext101_32x8d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-weakly supervised ResNeXt-101 32x8 model pre-trained on 1B weakly supervised
image dataset and finetuned on ImageNet.
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.swsl_resnext101_32x16d_mc_dropout"></a></p>
<h4 id="swsl_resnext101_32x16d_mc_dropout">swsl_resnext101_32x16d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">swsl_resnext101_32x16d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a semi-weakly supervised ResNeXt-101 32x16 model pre-trained on 1B weakly supervised
image dataset and finetuned on ImageNet.
<code>"Billion-scale Semi-Supervised Learning for Image Classification" &lt;https://arxiv.org/abs/1905.00546&gt;</code>_
Weights from https://github.com/facebookresearch/semi-supervised-ImageNet1K-models/</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet26t_mc_dropout"></a></p>
<h4 id="ecaresnet26t_mc_dropout">ecaresnet26t_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet26t_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs an ECA-ResNeXt-26-T model.
This is technically a 28 layer ResNet, like a 'D' bag-of-tricks model but with tiered 24, 32, 64 channels
in the deep stem and ECA attn.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet50d_mc_dropout"></a></p>
<h4 id="ecaresnet50d_mc_dropout">ecaresnet50d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet50d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50-D model with eca.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet50d_pruned_mc_dropout"></a></p>
<h4 id="ecaresnet50d_pruned_mc_dropout">ecaresnet50d_pruned_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet50d_pruned_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50-D model pruned with eca.
The pruning has been obtained using https://arxiv.org/pdf/2002.08258.pdf</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet50t_mc_dropout"></a></p>
<h4 id="ecaresnet50t_mc_dropout">ecaresnet50t_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet50t_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs an ECA-ResNet-50-T model.
Like a 'D' bag-of-tricks model but with tiered 24, 32, 64 channels in the deep stem and ECA attn.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnetlight_mc_dropout"></a></p>
<h4 id="ecaresnetlight_mc_dropout">ecaresnetlight_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnetlight_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50-D light model with eca.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet101d_mc_dropout"></a></p>
<h4 id="ecaresnet101d_mc_dropout">ecaresnet101d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet101d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-101-D model with eca.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet101d_pruned_mc_dropout"></a></p>
<h4 id="ecaresnet101d_pruned_mc_dropout">ecaresnet101d_pruned_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet101d_pruned_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-101-D model pruned with eca.
The pruning has been obtained using https://arxiv.org/pdf/2002.08258.pdf</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet200d_mc_dropout"></a></p>
<h4 id="ecaresnet200d_mc_dropout">ecaresnet200d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet200d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-200-D model with ECA.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnet269d_mc_dropout"></a></p>
<h4 id="ecaresnet269d_mc_dropout">ecaresnet269d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnet269d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-269-D model with ECA.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnext26t_32x4d_mc_dropout"></a></p>
<h4 id="ecaresnext26t_32x4d_mc_dropout">ecaresnext26t_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnext26t_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs an ECA-ResNeXt-26-T model.
This is technically a 28 layer ResNet, like a 'D' bag-of-tricks model but with tiered 24, 32, 64 channels
in the deep stem. This model replaces SE module with the ECA module</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.ecaresnext50t_32x4d_mc_dropout"></a></p>
<h4 id="ecaresnext50t_32x4d_mc_dropout">ecaresnext50t_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">ecaresnext50t_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs an ECA-ResNeXt-50-T model.
This is technically a 28 layer ResNet, like a 'D' bag-of-tricks model but with tiered 24, 32, 64 channels
in the deep stem. This model replaces SE module with the ECA module</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.seresnet200d_mc_dropout"></a></p>
<h4 id="seresnet200d_mc_dropout">seresnet200d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">seresnet200d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-200-D model with SE attn.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.seresnet269d_mc_dropout"></a></p>
<h4 id="seresnet269d_mc_dropout">seresnet269d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">seresnet269d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-269-D model with SE attn.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.seresnext26d_32x4d_mc_dropout"></a></p>
<h4 id="seresnext26d_32x4d_mc_dropout">seresnext26d_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">seresnext26d_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a SE-ResNeXt-26-D model.`
This is technically a 28 layer ResNet, using the 'D' modifier from Gluon / bag-of-tricks for
combination of deep stem and avg_pool in downsample.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.seresnext26t_32x4d_mc_dropout"></a></p>
<h4 id="seresnext26t_32x4d_mc_dropout">seresnext26t_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">seresnext26t_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a SE-ResNet-26-T model.
This is technically a 28 layer ResNet, like a 'D' bag-of-tricks model but with tiered 24, 32, 64 channels
in the deep stem.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.seresnext26tn_32x4d_mc_dropout"></a></p>
<h4 id="seresnext26tn_32x4d_mc_dropout">seresnext26tn_32x4d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">seresnext26tn_32x4d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a SE-ResNeXt-26-T model.
NOTE I deprecated previous 't' model defs and replaced 't' with 'tn', this was the only tn model of note
so keeping this def for backwards compat with any uses out there. Old 't' model is lost.</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetblur18_mc_dropout"></a></p>
<h4 id="resnetblur18_mc_dropout">resnetblur18_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetblur18_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-18 model with blur anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetblur50_mc_dropout"></a></p>
<h4 id="resnetblur50_mc_dropout">resnetblur50_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetblur50_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50 model with blur anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetblur50d_mc_dropout"></a></p>
<h4 id="resnetblur50d_mc_dropout">resnetblur50d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetblur50d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50-D model with blur anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetblur101d_mc_dropout"></a></p>
<h4 id="resnetblur101d_mc_dropout">resnetblur101d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetblur101d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-101-D model with blur anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetaa34d_mc_dropout"></a></p>
<h4 id="resnetaa34d_mc_dropout">resnetaa34d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetaa34d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-34-D model w/ avgpool anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetaa50_mc_dropout"></a></p>
<h4 id="resnetaa50_mc_dropout">resnetaa50_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetaa50_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50 model with avgpool anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetaa50d_mc_dropout"></a></p>
<h4 id="resnetaa50d_mc_dropout">resnetaa50d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetaa50d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-50-D model with avgpool anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetaa101d_mc_dropout"></a></p>
<h4 id="resnetaa101d_mc_dropout">resnetaa101d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetaa101d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-101-D model with avgpool anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.seresnetaa50d_mc_dropout"></a></p>
<h4 id="seresnetaa50d_mc_dropout">seresnetaa50d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">seresnetaa50d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a SE=ResNet-50-D model with avgpool anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.seresnextaa101d_32x8d_mc_dropout"></a></p>
<h4 id="seresnextaa101d_32x8d_mc_dropout">seresnextaa101d_32x8d_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">seresnextaa101d_32x8d_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a SE=ResNeXt-101-D 32x8d model with avgpool anti-aliasing</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetrs50_mc_dropout"></a></p>
<h4 id="resnetrs50_mc_dropout">resnetrs50_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetrs50_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-RS-50 model.
Paper: Revisiting ResNets - https://arxiv.org/abs/2103.07579
Pretrained weights from https://github.com/tensorflow/tpu/tree/bee9c4f6/models/official/resnet/resnet_rs</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetrs101_mc_dropout"></a></p>
<h4 id="resnetrs101_mc_dropout">resnetrs101_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetrs101_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-RS-101 model.
Paper: Revisiting ResNets - https://arxiv.org/abs/2103.07579
Pretrained weights from https://github.com/tensorflow/tpu/tree/bee9c4f6/models/official/resnet/resnet_rs</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetrs152_mc_dropout"></a></p>
<h4 id="resnetrs152_mc_dropout">resnetrs152_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetrs152_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-RS-152 model.
Paper: Revisiting ResNets - https://arxiv.org/abs/2103.07579
Pretrained weights from https://github.com/tensorflow/tpu/tree/bee9c4f6/models/official/resnet/resnet_rs</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetrs200_mc_dropout"></a></p>
<h4 id="resnetrs200_mc_dropout">resnetrs200_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetrs200_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-RS-200 model.
Paper: Revisiting ResNets - https://arxiv.org/abs/2103.07579
Pretrained weights from https://github.com/tensorflow/tpu/tree/bee9c4f6/models/official/resnet/resnet_rs</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetrs270_mc_dropout"></a></p>
<h4 id="resnetrs270_mc_dropout">resnetrs270_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetrs270_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-RS-270 model.
Paper: Revisiting ResNets - https://arxiv.org/abs/2103.07579
Pretrained weights from https://github.com/tensorflow/tpu/tree/bee9c4f6/models/official/resnet/resnet_rs</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetrs350_mc_dropout"></a></p>
<h4 id="resnetrs350_mc_dropout">resnetrs350_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetrs350_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-RS-350 model.
Paper: Revisiting ResNets - https://arxiv.org/abs/2103.07579
Pretrained weights from https://github.com/tensorflow/tpu/tree/bee9c4f6/models/official/resnet/resnet_rs</p>
<p><a id="hannah.models._vendor.resnet_mc_dropout.resnetrs420_mc_dropout"></a></p>
<h4 id="resnetrs420_mc_dropout">resnetrs420_mc_dropout</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">resnetrs420_mc_dropout</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>Constructs a ResNet-RS-420 model
Paper: Revisiting ResNets - https://arxiv.org/abs/2103.07579
Pretrained weights from https://github.com/tensorflow/tpu/tree/bee9c4f6/models/official/resnet/resnet_rs</p>
<p><a id="hannah.models._vendor"></a></p>
<h1 id="hannahmodels_vendor">hannah.models._vendor</h1>
<p><a id="hannah.models._vendor.focalnet"></a></p>
<h1 id="hannahmodels_vendorfocalnet">hannah.models._vendor.focalnet</h1>
<p><a id="hannah.models._vendor.focalnet.Mlp"></a></p>
<h2 id="mlp-objects">Mlp Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Mlp</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.Mlp.forward"></a></p>
<h4 id="forward_20">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models._vendor.focalnet.FocalModulation"></a></p>
<h2 id="focalmodulation-objects">FocalModulation Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FocalModulation</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.FocalModulation.forward"></a></p>
<h4 id="forward_21">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>x</code> - input features with shape of (B, H, W, C)</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.FocalModulation.extra_repr"></a></p>
<h4 id="extra_repr">extra_repr</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">extra_repr</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.FocalModulation.flops"></a></p>
<h4 id="flops">flops</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">flops</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</code></pre></div>

<p>calculate flops for 1 window with token length of N</p>
<p><strong>Arguments</strong>:</p>
<p>N:</p>
<p><a id="hannah.models._vendor.focalnet.FocalNetBlock"></a></p>
<h2 id="focalnetblock-objects">FocalNetBlock Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FocalNetBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Focal Modulation Network Block.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>dim(int)</code> - Number of input channels.</li>
<li><code>input_resolution(tuple[int])</code> - Input resulotion.</li>
<li><code>mlp_ratio(float)</code> - Ratio of mlp hidden dim to embedding dim.</li>
<li><code>drop(float)</code> - Dropout rate. Default: 0.0</li>
<li><code>drop_path(float)</code> - Stochastic depth rate. Default: 0.0</li>
<li><code>act_layer(nn.Module)</code> - Activation layer. Default: nn.GELU</li>
<li><code>norm_layer(nn.Module)</code> - Normalization layer.  Default: nn.LayerNorm</li>
<li><code>focal_level(int)</code> - Number of focal levels.</li>
<li><code>focal_window(int)</code> - Focal window size at first focal level</li>
<li><code>use_layerscale(bool)</code> - Whether use layerscale</li>
<li><code>layerscale_value(float)</code> - Initial layerscale value</li>
<li><code>use_postln(bool)</code> - Whether use layernorm after modulation</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.FocalNetBlock.forward"></a></p>
<h4 id="forward_22">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models._vendor.focalnet.FocalNetBlock.extra_repr"></a></p>
<h4 id="extra_repr_1">extra_repr</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">extra_repr</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.FocalNetBlock.flops"></a></p>
<h4 id="flops_1">flops</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">flops</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.BasicLayer"></a></p>
<h2 id="basiclayer-objects">BasicLayer Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BasicLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>A basic Focal Transformer layer for one stage.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>dim(int)</code> - Number of input channels.</li>
<li><code>input_resolution(tuple[int])</code> - Input resolution.</li>
<li><code>depth(int)</code> - Number of blocks.</li>
<li><code>window_size(int)</code> - Local window size.</li>
<li><code>mlp_ratio(float)</code> - Ratio of mlp hidden dim to embedding dim.</li>
<li><code>qkv_bias(bool)</code> - If True, add a learnable bias to query, key, value. Default: True
  qk_scale(float | None): Override default qk scale of head_dim ** -0.5 if set.</li>
<li><code>drop(float)</code> - Dropout rate. Default: 0.0
  drop_path(float | tuple[float]): Stochastic depth rate. Default: 0.0</li>
<li><code>norm_layer(nn.Module)</code> - Normalization layer. Default: nn.LayerNorm
  downsample(nn.Module | None): Downsample layer at the end of the layer. Default: None</li>
<li><code>use_checkpoint(bool)</code> - Whether to use checkpointing to save memory. Default: False.</li>
<li><code>focal_level(int)</code> - Number of focal levels</li>
<li><code>focal_window(int)</code> - Focal window size at first focal level</li>
<li><code>use_layerscale(bool)</code> - Whether use layerscale</li>
<li><code>layerscale_value(float)</code> - Initial layerscale value</li>
<li><code>use_postln(bool)</code> - Whether use layernorm after modulation</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.BasicLayer.forward"></a></p>
<h4 id="forward_23">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:
  H:
  W:</p>
<p><a id="hannah.models._vendor.focalnet.BasicLayer.extra_repr"></a></p>
<h4 id="extra_repr_2">extra_repr</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">extra_repr</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.BasicLayer.flops"></a></p>
<h4 id="flops_2">flops</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">flops</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.PatchEmbed"></a></p>
<h2 id="patchembed-objects">PatchEmbed Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PatchEmbed</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Image to Patch Embedding</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>img_size(int)</code> - Image size.  Default: 224.</li>
<li><code>patch_size(int)</code> - Patch token size. Default: 4.</li>
<li><code>in_chans(int)</code> - Number of input image channels. Default: 3.</li>
<li><code>embed_dim(int)</code> - Number of linear projection output channels. Default: 96.</li>
<li><code>norm_layer(nn.Module)</code> - Normalization layer. Default: None</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.PatchEmbed.forward"></a></p>
<h4 id="forward_24">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models._vendor.focalnet.PatchEmbed.flops"></a></p>
<h4 id="flops_3">flops</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">flops</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.FocalNet"></a></p>
<h2 id="focalnet-objects">FocalNet Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FocalNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Focal Modulation Networks (FocalNets)</p>
<p><strong>Arguments</strong>:</p>
<p>img_size(int | tuple(int): Input image size. Default 224
  patch_size(int | tuple(int): Patch size. Default: 4
- <code>in_chans(int)</code> - Number of input image channels. Default: 3
- <code>num_classes(int)</code> - Number of classes for classification head. Default: 1000
- <code>embed_dim(int)</code> - Patch embedding dimension. Default: 96
- <code>depths(tuple(int)</code> - Depth of each Focal Transformer layer.
- <code>mlp_ratio(float)</code> - Ratio of mlp hidden dim to embedding dim. Default: 4
- <code>drop_rate(float)</code> - Dropout rate. Default: 0
- <code>drop_path_rate(float)</code> - Stochastic depth rate. Default: 0.1
- <code>norm_layer(nn.Module)</code> - Normalization layer. Default: nn.LayerNorm.
- <code>patch_norm(bool)</code> - If True, add normalization after patch embedding. Default: True
- <code>use_checkpoint(bool)</code> - Whether to use checkpointing to save memory. Default: False
- <code>focal_levels(list)</code> - How many focal levels at all stages. Note that this excludes the finest-grain level. Default: [1, 1, 1, 1]
- <code>focal_windows(list)</code> - The focal window size at all stages. Default: [7, 5, 3, 1]
- <code>use_conv_embed(bool)</code> - Whether use convolutional embedding. We noted that using convolutional embedding usually improve the performance, but we do not use it by default. Default: False
- <code>use_layerscale(bool)</code> - Whether use layerscale proposed in CaiT. Default: False
- <code>layerscale_value(float)</code> - Value for layer scale. Default: 1e-4
- <code>use_postln(bool)</code> - Whether use layernorm after modulation (it helps stablize training of large models)</p>
<p><a id="hannah.models._vendor.focalnet.FocalNet.no_weight_decay"></a></p>
<h4 id="no_weight_decay">no_weight_decay</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">ignore</span>
<span class="k">def</span> <span class="nf">no_weight_decay</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.FocalNet.no_weight_decay_keywords"></a></p>
<h4 id="no_weight_decay_keywords">no_weight_decay_keywords</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">ignore</span>
<span class="k">def</span> <span class="nf">no_weight_decay_keywords</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.FocalNet.forward_features"></a></p>
<h4 id="forward_features">forward_features</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward_features</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models._vendor.focalnet.FocalNet.forward"></a></p>
<h4 id="forward_25">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models._vendor.focalnet.FocalNet.flops"></a></p>
<h4 id="flops_4">flops</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">flops</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models._vendor.focalnet.build_transforms"></a></p>
<h4 id="build_transforms">build_transforms</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build_transforms</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">center_crop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>img_size:
- <code>center_crop</code> - (Default value = False)</p>
<p><a id="hannah.models._vendor.focalnet.build_transforms4display"></a></p>
<h4 id="build_transforms4display">build_transforms4display</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build_transforms4display</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">center_crop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>img_size:
- <code>center_crop</code> - (Default value = False)</p>
<p><a id="hannah.models._vendor.focalnet.focalnet_tiny_srf"></a></p>
<h4 id="focalnet_tiny_srf">focalnet_tiny_srf</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_tiny_srf</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_small_srf"></a></p>
<h4 id="focalnet_small_srf">focalnet_small_srf</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_small_srf</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_base_srf"></a></p>
<h4 id="focalnet_base_srf">focalnet_base_srf</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_base_srf</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_tiny_lrf"></a></p>
<h4 id="focalnet_tiny_lrf">focalnet_tiny_lrf</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_tiny_lrf</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_small_lrf"></a></p>
<h4 id="focalnet_small_lrf">focalnet_small_lrf</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_small_lrf</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_base_lrf"></a></p>
<h4 id="focalnet_base_lrf">focalnet_base_lrf</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_base_lrf</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_tiny_iso_16"></a></p>
<h4 id="focalnet_tiny_iso_16">focalnet_tiny_iso_16</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_tiny_iso_16</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_small_iso_16"></a></p>
<h4 id="focalnet_small_iso_16">focalnet_small_iso_16</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_small_iso_16</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_base_iso_16"></a></p>
<h4 id="focalnet_base_iso_16">focalnet_base_iso_16</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_base_iso_16</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_large_fl3"></a></p>
<h4 id="focalnet_large_fl3">focalnet_large_fl3</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_large_fl3</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_large_fl4"></a></p>
<h4 id="focalnet_large_fl4">focalnet_large_fl4</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_large_fl4</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_xlarge_fl3"></a></p>
<h4 id="focalnet_xlarge_fl3">focalnet_xlarge_fl3</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_xlarge_fl3</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_xlarge_fl4"></a></p>
<h4 id="focalnet_xlarge_fl4">focalnet_xlarge_fl4</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_xlarge_fl4</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_huge_fl3"></a></p>
<h4 id="focalnet_huge_fl3">focalnet_huge_fl3</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_huge_fl3</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models._vendor.focalnet.focalnet_huge_fl4"></a></p>
<h4 id="focalnet_huge_fl4">focalnet_huge_fl4</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@register_model</span>
<span class="k">def</span> <span class="nf">focalnet_huge_fl4</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pretrained</code> - (Default value = False)
  **kwargs:</li>
</ul>
<p><a id="hannah.models.wavenet.models"></a></p>
<h1 id="hannahmodelswavenetmodels">hannah.models.wavenet.models</h1>
<p><a id="hannah.models.wavenet.models.Conv"></a></p>
<h2 id="conv-objects">Conv Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Conv</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>A convolution with the option to be causal and use xavier initialization</p>
<p><a id="hannah.models.wavenet.models.Conv.forward"></a></p>
<h4 id="forward_26">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>signal:</p>
<p><a id="hannah.models.wavenet.models.WaveNet"></a></p>
<h2 id="wavenet-objects">WaveNet Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">WaveNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.wavenet.models.WaveNet.forward"></a></p>
<h4 id="forward_27">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>input_data:</p>
<p><a id="hannah.models.wavenet"></a></p>
<h1 id="hannahmodelswavenet">hannah.models.wavenet</h1>
<p><a id="hannah.models.conv_vit.operators"></a></p>
<h1 id="hannahmodelsconv_vitoperators">hannah.models.conv_vit.operators</h1>
<p><a id="hannah.models.conv_vit.attention"></a></p>
<h1 id="hannahmodelsconv_vitattention">hannah.models.conv_vit.attention</h1>
<p><a id="hannah.models.conv_vit.blocks"></a></p>
<h1 id="hannahmodelsconv_vitblocks">hannah.models.conv_vit.blocks</h1>
<p><a id="hannah.models.conv_vit.models"></a></p>
<h1 id="hannahmodelsconv_vitmodels">hannah.models.conv_vit.models</h1>
<p><a id="hannah.models.kakao_resnet"></a></p>
<h1 id="hannahmodelskakao_resnet">hannah.models.kakao_resnet</h1>
<p><a id="hannah.models.hello.models"></a></p>
<h1 id="hannahmodelshellomodels">hannah.models.hello.models</h1>
<p><a id="hannah.models.hello.models.DSConv2d"></a></p>
<h2 id="dsconv2d-objects">DSConv2d Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DSConv2d</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.hello.models.DSConv2d.forward"></a></p>
<h4 id="forward_28">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.hello.models.DSCNNSpeechModel"></a></p>
<h2 id="dscnnspeechmodel-objects">DSCNNSpeechModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DSCNNSpeechModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.hello.models.DSCNNSpeechModel.forward"></a></p>
<h4 id="forward_29">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.hello.models.DNNSpeechModel"></a></p>
<h2 id="dnnspeechmodel-objects">DNNSpeechModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DNNSpeechModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.hello.models.DNNSpeechModel.forward"></a></p>
<h4 id="forward_30">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.hello"></a></p>
<h1 id="hannahmodelshello">hannah.models.hello</h1>
<p><a id="hannah.models.ai8x.models"></a></p>
<h1 id="hannahmodelsai8xmodels">hannah.models.ai8x.models</h1>
<p>A search space based on the cifar 10 NASNet search space for ai85x devices from: htt</p>
<p><a id="hannah.models.ai8x"></a></p>
<h1 id="hannahmodelsai8x">hannah.models.ai8x</h1>
<p><a id="hannah.models.tc.models"></a></p>
<h1 id="hannahmodelstcmodels">hannah.models.tc.models</h1>
<p><a id="hannah.models.tc.models.create_act"></a></p>
<h4 id="create_act">create_act</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">create_act</span><span class="p">(</span><span class="n">act</span><span class="p">,</span> <span class="n">clipping_value</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>act:
  clipping_value:</p>
<p><a id="hannah.models.tc.models.ApproximateGlobalAveragePooling1D"></a></p>
<h2 id="approximateglobalaveragepooling1d-objects">ApproximateGlobalAveragePooling1D Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ApproximateGlobalAveragePooling1D</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.ApproximateGlobalAveragePooling1D.forward"></a></p>
<h4 id="forward_31">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.tc.models.TCResidualBlock"></a></p>
<h2 id="tcresidualblock-objects">TCResidualBlock Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TCResidualBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.TCResidualBlock.forward"></a></p>
<h4 id="forward_32">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.tc.models.TCResNetModel"></a></p>
<h2 id="tcresnetmodel-objects">TCResNetModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TCResNetModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.TCResNetModel.forward"></a></p>
<h4 id="forward_33">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.tc.models.ExitWrapperBlock"></a></p>
<h2 id="exitwrapperblock-objects">ExitWrapperBlock Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ExitWrapperBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.ExitWrapperBlock.forward"></a></p>
<h4 id="forward_34">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.tc.models.BranchyTCResNetModel"></a></p>
<h2 id="branchytcresnetmodel-objects">BranchyTCResNetModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BranchyTCResNetModel</span><span class="p">(</span><span class="n">TCResNetModel</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.BranchyTCResNetModel.on_val"></a></p>
<h4 id="on_val">on_val</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_val</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.BranchyTCResNetModel.on_val_end"></a></p>
<h4 id="on_val_end">on_val_end</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_val_end</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.BranchyTCResNetModel.on_test"></a></p>
<h4 id="on_test">on_test</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_test</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.BranchyTCResNetModel.on_test_end"></a></p>
<h4 id="on_test_end_3">on_test_end</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_test_end</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.BranchyTCResNetModel.reset_stats"></a></p>
<h4 id="reset_stats">reset_stats</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">reset_stats</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.BranchyTCResNetModel.print_stats"></a></p>
<h4 id="print_stats">print_stats</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">print_stats</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.tc.models.BranchyTCResNetModel.forward"></a></p>
<h4 id="forward_35">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.tc.models.BranchyTCResNetModel.get_loss_function"></a></p>
<h4 id="get_loss_function">get_loss_function</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_loss_function</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.tc"></a></p>
<h1 id="hannahmodelstc">hannah.models.tc</h1>
<p><a id="hannah.models.factory.quantized"></a></p>
<h1 id="hannahmodelsfactoryquantized">hannah.models.factory.quantized</h1>
<p>Import from new loacation for backwards compatibility</p>
<p><a id="hannah.models.factory.act"></a></p>
<h1 id="hannahmodelsfactoryact">hannah.models.factory.act</h1>
<p><a id="hannah.models.factory.act.DummyActivation"></a></p>
<h2 id="dummyactivation-objects">DummyActivation Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">DummyActivation</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">)</span>
</code></pre></div>

<p>Dummy class that instantiated to mark a missing activation.</p>
<p>This can be used to mark requantization of activations for convolutional layers without
activation functions.</p>
<p><strong>Arguments</strong>:</p>
<p><a id="hannah.models.factory.qat"></a></p>
<h1 id="hannahmodelsfactoryqat">hannah.models.factory.qat</h1>
<p>Import from new loacation for backwards compatibility</p>
<p><a id="hannah.models.factory.factory"></a></p>
<h1 id="hannahmodelsfactoryfactory">hannah.models.factory.factory</h1>
<p>A neural network model factory</p>
<p>It allows us to construct quantized and unquantized versions of the same network,
allows to explore implementation alternatives using a common neural network construction
interface.</p>
<p><a id="hannah.models.factory.factory.NormConfig"></a></p>
<h2 id="normconfig-objects">NormConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">NormConfig</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.BNConfig"></a></p>
<h2 id="bnconfig-objects">BNConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BNConfig</span><span class="p">(</span><span class="n">NormConfig</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.ActConfig"></a></p>
<h2 id="actconfig-objects">ActConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ActConfig</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.ELUConfig"></a></p>
<h2 id="eluconfig-objects">ELUConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ELUConfig</span><span class="p">(</span><span class="n">ActConfig</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.HardtanhConfig"></a></p>
<h2 id="hardtanhconfig-objects">HardtanhConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">HardtanhConfig</span><span class="p">(</span><span class="n">ActConfig</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.MinorBlockConfig"></a></p>
<h2 id="minorblockconfig-objects">MinorBlockConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">MinorBlockConfig</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.MinorBlockConfig.target"></a></p>
<h4 id="target">target</h4>
<p>target Operation</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.parallel"></a></p>
<h4 id="parallel">parallel</h4>
<p>execute block in parallel with preceding block</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.out_channels"></a></p>
<h4 id="out_channels">out_channels</h4>
<p>number of output channels</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.kernel_size"></a></p>
<h4 id="kernel_size">kernel_size</h4>
<p>kernel size of this Operation (if applicable)</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.stride"></a></p>
<h4 id="stride">stride</h4>
<p>stride for this operation use</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.padding"></a></p>
<h4 id="padding">padding</h4>
<p>use padding for this operation (padding will always try to keep input dimensions / stride)</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.dilation"></a></p>
<h4 id="dilation">dilation</h4>
<p>dilation factor to use for this operation</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.groups"></a></p>
<h4 id="groups">groups</h4>
<p>number of groups for this operation</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.norm"></a></p>
<h4 id="norm">norm</h4>
<p>normalization to use (true uses networks default configs)</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.act"></a></p>
<h4 id="act">act</h4>
<p>activation to use (true uses default configs)</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.upsampling"></a></p>
<h4 id="upsampling">upsampling</h4>
<p>Upsampling factor for mbconv layers</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.bias"></a></p>
<h4 id="bias">bias</h4>
<p>use bias for this operation</p>
<p><a id="hannah.models.factory.factory.MinorBlockConfig.out_quant"></a></p>
<h4 id="out_quant">out_quant</h4>
<p>use output quantization for this operation</p>
<p><a id="hannah.models.factory.factory.MajorBlockConfig"></a></p>
<h2 id="majorblockconfig-objects">MajorBlockConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">MajorBlockConfig</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.MajorBlockConfig.stride"></a></p>
<h4 id="stride_1">stride</h4>
<p>Union[None, int, Tuple[int, ...], Tuple[int, ...]]</p>
<p><a id="hannah.models.factory.factory.MajorBlockConfig.last"></a></p>
<h4 id="last">last</h4>
<p>Indicates wether this block is the last reduction block</p>
<p><a id="hannah.models.factory.factory.LinearConfig"></a></p>
<h2 id="linearconfig-objects">LinearConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LinearConfig</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.LinearConfig.norm"></a></p>
<h4 id="norm_1">norm</h4>
<p>Union[bool, NormConfig]</p>
<p><a id="hannah.models.factory.factory.LinearConfig.act"></a></p>
<h4 id="act_1">act</h4>
<p>Union[bool, ActConfig]</p>
<p><a id="hannah.models.factory.factory.NetworkConfig"></a></p>
<h2 id="networkconfig-objects">NetworkConfig Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">NetworkConfig</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.NetworkFactory"></a></p>
<h2 id="networkfactory-objects">NetworkFactory Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">NetworkFactory</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.NetworkFactory.act"></a></p>
<h4 id="act_2">act</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">ActConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>config</code> - ActConfig:</li>
<li><code>config</code> - ActConfig:</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.conv2d"></a></p>
<h4 id="conv2d">conv2d</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">conv2d</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
           <span class="n">out_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
           <span class="n">kernel_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span>
           <span class="n">stride</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
           <span class="n">padding</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
           <span class="n">dilation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
           <span class="n">groups</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
           <span class="n">norm</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BNConfig</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">act</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ActConfig</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>input_shape</code> - Tuple[int:
  int:
  int]:</li>
<li><code>out_channels</code> - int:</li>
<li><code>kernel_size</code> - Union[int:
  Tuple[int, ...]]: (Default value = 1)</li>
<li><code>stride</code> - Union[int:</li>
<li><code>padding</code> - Union[int:
  Tuple[int, ...]:</li>
<li><code>bool]</code> - (Default value = False)</li>
<li><code>dilation</code> - int:  (Default value = 0)</li>
<li><code>groups</code> - int:  (Default value = 1)</li>
<li><code>norm</code> - Union[BNConfig:</li>
<li><code>act</code> - Union[ActConfig:</li>
<li><code>bias</code> - bool:  (Default value = False)</li>
<li><code>input_shape</code> - Tuple[int:</li>
<li><code>out_channels</code> - int:</li>
<li><code>kernel_size</code> - Union[int:</li>
<li><code>stride</code> - Union[int:</li>
<li><code>padding</code> - Union[int:</li>
<li><code>dilation</code> - int:  (Default value = 0)</li>
<li><code>groups</code> - int:  (Default value = 1)</li>
<li><code>norm</code> - Union[BNConfig:</li>
<li><code>act</code> - Union[ActConfig:</li>
<li><code>bias</code> - bool:  (Default value = False)</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.mbconv1d"></a></p>
<h4 id="mbconv1d">mbconv1d</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">mbconv1d</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
             <span class="n">out_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">dilation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">padding</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">upsampling</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
             <span class="n">groups</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">norm</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BNConfig</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">act</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ActConfig</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>input_shape</code> - Tuple[int:
  int:
  int]:</li>
<li><code>out_channels</code> - int:</li>
<li><code>kernel_size</code> - int:</li>
<li><code>dilation</code> - int:  (Default value = 1)</li>
<li><code>stride</code> - int:  (Default value = 1)</li>
<li><code>padding</code> - Union[int:</li>
<li><code>bool]</code> - (Default value = False)</li>
<li><code>bias</code> - (Default value = False)</li>
<li><code>upsampling</code> - float:  (Default value = 1.0)</li>
<li><code>groups</code> - int:  (Default value = 1)</li>
<li><code>norm</code> - Union[BNConfig:</li>
<li><code>act</code> - Union[ActConfig:</li>
<li><code>input_shape</code> - Tuple[int:</li>
<li><code>out_channels</code> - int:</li>
<li><code>kernel_size</code> - int:</li>
<li><code>dilation</code> - int:  (Default value = 1)</li>
<li><code>stride</code> - int:  (Default value = 1)</li>
<li><code>padding</code> - Union[int:</li>
<li><code>upsampling</code> - float:  (Default value = 1.0)</li>
<li><code>groups</code> - int:  (Default value = 1)</li>
<li><code>norm</code> - Union[BNConfig:</li>
<li><code>act</code> - Union[ActConfig:</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.conv1d"></a></p>
<h4 id="conv1d">conv1d</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">conv1d</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
           <span class="n">out_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
           <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
           <span class="n">stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
           <span class="n">bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">padding</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
           <span class="n">dilation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
           <span class="n">groups</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
           <span class="n">norm</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BNConfig</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">act</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ActConfig</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">out_quant</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>input_shape</code> - Tuple[int:
  int:
  int]:</li>
<li><code>out_channels</code> - int:</li>
<li><code>kernel_size</code> - int:</li>
<li><code>stride</code> - int:  (Default value = 1)</li>
<li><code>bias</code> - bool:  (Default value = False)</li>
<li><code>padding</code> - Union[int:</li>
<li><code>bool]</code> - (Default value = False)</li>
<li><code>dilation</code> - int:  (Default value = 1)</li>
<li><code>groups</code> - int:  (Default value = 1)</li>
<li><code>norm</code> - Union[BNConfig:</li>
<li><code>act</code> - Union[ActConfig:</li>
<li><code>out_quant</code> - bool:  (Default value = True)</li>
<li><code>input_shape</code> - Tuple[int:</li>
<li><code>out_channels</code> - int:</li>
<li><code>kernel_size</code> - int:</li>
<li><code>stride</code> - int:  (Default value = 1)</li>
<li><code>bias</code> - bool:  (Default value = False)</li>
<li><code>padding</code> - Union[int:</li>
<li><code>dilation</code> - int:  (Default value = 1)</li>
<li><code>groups</code> - int:  (Default value = 1)</li>
<li><code>norm</code> - Union[BNConfig:</li>
<li><code>act</code> - Union[ActConfig:</li>
<li><code>out_quant</code> - bool:  (Default value = True)</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.minor"></a></p>
<h4 id="minor">minor</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">minor</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">MinorBlockConfig</span><span class="p">,</span> <span class="n">major_stride</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>input_shape:
- <code>config</code> - MinorBlockConfig:
- <code>major_stride</code> - (Default value = None)
- <code>config</code> - MinorBlockConfig:</p>
<p><a id="hannah.models.factory.factory.NetworkFactory.forward"></a></p>
<h4 id="forward_36">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">MajorBlockConfig</span><span class="p">)</span>
</code></pre></div>

<p>Create a forward neural network block without parallelism</p>
<p>If parallel is set to [True, False, True, False]</p>
<p>Input: -------&gt;|---&gt; parallel: False ---&gt;  parallel: False ---&gt; | --&gt; output</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>input_shape</code> - Tuple[int, ...]:</li>
<li><code>config</code> - MajorBlockConfig:</li>
<li><code>input_shape</code> - Tuple[int, ...]:</li>
<li><code>config</code> - MajorBlockConfig:</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.residual"></a></p>
<h4 id="residual">residual</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">residual</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">MajorBlockConfig</span><span class="p">)</span>
</code></pre></div>

<p>Create a neural network block with with residual parallelism</p>
<p>If parallel is set to [True, False, True, False]
|---&gt; parallel: True  ---&gt;  parallel: True  ---&gt; |
Input: -------&gt;|                                                +---&gt;
|---&gt; parallel: False ---&gt;  parallel: False ---&gt; |</p>
<p>If the major block does change the output dimensions compared to the input
and one of the branches does not contain any layers, we infer
1x1 conv of maximum group size (gcd (input_channels, output_channels)) to do the
downsampling.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>input_shape</code> - Tuple[int, ...]:</li>
<li><code>config</code> - MajorBlockConfig:</li>
<li><code>input_shape</code> - Tuple[int, ...]:</li>
<li><code>config</code> - MajorBlockConfig:</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.input"></a></p>
<h4 id="input">input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">input</span><span class="p">(</span><span class="n">in_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">MajorBlockConfig</span><span class="p">)</span>
</code></pre></div>

<p>Create a neural network block with input parallelism</p>
<p>If parallel is set to [True, False, True, False]
|---&gt; parallel: True  ---&gt; |
|---&gt; parallel: True  ---&gt; + -----------------&gt; |
Input:---------&gt;|                                               +---&gt;
|---&gt; parallel: False ---&gt; parallel: False ---&gt; |</p>
<p>If there are no parallel branches in the network. The major block is
a standard feed forward layer.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>in_channels</code> - int:</li>
<li><code>config</code> - MajorBlockConfig:</li>
<li><code>in_channels</code> - int:</li>
<li><code>config</code> - MajorBlockConfig:</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.full"></a></p>
<h4 id="full">full</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">full</span><span class="p">(</span><span class="n">in_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">MajorBlockConfig</span><span class="p">)</span>
</code></pre></div>

<p>Create a neural network block with full parallelism</p>
<p>If parallel is set to [True, False, True, False]
|---&gt; parallel: True  ---------------------------------- -|
Input:---&gt;|                                                         +---&gt;
|                           |--&gt; parallel: False ---&gt;|    |
|---&gt; parallel: False ----&gt; |                        +---&gt;|
|--&gt; parallel: True ----&gt;|</p>
<p>If there are no parallel blocks the block is a standard feed forward network.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>in_channels</code> - int:</li>
<li><code>config</code> - MajorBlockConfig:</li>
<li><code>in_channels</code> - int:</li>
<li><code>config</code> - MajorBlockConfig:</li>
</ul>
<p><a id="hannah.models.factory.factory.NetworkFactory.major"></a></p>
<h4 id="major">major</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">major</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">MajorBlockConfig</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>input_shape:
- <code>config</code> - MajorBlockConfig:
- <code>config</code> - MajorBlockConfig:</p>
<p><a id="hannah.models.factory.factory.NetworkFactory.linear"></a></p>
<h4 id="linear">linear</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">LinearConfig</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>input_shape:
- <code>config</code> - LinearConfig:
- <code>config</code> - LinearConfig:</p>
<p><a id="hannah.models.factory.factory.NetworkFactory.identity"></a></p>
<h4 id="identity">identity</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">identity</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Identity</span>
</code></pre></div>

<p><a id="hannah.models.factory.factory.NetworkFactory.network"></a></p>
<h4 id="network">network</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">network</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">network_config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ListConfig</span><span class="p">,</span>
                                                            <span class="n">DictConfig</span><span class="p">])</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>input_shape:
- <code>labels</code> - int:
- <code>network_config</code> - NetworkConfig:
- <code>labels</code> - int:
- <code>network_config</code> - NetworkConfig:</p>
<p><a id="hannah.models.factory.factory.create_cnn"></a></p>
<h4 id="create_cnn">create_cnn</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">create_cnn</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
               <span class="n">labels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
               <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">conv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MajorBlockConfig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">linear</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">LinearConfig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">norm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NormConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">act</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ActConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">qconfig</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>input_shape</code> - Sequence[int]:</li>
<li><code>labels</code> - int:</li>
<li><code>name</code> - str:</li>
<li><code>conv</code> - Optional[List[MajorBlockConfig]]:  (Default value = None)</li>
<li><code>linear</code> - Optional[List[LinearConfig]]:  (Default value = None)</li>
<li><code>norm</code> - Optional[NormConfig]:  (Default value = None)</li>
<li><code>act</code> - Optional[ActConfig]:  (Default value = None)</li>
<li><code>qconfig</code> - Any:  (Default value = None)</li>
<li><code>dropout</code> - float:  (Default value = 0.5)</li>
<li><code>input_shape</code> - Sequence[int]:</li>
<li><code>labels</code> - int:</li>
<li><code>name</code> - str:</li>
<li><code>conv</code> - Optional[List[MajorBlockConfig]]:  (Default value = None)</li>
<li><code>linear</code> - Optional[List[LinearConfig]]:  (Default value = None)</li>
<li><code>norm</code> - Optional[NormConfig]:  (Default value = None)</li>
<li><code>act</code> - Optional[ActConfig]:  (Default value = None)</li>
<li><code>qconfig</code> - Any:  (Default value = None)</li>
<li><code>dropout</code> - float:  (Default value = 0.5)</li>
</ul>
<p><a id="hannah.models.factory.network"></a></p>
<h1 id="hannahmodelsfactorynetwork">hannah.models.factory.network</h1>
<p><a id="hannah.models.factory.network.ConvNet"></a></p>
<h2 id="convnet-objects">ConvNet Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConvNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.factory.network.ConvNet.forward"></a></p>
<h4 id="forward_37">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.factory.reduction"></a></p>
<h1 id="hannahmodelsfactoryreduction">hannah.models.factory.reduction</h1>
<p><a id="hannah.models.factory.reduction.ReductionBlockAdd"></a></p>
<h2 id="reductionblockadd-objects">ReductionBlockAdd Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ReductionBlockAdd</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Reduction block that sums over its inputs</p>
<p><a id="hannah.models.factory.reduction.ReductionBlockAdd.forward"></a></p>
<h4 id="forward_38">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>x</code> - Tensor:</li>
<li><code>x</code> - Tensor:</li>
</ul>
<p><a id="hannah.models.factory.reduction.ReductionBlockConcat"></a></p>
<h2 id="reductionblockconcat-objects">ReductionBlockConcat Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ReductionBlockConcat</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Reduction block that concatenates its inputs</p>
<p><a id="hannah.models.factory.reduction.ReductionBlockConcat.forward"></a></p>
<h4 id="forward_39">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>x</code> - Tensor:</li>
<li><code>x</code> - Tensor:</li>
</ul>
<p><a id="hannah.models.factory.pooling"></a></p>
<h1 id="hannahmodelsfactorypooling">hannah.models.factory.pooling</h1>
<p><a id="hannah.models.factory.pooling.ApproximateGlobalAveragePooling1D"></a></p>
<h2 id="approximateglobalaveragepooling1d-objects_1">ApproximateGlobalAveragePooling1D Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ApproximateGlobalAveragePooling1D</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>A global average pooling layer, that divides by the next power of 2 instead of true number of elements</p>
<p><a id="hannah.models.factory.pooling.ApproximateGlobalAveragePooling1D.forward"></a></p>
<h4 id="forward_40">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.factory.pooling.ApproximateGlobalAveragePooling2D"></a></p>
<h2 id="approximateglobalaveragepooling2d-objects">ApproximateGlobalAveragePooling2D Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ApproximateGlobalAveragePooling2D</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>A global average pooling layer, that divides by the next power of 2 instead of true number of elements</p>
<p><a id="hannah.models.factory.pooling.ApproximateGlobalAveragePooling2D.forward"></a></p>
<h4 id="forward_41">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.factory.qconfig"></a></p>
<h1 id="hannahmodelsfactoryqconfig">hannah.models.factory.qconfig</h1>
<p>Import from new loacation for backwards compatibility</p>
<p><a id="hannah.models.factory.rounding"></a></p>
<h1 id="hannahmodelsfactoryrounding">hannah.models.factory.rounding</h1>
<p>Import from new loacation for backwards compatibility</p>
<p><a id="hannah.models.factory"></a></p>
<h1 id="hannahmodelsfactory">hannah.models.factory</h1>
<p><a id="hannah.models.sinc.models"></a></p>
<h1 id="hannahmodelssincmodels">hannah.models.sinc.models</h1>
<p><a id="hannah.models.sinc.models.GDSConv"></a></p>
<h2 id="gdsconv-objects">GDSConv Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">GDSConv</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.sinc.models.GDSConv.forward"></a></p>
<h4 id="forward_42">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.sinc.models.GDSConvBlock"></a></p>
<h2 id="gdsconvblock-objects">GDSConvBlock Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">GDSConvBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.sinc.models.GDSConvBlock.forward"></a></p>
<h4 id="forward_43">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.sinc.models.SincNet"></a></p>
<h2 id="sincnet-objects">SincNet Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SincNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.sinc.models.SincNet.forward"></a></p>
<h4 id="forward_44">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.sinc"></a></p>
<h1 id="hannahmodelssinc">hannah.models.sinc</h1>
<p><a id="hannah.models.convnet.models"></a></p>
<h1 id="hannahmodelsconvnetmodels">hannah.models.convnet.models</h1>
<p><a id="hannah.models.convnet.models.padding_expression"></a></p>
<h4 id="padding_expression_4">padding_expression</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">padding_expression</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Symbolically calculate padding such that for a given kernel_size, stride and dilation
the padding is such that the output dimension is kept the same(stride=1) or halved(stride=2).
Note: If the input dimension is 1 and stride = 2, the calculated padding will result in
an output with also dimension 1.</p>
<h2 id="parameters_4">Parameters</h2>
<p>kernel_size : Union[int, Expression]
stride : Union[int, Expression]
dilation : Union[int, Expression], optional
<em>description</em>, by default 1</p>
<h2 id="returns_4">Returns</h2>
<p>Expression</p>
<p><a id="hannah.models.convnet"></a></p>
<h1 id="hannahmodelsconvnet">hannah.models.convnet</h1>
<p><a id="hannah.models.lstm.models"></a></p>
<h1 id="hannahmodelslstmmodels">hannah.models.lstm.models</h1>
<p><a id="hannah.models.lstm.models.LSTMModel"></a></p>
<h2 id="lstmmodel-objects">LSTMModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">LSTMModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Simple LSTM model.</p>
<p><a id="hannah.models.lstm.models.LSTMModel.forward"></a></p>
<h4 id="forward_45">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.lstm"></a></p>
<h1 id="hannahmodelslstm">hannah.models.lstm</h1>
<p><a id="hannah.models"></a></p>
<h1 id="hannahmodels">hannah.models</h1>
<p><a id="hannah.models.honk.model"></a></p>
<h1 id="hannahmodelshonkmodel">hannah.models.honk.model</h1>
<p><a id="hannah.models.honk.model.truncated_normal"></a></p>
<h4 id="truncated_normal">truncated_normal</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">truncated_normal</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>tensor:
- <code>std_dev</code> - (Default value = 0.01)</p>
<p><a id="hannah.models.honk.model.SpeechResModel"></a></p>
<h2 id="speechresmodel-objects">SpeechResModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SpeechResModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.honk.model.SpeechResModel.forward"></a></p>
<h4 id="forward_46">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.honk.model.SpeechModel"></a></p>
<h2 id="speechmodel-objects">SpeechModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SpeechModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.models.honk.model.SpeechModel.forward"></a></p>
<h4 id="forward_47">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<p>x:</p>
<p><a id="hannah.models.honk"></a></p>
<h1 id="hannahmodelshonk">hannah.models.honk</h1>
<p><a id="hannah.quantization.callback"></a></p>
<h1 id="hannahquantizationcallback">hannah.quantization.callback</h1>
<p><a id="hannah.quantization.qconfig"></a></p>
<h1 id="hannahquantizationqconfig">hannah.quantization.qconfig</h1>
<p><a id="hannah.quantization.rounding"></a></p>
<h1 id="hannahquantizationrounding">hannah.quantization.rounding</h1>
<p><a id="hannah.quantization.rounding.round_downward"></a></p>
<h4 id="round_downward">round_downward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">round_downward</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Round to nearest upward</p>
<p><a id="hannah.quantization.rounding.round_upward"></a></p>
<h4 id="round_upward">round_upward</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">round_upward</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Round to nearest downward</p>
<p><a id="hannah.quantization.rounding.round_odd"></a></p>
<h4 id="round_odd">round_odd</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">round_odd</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Round to nearest odd</p>
<p><a id="hannah.quantization.rounding.round_even"></a></p>
<h4 id="round_even">round_even</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">round_even</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Round to nearest even</p>
<p><a id="hannah.quantization.rounding.round_zero"></a></p>
<h4 id="round_zero">round_zero</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">round_zero</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Round towards zero</p>
<p><a id="hannah.quantization.rounding.round_infinity"></a></p>
<h4 id="round_infinity">round_infinity</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">round_infinity</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Round toward infinity</p>
<p><a id="hannah.quantization.rounding.truncate_up"></a></p>
<h4 id="truncate_up">truncate_up</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">truncate_up</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Always round up to next integer</p>
<p><a id="hannah.quantization.rounding.truncate_down"></a></p>
<h4 id="truncate_down">truncate_down</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">truncate_down</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Always round down to next integer</p>
<p><a id="hannah.quantization.rounding.truncate_infinity"></a></p>
<h4 id="truncate_infinity">truncate_infinity</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">truncate_infinity</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Always round to next integer in direction infinity</p>
<p><a id="hannah.quantization.rounding.truncate_zero"></a></p>
<h4 id="truncate_zero">truncate_zero</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">truncate_zero</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Always round to next integer in direction of Zero</p>
<p><a id="hannah.quantization.rounding.round_stochastic"></a></p>
<h4 id="round_stochastic">round_stochastic</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">round_stochastic</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</code></pre></div>

<p>Round stochastically</p>
<p><a id="hannah.modules.config_utils"></a></p>
<h1 id="hannahmodulesconfig_utils">hannah.modules.config_utils</h1>
<p><a id="hannah.modules.config_utils.dump_config"></a></p>
<h4 id="dump_config">dump_config</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dump_config</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div>

<p>Dumps the configuration to json format</p>
<p>Creates file config.json in output_dir</p>
<h2 id="parameters_5">Parameters</h2>
<p>output_dir : str
   Output directory
config  : dict
   Configuration to dump</p>
<p><a id="hannah.modules.config_utils.save_model"></a></p>
<h4 id="save_model">save_model</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</code></pre></div>

<p>Creates serialization of the model for later inference, evaluation</p>
<p>Creates the following files:</p>
<ul>
<li>model.pt: Serialized version of network parameters in pytorch</li>
<li>model.json: Serialized version of network parameters in json format</li>
<li>model.onnx: full model including paramters in onnx format</li>
</ul>
<h2 id="parameters_6">Parameters</h2>
<p>output_dir : str
    Directory to put serialized models
model : LightningModule
    Model to serialize</p>
<p><a id="hannah.modules.classifier"></a></p>
<h1 id="hannahmodulesclassifier">hannah.modules.classifier</h1>
<p><a id="hannah.modules.augmentation.bordersearch"></a></p>
<h1 id="hannahmodulesaugmentationbordersearch">hannah.modules.augmentation.bordersearch</h1>
<p><a id="hannah.modules.augmentation.augmentation"></a></p>
<h1 id="hannahmodulesaugmentationaugmentation">hannah.modules.augmentation.augmentation</h1>
<p><a id="hannah.modules.augmentation.transforms.kornia_transforms"></a></p>
<h1 id="hannahmodulesaugmentationtransformskornia_transforms">hannah.modules.augmentation.transforms.kornia_transforms</h1>
<p><a id="hannah.modules.augmentation.transforms.registry"></a></p>
<h1 id="hannahmodulesaugmentationtransformsregistry">hannah.modules.augmentation.transforms.registry</h1>
<p><a id="hannah.modules.augmentation.transforms"></a></p>
<h1 id="hannahmodulesaugmentationtransforms">hannah.modules.augmentation.transforms</h1>
<p><a id="hannah.modules.augmentation.batch_augmentation"></a></p>
<h1 id="hannahmodulesaugmentationbatch_augmentation">hannah.modules.augmentation.batch_augmentation</h1>
<p><a id="hannah.modules.augmentation.batch_augmentation.BatchAugmentationPipeline"></a></p>
<h2 id="batchaugmentationpipeline-objects">BatchAugmentationPipeline Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BatchAugmentationPipeline</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.modules.augmentation.batch_augmentation.BatchAugmentationPipeline.__init__"></a></p>
<h4 id="__init___3">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">transforms</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div>

<p>Augmentation pipeline especially for self supervised learning</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>replica</code> <em>int</em> - number of replicated different random augmentations</li>
<li><code>transforms</code> <em>dict</em> - configuration of transforms</li>
</ul>
<p><a id="hannah.modules.augmentation.batch_augmentation.BatchAugmentationPipeline.forward"></a></p>
<h4 id="forward_48">forward</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

<p>Perform Augmentations</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>x</code> <em>torch.Tensor</em> - a torch.Tensor representing the augementation pipeline</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>Tuple[torch.Tensor, torch.Tensor]; Batch augmented with <code>replica</code> different random augmentations</p>
<p><a id="hannah.modules.augmentation"></a></p>
<h1 id="hannahmodulesaugmentation">hannah.modules.augmentation</h1>
<p><a id="hannah.modules.object_detection"></a></p>
<h1 id="hannahmodulesobject_detection">hannah.modules.object_detection</h1>
<p><a id="hannah.modules.base"></a></p>
<h1 id="hannahmodulesbase">hannah.modules.base</h1>
<p><a id="hannah.modules.base.ClassifierModule"></a></p>
<h2 id="classifiermodule-objects">ClassifierModule Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ClassifierModule</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">,</span> <span class="n">ABC</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.modules.base.ClassifierModule.total_training_steps"></a></p>
<h4 id="total_training_steps">total_training_steps</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">total_training_steps</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

<p>Total training steps inferred from datamodule and devices.</p>
<p><a id="hannah.modules.angle_classifier"></a></p>
<h1 id="hannahmodulesangle_classifier">hannah.modules.angle_classifier</h1>
<p><a id="hannah.modules.vision.anomaly_score"></a></p>
<h1 id="hannahmodulesvisionanomaly_score">hannah.modules.vision.anomaly_score</h1>
<p>class AnomalyScore(CatMetric):
def <strong>init</strong>(self, percentile, nan_strategy="warn", <strong>kwargs):
    super().<strong>init</strong>(nan_strategy=nan_strategy, </strong>kwargs)
    self.percentile = percentile</p>
<p>def compute(self):
    anomaly_score = None
    train_losses = super().compute()
    if train_losses:
        normalized_train_errors = torch.stack(train_losses) / (
            torch.max(torch.stack(train_losses), dim=0).values
        )
        anomaly_score = np.percentile(
            normalized_train_errors.cpu().numpy(), self.percentile
        )
    return anomaly_score</p>
<p><a id="hannah.modules.vision.base"></a></p>
<h1 id="hannahmodulesvisionbase">hannah.modules.vision.base</h1>
<p><a id="hannah.modules.vision.image_classifier"></a></p>
<h1 id="hannahmodulesvisionimage_classifier">hannah.modules.vision.image_classifier</h1>
<p><a id="hannah.modules.vision.loss"></a></p>
<h1 id="hannahmodulesvisionloss">hannah.modules.vision.loss</h1>
<p><a id="hannah.modules.vision.anomaly_detection"></a></p>
<h1 id="hannahmodulesvisionanomaly_detection">hannah.modules.vision.anomaly_detection</h1>
<p><a id="hannah.modules.vision.anomaly_detection.AnomalyDetectionModule"></a></p>
<h2 id="anomalydetectionmodule-objects">AnomalyDetectionModule Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AnomalyDetectionModule</span><span class="p">(</span><span class="n">VisionBaseModule</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.modules.vision.anomaly_detection.AnomalyDetectionModule.on_test_end"></a></p>
<h4 id="on_test_end_4">on_test_end</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">on_test_end</span><span class="p">()</span>
</code></pre></div>

<p>wd_dir = os.getcwd()
score, largest_train_error = self.compute_anomaly_score()
train_errors = self.normalized_train_errors
plt.hist(train_errors.detach().cpu().numpy(), bins=100)
plt.axvline(score, linestyle="dashed")
plt.title("Normalized train reconstruction errors")
plt.savefig(wd_dir + "/normalized_train_errors.png")</p>
<p>test = (
    torch.tensor(self.test_losses, device=self.device)
    / torch.max(torch.stack(self.train_losses), dim=0).values
)
plt.hist(test.detach().cpu().numpy(), bins=100)
plt.title("Normalized test reconstruction errors")
plt.savefig(wd_dir + "/normalized_test_errors.png")
print("Anomaly score", score)
print(
    "Largest train error",
    torch.max(torch.stack(self.train_losses), dim=0).values,
)</p>
<p><a id="hannah.modules.vision"></a></p>
<h1 id="hannahmodulesvision">hannah.modules.vision</h1>
<p><a id="hannah.modules.metrics"></a></p>
<h1 id="hannahmodulesmetrics">hannah.modules.metrics</h1>
<p><a id="hannah.modules.metrics.Error"></a></p>
<h2 id="error-objects">Error Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Error</span><span class="p">()</span>
</code></pre></div>

<p>Computes <code>Error</code> = 1 - Accuracy_</p>
<p>.. math::
    \text{Error} = 1 - \frac{1}{N}\sum_i^N 1(y_i = \hat{y}_i)</p>
<p>Where :math:<code>y</code> is a tensor of target values, and :math:<code>\hat{y}</code> is a tensor of predictions.</p>
<p>This module is a simple wrapper to get the task specific versions of this metric, which is done by setting the
<code>task</code> argument to either <code>'binary'</code>, <code>'multiclass'</code> or <code>multilabel</code>. See the documentation of
:mod:<code>BinaryError</code>, :mod:<code>MulticlassError</code> and :mod:<code>MultilabelError</code> for the specific details of
each argument influence and examples.</p>
<p><a id="hannah.modules.metrics.plot_confusion_matrix"></a></p>
<h4 id="plot_confusion_matrix">plot_confusion_matrix</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span>
                          <span class="n">group_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">categories</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
                          <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">percent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xyticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xyplotlabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">sum_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>This function will make a pretty plot of an sklearn Confusion Matrix cm using a Seaborn heatmap visualization.</p>
<h2 id="arguments">Arguments</h2>
<p>cf:            confusion matrix to be passed in</p>
<p>group_names:   List of strings that represent the labels row by row to be shown in each square.</p>
<p>categories:    List of strings containing the categories to be displayed on the x,y axis. Default is 'auto'</p>
<p>count:         If True, show the raw number in the confusion matrix. Default is True.</p>
<p>normalize:     If True, show the proportions for each category. Default is True.</p>
<p>cbar:          If True, show the color bar. The cbar values are based off the values in the confusion matrix.
               Default is True.</p>
<p>xyticks:       If True, show x and y ticks. Default is True.</p>
<p>xyplotlabels:  If True, show 'True Label' and 'Predicted Label' on the figure. Default is True.</p>
<p>sum_stats:     If True, display summary statistics below the figure. Default is True.</p>
<p>figsize:       Tuple representing the figure size. Default will be the matplotlib rcParams value.</p>
<p>cmap:          Colormap of the values displayed from matplotlib.pyplot.cm. Default is 'Blues'
               See http://matplotlib.org/examples/color/colormaps_reference.html</p>
<p>title:         Title for the heatmap. Default is None.</p>
<p><a id="hannah.modules"></a></p>
<h1 id="hannahmodules">hannah.modules</h1>
<p><a id="hannah.optim.madgrad"></a></p>
<h1 id="hannahoptimmadgrad">hannah.optim.madgrad</h1>
<p><a id="hannah.optim.madgrad.MADGRAD"></a></p>
<h2 id="madgrad-objects">MADGRAD Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MADGRAD</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">)</span>
</code></pre></div>

<p>MADGRAD_: A Momentumized, Adaptive, Dual Averaged Gradient Method for Stochastic
Optimization.
.. _MADGRAD: https://arxiv.org/abs/2101.11075
MADGRAD is a general purpose optimizer that can be used in place of SGD or
Adam may converge faster and generalize better. Currently GPU-only.
Typically, the same learning rate schedule that is used for SGD or Adam may
be used. The overall learning rate is not comparable to either method and
should be determined by a hyper-parameter sweep.
MADGRAD requires less weight decay than other methods, often as little as
zero. Momentum values used for SGD or Adam's beta1 should work here also.
On sparse problems both weight_decay and momentum should be set to 0.</p>
<p><strong>Arguments</strong>:</p>
<p>params (iterable):
  Iterable of parameters to optimize or dicts defining parameter groups.
  lr (float):
  Learning rate (default: 1e-2).
  momentum (float):
  Momentum value in  the range [0,1) (default: 0.9).
  weight_decay (float):
  Weight decay, i.e. a L2 penalty (default: 0).
  eps (float):
  Term added to the denominator outside of the root operation to improve numerical stability. (default: 1e-6).</p>
<p><a id="hannah.optim.madgrad.MADGRAD.step"></a></p>
<h4 id="step">step</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="n">closure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[],</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div>

<p>Performs a single optimization step.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>closure</code> <em>callable, optional</em> - A closure that reevaluates the model
  and returns the loss.</li>
</ul>
<p><a id="hannah.optim.RAdam"></a></p>
<h1 id="hannahoptimradam">hannah.optim.RAdam</h1>
<p><a id="hannah.optim"></a></p>
<h1 id="hannahoptim">hannah.optim</h1>
<p><a id="hannah.logo"></a></p>
<h1 id="hannahlogo">hannah.logo</h1>
<p><a id="hannah.train"></a></p>
<h1 id="hannahtrain">hannah.train</h1>
<p><a id="hannah.nas.functional_operators.op"></a></p>
<h1 id="hannahnasfunctional_operatorsop">hannah.nas.functional_operators.op</h1>
<p><a id="hannah.nas.functional_operators.op.scope"></a></p>
<h4 id="scope">scope</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">scope</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</code></pre></div>

<p>Decorator defining a scope in a search space. The id of every subcomponent (operators or lower-hierarchy scopes)
enclosed in a function decorated with this will be prefixed with the name of the function, creating a
hierarchical scope.</p>
<p><a id="hannah.nas.functional_operators.op.search_space"></a></p>
<h4 id="search_space">search_space</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">search_space</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</code></pre></div>

<p>Decorator to define a search space. For correct scoping,
a search space containing functional ops must be enclosed by
a function decorated with @search_space.</p>
<p><a id="hannah.nas.functional_operators.op.Bypass"></a></p>
<h2 id="bypass-objects">Bypass Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Bypass</span><span class="p">(</span><span class="n">Op</span><span class="p">)</span>
</code></pre></div>

<p>Alternative Identity()</p>
<p><a id="hannah.nas.functional_operators.torch_conversion"></a></p>
<h1 id="hannahnasfunctional_operatorstorch_conversion">hannah.nas.functional_operators.torch_conversion</h1>
<p><a id="hannah.nas.functional_operators.operators"></a></p>
<h1 id="hannahnasfunctional_operatorsoperators">hannah.nas.functional_operators.operators</h1>
<p><a id="hannah.nas.functional_operators.operators.self_attention2d"></a></p>
<h4 id="self_attention2d">self_attention2d</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@torch</span><span class="o">.</span><span class="n">fx</span><span class="o">.</span><span class="n">wrap</span>
<span class="k">def</span> <span class="nf">self_attention2d</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>q</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
<li><code>k</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
<li><code>v</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
</ul>
<p><a id="hannah.nas.functional_operators.operators.self_attention2d"></a></p>
<h4 id="self_attention2d_1">self_attention2d</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@torch</span><span class="o">.</span><span class="n">fx</span><span class="o">.</span><span class="n">wrap</span>
<span class="k">def</span> <span class="nf">self_attention2d</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>q</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
<li><code>k</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
<li><code>v</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
</ul>
<p><a id="hannah.nas.functional_operators.operators.relu_linear_attention"></a></p>
<h4 id="relu_linear_attention">relu_linear_attention</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@torch</span><span class="o">.</span><span class="n">fx</span><span class="o">.</span><span class="n">wrap</span>
<span class="k">def</span> <span class="nf">relu_linear_attention</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</code></pre></div>

<p>Adapted from EfficientViT.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>q</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
<li><code>k</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
<li><code>v</code> - Tensor, shape <code>[B, h*d, H, W]</code></li>
</ul>
<p><a id="hannah.nas.functional_operators.operators.ReluLinearAttention"></a></p>
<h2 id="relulinearattention-objects">ReluLinearAttention Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@parametrize</span>
<span class="k">class</span> <span class="nc">ReluLinearAttention</span><span class="p">(</span><span class="n">Op</span><span class="p">)</span>
</code></pre></div>

<p>Adapted from EfficientViT</p>
<p><a id="hannah.nas.functional_operators.executor"></a></p>
<h1 id="hannahnasfunctional_operatorsexecutor">hannah.nas.functional_operators.executor</h1>
<p><a id="hannah.nas.functional_operators.lazy"></a></p>
<h1 id="hannahnasfunctional_operatorslazy">hannah.nas.functional_operators.lazy</h1>
<p><a id="hannah.nas.functional_operators.shapes"></a></p>
<h1 id="hannahnasfunctional_operatorsshapes">hannah.nas.functional_operators.shapes</h1>
<p><a id="hannah.nas.functional_operators.shapes.padding_expression"></a></p>
<h4 id="padding_expression_5">padding_expression</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">padding_expression</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Symbolically calculate padding such that for a given kernel_size, stride and dilation
the padding is such that the output dimension is kept the same(stride=1) or halved(stride=2).
Note: If the input dimension is 1 and stride = 2, the calculated padding will result in
an output with also dimension 1.</p>
<h2 id="parameters_7">Parameters</h2>
<p>kernel_size : Union[int, Expression]
stride : Union[int, Expression]
dilation : Union[int, Expression], optional
<em>description</em>, by default 1</p>
<h2 id="returns_5">Returns</h2>
<p>Expression</p>
<p><a id="hannah.nas.functional_operators"></a></p>
<h1 id="hannahnasfunctional_operators">hannah.nas.functional_operators</h1>
<p><a id="hannah.nas.functional_operators.visualizer"></a></p>
<h1 id="hannahnasfunctional_operatorsvisualizer">hannah.nas.functional_operators.visualizer</h1>
<p><a id="hannah.nas.performance_prediction.protocol"></a></p>
<h1 id="hannahnasperformance_predictionprotocol">hannah.nas.performance_prediction.protocol</h1>
<p><a id="hannah.nas.performance_prediction.protocol.Predictor"></a></p>
<h2 id="predictor-objects">Predictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@runtime_checkable</span>
<span class="k">class</span> <span class="nc">Predictor</span><span class="p">(</span><span class="n">Protocol</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.performance_prediction.protocol.Predictor.predict"></a></p>
<h4 id="predict_1">predict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">ClassifierModule</span><span class="p">,</span>
            <span class="nb">input</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InputShape</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>

<p>Pedicts performance metrisc  of a model.</p>
<p>Performance metrics are returned as a dictionary with the metric name as key and the metric value as floating point value.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>model</code> <em>ClassifierModule</em> - The model to predict the performance of.</li>
<li><code>input</code> __type_, optional_ - Input shape of input  . Defaults to None.</li>
</ul>
<p><a id="hannah.nas.performance_prediction.protocol.FitablePredictor"></a></p>
<h2 id="fitablepredictor-objects">FitablePredictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FitablePredictor</span><span class="p">(</span><span class="n">Predictor</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.performance_prediction.protocol.FitablePredictor.load"></a></p>
<h4 id="load">load</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">result_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

<p>Load predefined model from a folder.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>result_folder</code> <em>str</em> - Path to the folder containing the model or training data to recreate the model.</li>
</ul>
<p><a id="hannah.nas.performance_prediction.protocol.FitablePredictor.update"></a></p>
<h4 id="update">update</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>Update the model with new data.</p>
<p><a id="hannah.nas.performance_prediction.gcn.model"></a></p>
<h1 id="hannahnasperformance_predictiongcnmodel">hannah.nas.performance_prediction.gcn.model</h1>
<p><a id="hannah.nas.performance_prediction.gcn.predictor"></a></p>
<h1 id="hannahnasperformance_predictiongcnpredictor">hannah.nas.performance_prediction.gcn.predictor</h1>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.Predictor"></a></p>
<h2 id="predictor-objects_1">Predictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Predictor</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.nas.performance_prediction.gcn.predictor.Predictor.__init__"></a></p>
<h4 id="__init___4">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">fea_name</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Parent method for different predictor classes.</p>
<h2 id="parameters_8">Parameters</h2>
<p>fea_name : str, optional
    internal name for features in the graph, as in graph.ndata[fea_name], by default 'features'</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.Predictor.train"></a></p>
<h4 id="train_2">train</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span>
          <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
          <span class="n">num_epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
          <span class="n">validation_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Train GCN model</p>
<h2 id="parameters_9">Parameters</h2>
<p>dataloader : GraphDataLoader
    training data
learning_rate : [type], optional
    by default 1e-3
num_epochs : int, optional
    by default 200
validation_dataloader : [type], optional
    if given, use this data to print validation loss, by default None
verbose : int
    if validation_dataloader is given, print validation MSE every <verbose> epoch, by default 1</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.Predictor.predict"></a></p>
<h4 id="predict_2">predict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</code></pre></div>

<p>predict cost of graph</p>
<h2 id="parameters_10">Parameters</h2>
<p>graph : dgl.Graph</p>
<h2 id="returns_6">Returns</h2>
<p>torch.Tensor
    predicted cost of given graph. Retrieve float value with .item()</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.GCNPredictor"></a></p>
<h2 id="gcnpredictor-objects">GCNPredictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">GCNPredictor</span><span class="p">(</span><span class="n">Predictor</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.performance_prediction.gcn.predictor.GCNPredictor.__init__"></a></p>
<h4 id="__init___5">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">input_feature_size</span><span class="p">,</span>
             <span class="n">hidden_units</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
             <span class="n">readout</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
             <span class="n">fea_name</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>G(raph)CN based network latency/cost predictor. End-to-end from graph to score.</p>
<h2 id="parameters_11">Parameters</h2>
<p>input_feature_size : [type]
    length of feature vector of a graph node (graph G with n nodes, each with features of length m, i.e. feature matrix F = n x m)
hidden_units : int, list, optional
    size of hidden layer (layers if list) , by default 128
readout : str, optional
    readout function that is used to aggregate node features, by default 'mean'
fea_name : str, optional
    internal name for features in the graph, as in graph.ndata[fea_name], by default 'features'</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.GCNPredictor.train_and_fit"></a></p>
<h4 id="train_and_fit">train_and_fit</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">train_and_fit</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                  <span class="n">num_epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                  <span class="n">validation_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<p>Train GCN model</p>
<h2 id="parameters_12">Parameters</h2>
<p>dataloader : GraphDataLoader
    training data
learning_rate : [type], optional
    by default 1e-3
num_epochs : int, optional
    by default 200
validation_dataloader : [type], optional
    if given, use this data to print validation loss, by default None
verbose : int
    if validation_dataloader is given, print validation MSE every <verbose> epoch, by default 1</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.GCNPredictor.predict"></a></p>
<h4 id="predict_3">predict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</code></pre></div>

<p>predict cost of graph</p>
<h2 id="parameters_13">Parameters</h2>
<p>graph : dgl.Graph</p>
<h2 id="returns_7">Returns</h2>
<p>torch.Tensor
    predicted cost of given graph. Retrieve float value with .item()</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.GaussianProcessPredictor"></a></p>
<h2 id="gaussianprocesspredictor-objects">GaussianProcessPredictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">GaussianProcessPredictor</span><span class="p">(</span><span class="n">Predictor</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.performance_prediction.gcn.predictor.GaussianProcessPredictor.__init__"></a></p>
<h4 id="__init___6">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">input_feature_size</span><span class="p">,</span>
             <span class="n">hidden_units</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
             <span class="n">embedding_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
             <span class="n">readout</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
             <span class="n">fea_name</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span>
             <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
             <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Predictor that generates a graph embedding that is used as input for a gaussian process predictor.</p>
<h2 id="parameters_14">Parameters</h2>
<p>input_feature_size : [type]
    length of feature vector of a graph node (graph G with n nodes, each with features of length m, i.e. feature matrix F = n x m)
hidden_units : int, list, optional
    size of hidden layer (layers if list) , by default 128
embedding_size: int, optional
    size of output embedding
readout : str, optional
    readout function that is used to aggregate node features, by default 'mean'
fea_name : str, optional
    internal name for features in the graph, as in graph.ndata[fea_name], by default 'features'
kernel : str, sklearn.gaussian_process.kernels.Kernel, optional
    The gaussian process kernel to use.
    input shoudl be either "default", or a sklearn Kernel() object
    by default RBF() + DotProduct() + WhiteKernel()</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.GaussianProcessPredictor.train_and_fit"></a></p>
<h4 id="train_and_fit_1">train_and_fit</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">train_and_fit</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                  <span class="n">num_epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                  <span class="n">validation_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Train GCN model, generate embeddings for training data and fit the predictor with embeddings.</p>
<h2 id="parameters_15">Parameters</h2>
<p>dataloader : GraphDataLoader
    training data
learning_rate : [type], optional
    by default 1e-3
num_epochs : int, optional
    by default 200
validation_dataloader : [type], optional
    if given, use this data to print validation loss, by default None
verbose : int
    if validation_dataloader is given, print validation MSE every <verbose> epoch,by default 1</p>
<h2 id="returns_8">Returns</h2>
<p>float
    score of predictor on TRAINING data, see sklearn doc of chosen predictor for more info</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.GaussianProcessPredictor.predict"></a></p>
<h4 id="predict_4">predict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p>Predict cost/latency of graphs.</p>
<h2 id="parameters_16">Parameters</h2>
<p>X : dgl.DGLGraph, list[DGLGraph], dgl.dataloading.GraphDataLoader
    Input graph(s)
return_std : bool, optional
    if true, return standard dev. else just mean prediction, by default True</p>
<h2 id="returns_9">Returns</h2>
<p>array (,array)
    prediction(s) , (if return_std: standard deviation(s))</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.XGBPredictor"></a></p>
<h2 id="xgbpredictor-objects">XGBPredictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">XGBPredictor</span><span class="p">(</span><span class="n">Predictor</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.performance_prediction.gcn.predictor.XGBPredictor.__init__"></a></p>
<h4 id="__init___7">__init__</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">input_feature_size</span><span class="p">,</span>
             <span class="n">hidden_units</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
             <span class="n">embedding_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
             <span class="n">readout</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
             <span class="n">fea_name</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span>
             <span class="n">xgb_param</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Predictor that generates a graph embedding that is used as input for a xgb based predictor.</p>
<h2 id="parameters_17">Parameters</h2>
<p>input_feature_size : [type]
    length of feature vector of a graph node (graph G with n nodes, each with features of length m, i.e. feature matrix F = n x m)
hidden_units : int, list, optional
    size of hidden layer (layers if list) , by default 128
embedding_size: int, optional
    size of output embedding
readout : str, optional
    readout function that is used to aggregate node features, by default 'mean'
fea_name : str, optional
    internal name for features in the graph, as in graph.ndata[fea_name], by default 'features'
xgb_param : str, dict, optional
    The xgb_parameter to use.
    See https://xgboost.readthedocs.io/en/latest/parameter.html</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.XGBPredictor.train_and_fit"></a></p>
<h4 id="train_and_fit_2">train_and_fit</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">train_and_fit</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                  <span class="n">num_epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                  <span class="n">num_round</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span>
                  <span class="n">validation_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Train GCN model, generate embeddings for training data and fit the predictor with embeddings.</p>
<h2 id="parameters_18">Parameters</h2>
<p>dataloader : GraphDataLoader
    training data
learning_rate : [type], optional
    by default 1e-3
num_epochs : int, optional
    Training epochs for the GCN embedding network, by default 200
num_round : int, optional
    training rounds for xgb booster, by default 800
validation_dataloader : [type], optional
    if given, use this data to print validation loss, by default None
verbose : int
    if validation_dataloader is given, print validation MSE every <verbose> epoch,by default 1</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.XGBPredictor.predict"></a></p>
<h4 id="predict_5">predict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Predict cost/latency of graphs.</p>
<h2 id="parameters_19">Parameters</h2>
<p>X : dgl.DGLGraph, list[DGLGraph], dgl.dataloading.GraphDataLoader
    Input graph(s)
Returns</p>
<hr />
<p>array (,array)
    prediction(s) , (if return_std: standard deviation(s))</p>
<p><a id="hannah.nas.performance_prediction.gcn.predictor.prepare_dataloader"></a></p>
<h4 id="prepare_dataloader">prepare_dataloader</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_dataloader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                       <span class="n">train_test_split</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">subset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">validation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p>helper function to construct dataloaders from NASGraphDataset</p>
<h2 id="parameters_20">Parameters</h2>
<p>dataset : NASGraphDataset</p>
<p>batch_size : int, optional
    by default 50
train_test_split : float, optional
    number between 0 and 1, the proportion of the dataset to be used for training, by default 1
subset : int, optional
    choose only <subset> many samples from the dataset. Set 0 for disabling, i.e. whole dataset. by default 0
seed : int, optional
    set seed for reproduceability
validation : bool, optional
    also output a validation set e.g. for hyperparam tuning</p>
<h2 id="returns_10">Returns</h2>
<p>tuple(GraphDataLoader, (GraphDataLoader), GraphDataLoader)
    training dataloader to be used in CostPredictor.train() and test/validation dataloader if train_test_split &gt; 0,
    else len(test_dataloader) == 0</p>
<p><a id="hannah.nas.performance_prediction.mlonmcu.predictor"></a></p>
<h1 id="hannahnasperformance_predictionmlonmcupredictor">hannah.nas.performance_prediction.mlonmcu.predictor</h1>
<p><a id="hannah.nas.performance_prediction.mlonmcu"></a></p>
<h1 id="hannahnasperformance_predictionmlonmcu">hannah.nas.performance_prediction.mlonmcu</h1>
<p><a id="hannah.nas.performance_prediction.examples.gcn_predictor_example"></a></p>
<h1 id="hannahnasperformance_predictionexamplesgcn_predictor_example">hannah.nas.performance_prediction.examples.gcn_predictor_example</h1>
<p><a id="hannah.nas.performance_prediction.examples.gaussian_process_predictor_example"></a></p>
<h1 id="hannahnasperformance_predictionexamplesgaussian_process_predictor_example">hannah.nas.performance_prediction.examples.gaussian_process_predictor_example</h1>
<p><a id="hannah.nas.performance_prediction.examples.xgb_predictor_example"></a></p>
<h1 id="hannahnasperformance_predictionexamplesxgb_predictor_example">hannah.nas.performance_prediction.examples.xgb_predictor_example</h1>
<p><a id="hannah.nas.performance_prediction.examples.ri_capsule_performance_predictor"></a></p>
<h1 id="hannahnasperformance_predictionexamplesri_capsule_performance_predictor">hannah.nas.performance_prediction.examples.ri_capsule_performance_predictor</h1>
<p><a id="hannah.nas.performance_prediction.examples.gcn_model_example"></a></p>
<h1 id="hannahnasperformance_predictionexamplesgcn_model_example">hannah.nas.performance_prediction.examples.gcn_model_example</h1>
<p><a id="hannah.nas.performance_prediction.simple"></a></p>
<h1 id="hannahnasperformance_predictionsimple">hannah.nas.performance_prediction.simple</h1>
<p><a id="hannah.nas.performance_prediction.simple.MACPredictor"></a></p>
<h2 id="macpredictor-objects">MACPredictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MACPredictor</span><span class="p">()</span>
</code></pre></div>

<p>A predictor class that instantiates the model and calculates abstract metrics</p>
<p><a id="hannah.nas.performance_prediction.simple.GCNPredictor"></a></p>
<h2 id="gcnpredictor-objects_1">GCNPredictor Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">GCNPredictor</span><span class="p">()</span>
</code></pre></div>

<p>A predictor class that instantiates the model and uses the backends predict function to predict performance metrics</p>
<p><a id="hannah.nas.performance_prediction.features.dataset"></a></p>
<h1 id="hannahnasperformance_predictionfeaturesdataset">hannah.nas.performance_prediction.features.dataset</h1>
<p><a id="hannah.nas.performance_prediction.features.graph_conversion"></a></p>
<h1 id="hannahnasperformance_predictionfeaturesgraph_conversion">hannah.nas.performance_prediction.features.graph_conversion</h1>
<p><a id="hannah.nas.performance_prediction"></a></p>
<h1 id="hannahnasperformance_prediction">hannah.nas.performance_prediction</h1>
<p><a id="hannah.nas.constraints.dfg_constraint_model"></a></p>
<h1 id="hannahnasconstraintsdfg_constraint_model">hannah.nas.constraints.dfg_constraint_model</h1>
<p><a id="hannah.nas.constraints.dfg_constraint_model.ConstraintModel"></a></p>
<h2 id="constraintmodel-objects">ConstraintModel Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ConstraintModel</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.nas.constraints.dfg_constraint_model.ConstraintModel.process_optype"></a></p>
<h4 id="process_optype">process_optype</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">process_optype</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">OpType</span><span class="p">)</span>
</code></pre></div>

<p>Extracts the constraints based on the type of op.
New variables are added to self.vars and the constraints
are added to the solver.</p>
<h2 id="parameters_21">Parameters</h2>
<p>op : OpType</p>
<p><a id="hannah.nas.constraints.dfg_constraint_model.ConstraintModel.process_tensor"></a></p>
<h4 id="process_tensor">process_tensor</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">process_tensor</span><span class="p">(</span><span class="n">tensor</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span>
</code></pre></div>

<p>Goes through all axis and extracts the constraints for
the respective axis sizes</p>
<h2 id="parameters_22">Parameters</h2>
<p>tensor : Tensor</p>
<p><a id="hannah.nas.constraints.constraint_model"></a></p>
<h1 id="hannahnasconstraintsconstraint_model">hannah.nas.constraints.constraint_model</h1>
<p><a id="hannah.nas.constraints.random_walk"></a></p>
<h1 id="hannahnasconstraintsrandom_walk">hannah.nas.constraints.random_walk</h1>
<p><a id="hannah.nas.ops"></a></p>
<h1 id="hannahnasops">hannah.nas.ops</h1>
<p><a id="hannah.nas.core.parametrized"></a></p>
<h1 id="hannahnascoreparametrized">hannah.nas.core.parametrized</h1>
<p><a id="hannah.nas.core.expression"></a></p>
<h1 id="hannahnascoreexpression">hannah.nas.core.expression</h1>
<p><a id="hannah.nas.core"></a></p>
<h1 id="hannahnascore">hannah.nas.core</h1>
<p><a id="hannah.nas.graph_conversion"></a></p>
<h1 id="hannahnasgraph_conversion">hannah.nas.graph_conversion</h1>
<p><a id="hannah.nas.spaces.mobilenet.mobilenet"></a></p>
<h1 id="hannahnasspacesmobilenetmobilenet">hannah.nas.spaces.mobilenet.mobilenet</h1>
<p><a id="hannah.nas.spaces.darts.darts_space"></a></p>
<h1 id="hannahnasspacesdartsdarts_space">hannah.nas.spaces.darts.darts_space</h1>
<p><a id="hannah.nas.__main__"></a></p>
<h1 id="hannahnas__main__">hannah.nas.__main__</h1>
<p><a id="hannah.nas.config"></a></p>
<h1 id="hannahnasconfig">hannah.nas.config</h1>
<p><a id="hannah.nas.config.Scalar"></a></p>
<h2 id="scalar-objects">Scalar Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Scalar</span><span class="p">()</span>
</code></pre></div>

<p>Representation of all the options to define
a scalar.</p>
<p><a id="hannah.nas.expressions.op"></a></p>
<h1 id="hannahnasexpressionsop">hannah.nas.expressions.op</h1>
<p><a id="hannah.nas.expressions.types"></a></p>
<h1 id="hannahnasexpressionstypes">hannah.nas.expressions.types</h1>
<p><a id="hannah.nas.expressions.choice"></a></p>
<h1 id="hannahnasexpressionschoice">hannah.nas.expressions.choice</h1>
<p><a id="hannah.nas.expressions.utils"></a></p>
<h1 id="hannahnasexpressionsutils">hannah.nas.expressions.utils</h1>
<p><a id="hannah.nas.expressions.placeholder"></a></p>
<h1 id="hannahnasexpressionsplaceholder">hannah.nas.expressions.placeholder</h1>
<p><a id="hannah.nas.expressions.shapes"></a></p>
<h1 id="hannahnasexpressionsshapes">hannah.nas.expressions.shapes</h1>
<p><a id="hannah.nas.expressions.conditions"></a></p>
<h1 id="hannahnasexpressionsconditions">hannah.nas.expressions.conditions</h1>
<p><a id="hannah.nas.expressions.metrics"></a></p>
<h1 id="hannahnasexpressionsmetrics">hannah.nas.expressions.metrics</h1>
<p><a id="hannah.nas.expressions.arithmetic"></a></p>
<h1 id="hannahnasexpressionsarithmetic">hannah.nas.expressions.arithmetic</h1>
<p><a id="hannah.nas.expressions"></a></p>
<h1 id="hannahnasexpressions">hannah.nas.expressions</h1>
<p><a id="hannah.nas.expressions.logic"></a></p>
<h1 id="hannahnasexpressionslogic">hannah.nas.expressions.logic</h1>
<p><a id="hannah.nas.utils"></a></p>
<h1 id="hannahnasutils">hannah.nas.utils</h1>
<p><a id="hannah.nas.utils.is_pareto"></a></p>
<h4 id="is_pareto">is_pareto</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">is_pareto</span><span class="p">(</span><span class="n">costs</span><span class="p">,</span> <span class="n">maximise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong>:</p>
<ul>
<li><code>costs</code>: An (n_points, n_costs) array</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>A (n_points, ) boolean array, indicating whether each point is Pareto efficient</p>
<p><a id="hannah.nas.fx.tracer"></a></p>
<h1 id="hannahnasfxtracer">hannah.nas.fx.tracer</h1>
<p><a id="hannah.nas.fx.tracer.InliningTracer"></a></p>
<h2 id="inliningtracer-objects">InliningTracer Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">InliningTracer</span><span class="p">(</span><span class="n">SearchSpaceTracer</span><span class="p">)</span>
</code></pre></div>

<p>Inline all search space functions, into the graph.</p>
<p>This generates a standard pytorch.fx graph module containing only replacing the search space parametrizable functions with their equivalent form torch.functional`</p>
<p><a id="hannah.nas.test.test_adjacency"></a></p>
<h1 id="hannahnastesttest_adjacency">hannah.nas.test.test_adjacency</h1>
<p><a id="hannah.nas.test.test_scoping"></a></p>
<h1 id="hannahnastesttest_scoping">hannah.nas.test.test_scoping</h1>
<p><a id="hannah.nas.test.network"></a></p>
<h1 id="hannahnastestnetwork">hannah.nas.test.network</h1>
<p><a id="hannah.nas.test.test_constraint_model"></a></p>
<h1 id="hannahnastesttest_constraint_model">hannah.nas.test.test_constraint_model</h1>
<p><a id="hannah.nas.test.test_operators"></a></p>
<h1 id="hannahnastesttest_operators">hannah.nas.test.test_operators</h1>
<p><a id="hannah.nas.test.test_add"></a></p>
<h1 id="hannahnastesttest_add">hannah.nas.test.test_add</h1>
<p><a id="hannah.nas.test.test_nas_graph_dataset_for_predictor"></a></p>
<h1 id="hannahnastesttest_nas_graph_dataset_for_predictor">hannah.nas.test.test_nas_graph_dataset_for_predictor</h1>
<p><a id="hannah.nas.test.test_conditions"></a></p>
<h1 id="hannahnastesttest_conditions">hannah.nas.test.test_conditions</h1>
<p><a id="hannah.nas.test.test_op_to_torch_conversion"></a></p>
<h1 id="hannahnastesttest_op_to_torch_conversion">hannah.nas.test.test_op_to_torch_conversion</h1>
<p><a id="hannah.nas.test.test_onnx_export"></a></p>
<h1 id="hannahnastesttest_onnx_export">hannah.nas.test.test_onnx_export</h1>
<p><a id="hannah.nas.test.test_functional_ops"></a></p>
<h1 id="hannahnastesttest_functional_ops">hannah.nas.test.test_functional_ops</h1>
<p><a id="hannah.nas.test.test_functional_ops.conv_relu"></a></p>
<h4 id="conv_relu">conv_relu</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">conv_relu</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">)</span>
</code></pre></div>

<p>Example for a functional block containing conv and relu</p>
<p><a id="hannah.nas.test.test_parameters"></a></p>
<h1 id="hannahnastesttest_parameters">hannah.nas.test.test_parameters</h1>
<p><a id="hannah.nas.test.test_graph_transformer"></a></p>
<h1 id="hannahnastesttest_graph_transformer">hannah.nas.test.test_graph_transformer</h1>
<p><a id="hannah.nas.test.test_parameter_scopes"></a></p>
<h1 id="hannahnastesttest_parameter_scopes">hannah.nas.test.test_parameter_scopes</h1>
<p><a id="hannah.nas.test.test_dataflow"></a></p>
<h1 id="hannahnastesttest_dataflow">hannah.nas.test.test_dataflow</h1>
<p><a id="hannah.nas.test.test_arithmetic"></a></p>
<h1 id="hannahnastesttest_arithmetic">hannah.nas.test.test_arithmetic</h1>
<p><a id="hannah.nas.test.test_arithmetic.test_unimplemeted"></a></p>
<h4 id="test_unimplemeted">test_unimplemeted</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;x,y&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="n">IntScalarParameter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="n">IntScalarParameter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">IntScalarParameter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">DefaultInt</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_unimplemeted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>

<p>Test that unimplemented methods raise unimplemented errors</p>
<p><a id="hannah.nas.test.test_functional_training"></a></p>
<h1 id="hannahnastesttest_functional_training">hannah.nas.test.test_functional_training</h1>
<p><a id="hannah.nas.test.test_random_walk_constrainer"></a></p>
<h1 id="hannahnastesttest_random_walk_constrainer">hannah.nas.test.test_random_walk_constrainer</h1>
<p><a id="hannah.nas.test.test_mobilenet"></a></p>
<h1 id="hannahnastesttest_mobilenet">hannah.nas.test.test_mobilenet</h1>
<p><a id="hannah.nas.test.test_dfg_removal"></a></p>
<h1 id="hannahnastesttest_dfg_removal">hannah.nas.test.test_dfg_removal</h1>
<p><a id="hannah.nas.test.test_lazy_torch"></a></p>
<h1 id="hannahnastesttest_lazy_torch">hannah.nas.test.test_lazy_torch</h1>
<p><a id="hannah.nas.test.test_parametrize"></a></p>
<h1 id="hannahnastesttest_parametrize">hannah.nas.test.test_parametrize</h1>
<p><a id="hannah.nas.test.test_darts_space"></a></p>
<h1 id="hannahnastesttest_darts_space">hannah.nas.test.test_darts_space</h1>
<p><a id="hannah.nas.test.test_repeat"></a></p>
<h1 id="hannahnastesttest_repeat">hannah.nas.test.test_repeat</h1>
<p><a id="hannah.nas.test.test_z3"></a></p>
<h1 id="hannahnastesttest_z3">hannah.nas.test.test_z3</h1>
<p><a id="hannah.nas.test.test_conv2d"></a></p>
<h1 id="hannahnastesttest_conv2d">hannah.nas.test.test_conv2d</h1>
<p><a id="hannah.nas.test.test_description_ultratrail"></a></p>
<h1 id="hannahnastesttest_description_ultratrail">hannah.nas.test.test_description_ultratrail</h1>
<p><a id="hannah.nas.test.test_functional_executor"></a></p>
<h1 id="hannahnastesttest_functional_executor">hannah.nas.test.test_functional_executor</h1>
<p><a id="hannah.nas.plotter"></a></p>
<h1 id="hannahnasplotter">hannah.nas.plotter</h1>
<p><a id="hannah.nas.hardware_description.device"></a></p>
<h1 id="hannahnashardware_descriptiondevice">hannah.nas.hardware_description.device</h1>
<p><a id="hannah.nas.hardware_description.ultratrail"></a></p>
<h1 id="hannahnashardware_descriptionultratrail">hannah.nas.hardware_description.ultratrail</h1>
<p><a id="hannah.nas.hardware_description.memory_type"></a></p>
<h1 id="hannahnashardware_descriptionmemory_type">hannah.nas.hardware_description.memory_type</h1>
<p><a id="hannah.nas.hardware_description"></a></p>
<h1 id="hannahnashardware_description">hannah.nas.hardware_description</h1>
<p><a id="hannah.nas.hardware_description.description"></a></p>
<h1 id="hannahnashardware_descriptiondescription">hannah.nas.hardware_description.description</h1>
<p><a id="hannah.nas.eval.plot"></a></p>
<h1 id="hannahnasevalplot">hannah.nas.eval.plot</h1>
<p><a id="hannah.nas.eval.__main__"></a></p>
<h1 id="hannahnaseval__main__">hannah.nas.eval.__main__</h1>
<p><a id="hannah.nas.eval.extract"></a></p>
<h1 id="hannahnasevalextract">hannah.nas.eval.extract</h1>
<p><a id="hannah.nas.eval"></a></p>
<h1 id="hannahnaseval">hannah.nas.eval</h1>
<p><a id="hannah.nas.eval.prepare"></a></p>
<h1 id="hannahnasevalprepare">hannah.nas.eval.prepare</h1>
<p><a id="hannah.nas.eval.prepare.prepare_summary"></a></p>
<h4 id="prepare_summary">prepare_summary</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_summary</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
                    <span class="n">base_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
                    <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

<p>Prepare a summary of one or multiple nas runs</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>data</code> <em>Dict[str, str]</em> - A mapping from a short name for a nas run "e.g KWS" to a folder containing nas history file e.g. "trained_models/nas_kws/conv_net_trax"</li>
<li><code>base_dir</code> <em>str</em> - base directory paths in data mapping are interpreted relative to base directory</li>
<li><code>force</code> <em>bool</em> - force reconstructing of cached results ("data.pkl")</li>
</ul>
<p><a id="hannah.nas.parameters.parametrize"></a></p>
<h1 id="hannahnasparametersparametrize">hannah.nas.parameters.parametrize</h1>
<p><a id="hannah.nas.parameters.lazy"></a></p>
<h1 id="hannahnasparameterslazy">hannah.nas.parameters.lazy</h1>
<p><a id="hannah.nas.parameters.iterators"></a></p>
<h1 id="hannahnasparametersiterators">hannah.nas.parameters.iterators</h1>
<p><a id="hannah.nas.parameters"></a></p>
<h1 id="hannahnasparameters">hannah.nas.parameters</h1>
<p><a id="hannah.nas.parameters.parameters"></a></p>
<h1 id="hannahnasparametersparameters">hannah.nas.parameters.parameters</h1>
<p><a id="hannah.nas.dataflow.quantization_type"></a></p>
<h1 id="hannahnasdataflowquantization_type">hannah.nas.dataflow.quantization_type</h1>
<p><a id="hannah.nas.dataflow.scoping_utils"></a></p>
<h1 id="hannahnasdataflowscoping_utils">hannah.nas.dataflow.scoping_utils</h1>
<p><a id="hannah.nas.dataflow.axis_type"></a></p>
<h1 id="hannahnasdataflowaxis_type">hannah.nas.dataflow.axis_type</h1>
<p><a id="hannah.nas.dataflow.axis_type.AxisTuple"></a></p>
<h2 id="axistuple-objects">AxisTuple Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@parametrize</span>
<span class="k">class</span> <span class="nc">AxisTuple</span><span class="p">()</span>
</code></pre></div>

<p>Used to have the axis dict as a parametrized object</p>
<p><a id="hannah.nas.dataflow.dataflow_utils"></a></p>
<h1 id="hannahnasdataflowdataflow_utils">hannah.nas.dataflow.dataflow_utils</h1>
<p><a id="hannah.nas.dataflow.register_ops"></a></p>
<h1 id="hannahnasdataflowregister_ops">hannah.nas.dataflow.register_ops</h1>
<p><a id="hannah.nas.dataflow.transformations.graph_tranformer"></a></p>
<h1 id="hannahnasdataflowtransformationsgraph_tranformer">hannah.nas.dataflow.transformations.graph_tranformer</h1>
<p><a id="hannah.nas.dataflow.tensor_expression"></a></p>
<h1 id="hannahnasdataflowtensor_expression">hannah.nas.dataflow.tensor_expression</h1>
<p><a id="hannah.nas.dataflow.op_type"></a></p>
<h1 id="hannahnasdataflowop_type">hannah.nas.dataflow.op_type</h1>
<p><a id="hannah.nas.dataflow.compression_type"></a></p>
<h1 id="hannahnasdataflowcompression_type">hannah.nas.dataflow.compression_type</h1>
<p><a id="hannah.nas.dataflow.data_type"></a></p>
<h1 id="hannahnasdataflowdata_type">hannah.nas.dataflow.data_type</h1>
<p><a id="hannah.nas.dataflow.ops.identity"></a></p>
<h1 id="hannahnasdataflowopsidentity">hannah.nas.dataflow.ops.identity</h1>
<p><a id="hannah.nas.dataflow.ops.dropout"></a></p>
<h1 id="hannahnasdataflowopsdropout">hannah.nas.dataflow.ops.dropout</h1>
<p><a id="hannah.nas.dataflow.ops.sum"></a></p>
<h1 id="hannahnasdataflowopssum">hannah.nas.dataflow.ops.sum</h1>
<p><a id="hannah.nas.dataflow.ops.add"></a></p>
<h1 id="hannahnasdataflowopsadd">hannah.nas.dataflow.ops.add</h1>
<p><a id="hannah.nas.dataflow.ops.relu"></a></p>
<h1 id="hannahnasdataflowopsrelu">hannah.nas.dataflow.ops.relu</h1>
<p><a id="hannah.nas.dataflow.ops.linear"></a></p>
<h1 id="hannahnasdataflowopslinear">hannah.nas.dataflow.ops.linear</h1>
<p><a id="hannah.nas.dataflow.ops.conv2d"></a></p>
<h1 id="hannahnasdataflowopsconv2d">hannah.nas.dataflow.ops.conv2d</h1>
<p><a id="hannah.nas.dataflow.ops.pooling"></a></p>
<h1 id="hannahnasdataflowopspooling">hannah.nas.dataflow.ops.pooling</h1>
<p><a id="hannah.nas.dataflow.ops.batch_nom"></a></p>
<h1 id="hannahnasdataflowopsbatch_nom">hannah.nas.dataflow.ops.batch_nom</h1>
<p><a id="hannah.nas.dataflow.ops.concat"></a></p>
<h1 id="hannahnasdataflowopsconcat">hannah.nas.dataflow.ops.concat</h1>
<p><a id="hannah.nas.dataflow.ops"></a></p>
<h1 id="hannahnasdataflowops">hannah.nas.dataflow.ops</h1>
<p><a id="hannah.nas.dataflow.analysis.dataflow_analysis"></a></p>
<h1 id="hannahnasdataflowanalysisdataflow_analysis">hannah.nas.dataflow.analysis.dataflow_analysis</h1>
<p><a id="hannah.nas.dataflow.tensor_type"></a></p>
<h1 id="hannahnasdataflowtensor_type">hannah.nas.dataflow.tensor_type</h1>
<p><a id="hannah.nas.dataflow.optional_op"></a></p>
<h1 id="hannahnasdataflowoptional_op">hannah.nas.dataflow.optional_op</h1>
<p><a id="hannah.nas.dataflow.dataflow_graph"></a></p>
<h1 id="hannahnasdataflowdataflow_graph">hannah.nas.dataflow.dataflow_graph</h1>
<p><a id="hannah.nas.dataflow.dataflow_graph.DataFlowGraph"></a></p>
<h2 id="dataflowgraph-objects">DataFlowGraph Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@parametrize</span>
<span class="k">class</span> <span class="nc">DataFlowGraph</span><span class="p">(</span><span class="n">TensorExpression</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.dataflow.dataflow_graph.DataFlowGraph.link_users"></a></p>
<h4 id="link_users">link_users</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">link_users</span><span class="p">()</span>
</code></pre></div>

<p>Link the DFG to its users and the users of the DFG to
the DFG</p>
<p><a id="hannah.nas.dataflow.dataflow_graph.collect_users"></a></p>
<h4 id="collect_users">collect_users</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">collect_users</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</code></pre></div>

<p>Traverse graph starting from <code>node</code> and collect
all users (including users from subsequent nodes).
If a node_b is NOT in collect_users(node_a), this means
that node_b is either BEFORE node_a in the graph OR it is
in a parallel branch.</p>
<h2 id="parameters_23">Parameters</h2>
<p>node : <em>type</em>
    <em>description</em></p>
<h2 id="returns_11">Returns</h2>
<p><em>type</em>
    <em>description</em></p>
<p><a id="hannah.nas.dataflow.dataflow_graph.find_first_input"></a></p>
<h4 id="find_first_input">find_first_input</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">find_first_input</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</code></pre></div>

<p>Recusively traverses the graph from the given node
back to its first input. NOTE: The traversal is via OPERANDS
and not OUTPUT, meaning that e.g. weight Tensors that are
included in Ops in a DFG are not returned</p>
<h2 id="parameters_24">Parameters</h2>
<p>node : <em>type</em>
    <em>description</em></p>
<h2 id="returns_12">Returns</h2>
<p><em>type</em>
    <em>description</em></p>
<p><a id="hannah.nas.dataflow.tensor"></a></p>
<h1 id="hannahnasdataflowtensor">hannah.nas.dataflow.tensor</h1>
<p><a id="hannah.nas.dataflow.registry"></a></p>
<h1 id="hannahnasdataflowregistry">hannah.nas.dataflow.registry</h1>
<p><a id="hannah.nas.dataflow.repeat"></a></p>
<h1 id="hannahnasdataflowrepeat">hannah.nas.dataflow.repeat</h1>
<p><a id="hannah.nas.dataflow"></a></p>
<h1 id="hannahnasdataflow">hannah.nas.dataflow</h1>
<p><a id="hannah.nas"></a></p>
<h1 id="hannahnas">hannah.nas</h1>
<p><a id="hannah.nas.parametrization"></a></p>
<h1 id="hannahnasparametrization">hannah.nas.parametrization</h1>
<p><a id="hannah.nas.parametrization.ScalarParameterState"></a></p>
<h2 id="scalarparameterstate-objects">ScalarParameterState Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ScalarParameterState</span><span class="p">(</span><span class="n">ParameterState</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.parametrization.ScalarParameterState.sigma"></a></p>
<h4 id="sigma">sigma</h4>
<p>variance of sampling parameter</p>
<p><a id="hannah.nas.search.search"></a></p>
<h1 id="hannahnassearchsearch">hannah.nas.search.search</h1>
<p><a id="hannah.nas.search.model_trainer.simple_model_trainer"></a></p>
<h1 id="hannahnassearchmodel_trainersimple_model_trainer">hannah.nas.search.model_trainer.simple_model_trainer</h1>
<p><a id="hannah.nas.search.search_old"></a></p>
<h1 id="hannahnassearchsearch_old">hannah.nas.search.search_old</h1>
<p><a id="hannah.nas.search.search_old.AgingEvolution"></a></p>
<h2 id="agingevolution-objects">AgingEvolution Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AgingEvolution</span><span class="p">()</span>
</code></pre></div>

<p>Aging Evolution based multi objective optimization</p>
<p><a id="hannah.nas.search.search_old.AgingEvolution.next_parameters"></a></p>
<h4 id="next_parameters">next_parameters</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">next_parameters</span><span class="p">()</span>
</code></pre></div>

<p>Returns a list of current tasks</p>
<p><a id="hannah.nas.search.search_old.AgingEvolution.tell_result"></a></p>
<h4 id="tell_result">tell_result</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">tell_result</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
</code></pre></div>

<p>Tell the result of a task</p>
<p><a id="hannah.nas.search.utils"></a></p>
<h1 id="hannahnassearchutils">hannah.nas.search.utils</h1>
<p><a id="hannah.nas.search.sampler.base_sampler"></a></p>
<h1 id="hannahnassearchsamplerbase_sampler">hannah.nas.search.sampler.base_sampler</h1>
<p><a id="hannah.nas.search.sampler.base_sampler.Sampler"></a></p>
<h2 id="sampler-objects">Sampler Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Sampler</span><span class="p">(</span><span class="n">ABC</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.nas.search.sampler.base_sampler.Sampler.tell_result"></a></p>
<h4 id="tell_result_1">tell_result</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">tell_result</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
</code></pre></div>

<p>Tell the result of a task</p>
<p><a id="hannah.nas.search.sampler.aging_evolution"></a></p>
<h1 id="hannahnassearchsampleraging_evolution">hannah.nas.search.sampler.aging_evolution</h1>
<p><a id="hannah.nas.search.sampler.aging_evolution.AgingEvolutionSampler"></a></p>
<h2 id="agingevolutionsampler-objects">AgingEvolutionSampler Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AgingEvolutionSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">)</span>
</code></pre></div>

<p>Aging Evolution based multi objective optimization</p>
<p><a id="hannah.nas.search.sampler.aging_evolution.AgingEvolutionSampler.next_parameters"></a></p>
<h4 id="next_parameters_1">next_parameters</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">next_parameters</span><span class="p">()</span>
</code></pre></div>

<p>Returns a list of current tasks</p>
<p><a id="hannah.nas.search.sampler.aging_evolution.AgingEvolutionSampler.tell_result"></a></p>
<h4 id="tell_result_2">tell_result</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">tell_result</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
</code></pre></div>

<p>Tell the result of a task</p>
<p><a id="hannah.nas.search.sampler.mutator"></a></p>
<h1 id="hannahnassearchsamplermutator">hannah.nas.search.sampler.mutator</h1>
<p><a id="hannah.nas.search.sampler.random_sampler"></a></p>
<h1 id="hannahnassearchsamplerrandom_sampler">hannah.nas.search.sampler.random_sampler</h1>
<p><a id="hannah.nas.search.sampler.defined_space_sampler"></a></p>
<h1 id="hannahnassearchsamplerdefined_space_sampler">hannah.nas.search.sampler.defined_space_sampler</h1>
<p><a id="hannah.nas.search.presampler.simple"></a></p>
<h1 id="hannahnassearchpresamplersimple">hannah.nas.search.presampler.simple</h1>
<p><a id="hannah.nas.search.weight_sharing"></a></p>
<h1 id="hannahnassearchweight_sharing">hannah.nas.search.weight_sharing</h1>
<p><a id="hannah.nas.export.onnx"></a></p>
<h1 id="hannahnasexportonnx">hannah.nas.export.onnx</h1>
<p><a id="hannah.nas.export.onnx.eval"></a></p>
<h4 id="eval_2">eval</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">exp_tree</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

<p>Recursively evaluate expressions organized as a pytree</p>
<p><a id="hannah.nas.export"></a></p>
<h1 id="hannahnasexport">hannah.nas.export</h1>
<p><a id="hannah.conf.optimizer"></a></p>
<h1 id="hannahconfoptimizer">hannah.conf.optimizer</h1>
<p><a id="hannah.conf.optimizer.SGDConf"></a></p>
<h2 id="sgdconf-objects">SGDConf Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SGDConf</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.conf.optimizer.SGDConf.lr"></a></p>
<h4 id="lr">lr</h4>
<p>_RequiredParameter</p>
<p><a id="hannah.conf.optimizer.MADGRADConf"></a></p>
<h2 id="madgradconf-objects">MADGRADConf Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">MADGRADConf</span><span class="p">()</span>
</code></pre></div>

<p><a id="hannah.conf.optimizer.MADGRADConf.lr"></a></p>
<h4 id="lr_1">lr</h4>
<p>_RequiredParameter</p>
<p><a id="hannah.conf.nas"></a></p>
<h1 id="hannahconfnas">hannah.conf.nas</h1>
<p><a id="hannah.conf.scheduler"></a></p>
<h1 id="hannahconfscheduler">hannah.conf.scheduler</h1>
<p><a id="hannah.conf.scheduler.OneCycleLRConf"></a></p>
<h2 id="onecyclelrconf-objects">OneCycleLRConf Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">OneCycleLRConf</span><span class="p">()</span>
</code></pre></div>

<p>Config for one cycle lr total steps are configured from module</p>
<p><a id="hannah.conf"></a></p>
<h1 id="hannahconf">hannah.conf</h1>
<p><a id="hannah.utils.dvclive"></a></p>
<h1 id="hannahutilsdvclive">hannah.utils.dvclive</h1>
<p><a id="hannah.utils.logger"></a></p>
<h1 id="hannahutilslogger">hannah.utils.logger</h1>
<p><a id="hannah.utils.logger.JSONLogger"></a></p>
<h2 id="jsonlogger-objects">JSONLogger Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">JSONLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">)</span>
</code></pre></div>

<p><a id="hannah.utils.logger.JSONLogger.name"></a></p>
<h4 id="name">name</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">name</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p>Gets the name of the experiment.</p>
<p><strong>Returns</strong>:</p>
<p>The name of the experiment.</p>
<p><a id="hannah.utils.logger.JSONLogger.version"></a></p>
<h4 id="version">version</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">version</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</code></pre></div>

<p>Gets the version of the experiment.</p>
<p><strong>Returns</strong>:</p>
<p>The version of the experiment if it is specified, else the next version.</p>
<p><a id="hannah.utils.logger.JSONLogger.root_dir"></a></p>
<h4 id="root_dir">root_dir</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">root_dir</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p>Gets the save directory where the versioned JSON experiments are saved.</p>
<p><a id="hannah.utils.logger.JSONLogger.log_dir"></a></p>
<h4 id="log_dir">log_dir</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">log_dir</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p>The log directory for this run.</p>
<p>By default, it is named <code>'version_${self.version}'</code> but it can be overridden by passing a string value for the
constructor's version parameter instead of <code>None</code> or an int.</p>
<p><a id="hannah.utils.logger.JSONLogger.experiment"></a></p>
<h4 id="experiment">experiment</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@property</span>
<span class="nd">@rank_zero_experiment</span>
<span class="k">def</span> <span class="nf">experiment</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;_ExperimentWriter&quot;</span>
</code></pre></div>

<p>Actual ExperimentWriter object. To use ExperimentWriter features anywhere in your code, do the following.</p>
<p>Example::</p>
<p>self.logger.experiment.some_experiment_writer_function()</p>
<p><a id="hannah.utils.logger._ExperimentWriter"></a></p>
<h2 id="_experimentwriter-objects">_ExperimentWriter Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">_ExperimentWriter</span><span class="p">()</span>
</code></pre></div>

<p>Experiment writer for CSVLogger.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>log_dir</code> - Directory for the experiment logs</li>
</ul>
<p><a id="hannah.utils.logger._ExperimentWriter.log_metrics"></a></p>
<h4 id="log_metrics">log_metrics</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">log_metrics</span><span class="p">(</span><span class="n">metrics_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
                <span class="n">step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Record metrics.</p>
<p><a id="hannah.utils.logger._ExperimentWriter.save"></a></p>
<h4 id="save">save</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Save recorded metrics into files.</p>
<p><a id="hannah.utils.imports"></a></p>
<h1 id="hannahutilsimports">hannah.utils.imports</h1>
<p><a id="hannah.utils.imports.lazy_import"></a></p>
<h4 id="lazy_import">lazy_import</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">lazy_import</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>Returns a proxy module object that will lazily import the given module the first time it is used.
Example usage::</p>
<h1 id="lazy-version-of-import-tensorflow-as-tf">Lazy version of <code>import tensorflow as tf</code></h1>
<p>tf = lazy_import("tensorflow")</p>
<h1 id="other-commands">Other commands</h1>
<h1 id="now-the-module-is-loaded">Now the module is loaded</h1>
<p>tf.<strong>version</strong></p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>module_name</code> - the fully-qualified module name to import</li>
<li><code>callback</code> <em>None</em> - a callback function to call before importing the
  module</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>a proxy module object that will be lazily imported when first used</p>
<p><a id="hannah.utils.imports.LazyModule"></a></p>
<h2 id="lazymodule-objects">LazyModule Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">LazyModule</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">)</span>
</code></pre></div>

<p>Proxy module that lazily imports the underlying module the first time it is actually used.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>module_name</code> - the fully-qualified module name to import</li>
<li><code>callback</code> <em>None</em> - a callback function to call before importing the
  module</li>
</ul>
<p><a id="hannah.utils.utils"></a></p>
<h1 id="hannahutilsutils">hannah.utils.utils</h1>
<p><a id="hannah.utils.utils.log_execution_env_state"></a></p>
<h4 id="log_execution_env_state">log_execution_env_state</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">log_execution_env_state</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Log information about the execution environment.</p>
<p><a id="hannah.utils.utils.git_version"></a></p>
<h4 id="git_version">git_version</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">git_version</span><span class="p">(</span><span class="n">short</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p>Return the current git sha</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>short</code> <em>bool</em> - If True, return the short (7 character) version of the SHA</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>str</code> - The current git SHA</li>
</ul>
<p><a id="hannah.utils.utils.extract_from_download_cache"></a></p>
<h4 id="extract_from_download_cache">extract_from_download_cache</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_from_download_cache</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span>
                                <span class="n">url</span><span class="p">,</span>
                                <span class="n">cached_files</span><span class="p">,</span>
                                <span class="n">target_cache</span><span class="p">,</span>
                                <span class="n">target_folder</span><span class="p">,</span>
                                <span class="n">target_test_folder</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                <span class="n">clear_download</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">no_exist_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>extracts given file from cache or donwloads first from url</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>filename</code> <em>str</em> - name of the file to download or extract</li>
<li><code>url</code> <em>str</em> - possible url to download the file
  cached_files (list(str)): cached files in download cache</li>
<li><code>target_cache</code> <em>str</em> - path to the folder to cache file if download necessary</li>
<li><code>target_folder</code> <em>str</em> - path where to extract file</li>
<li><code>target_test_folder</code> <em>str, optional</em> - folder to check if data are already there</li>
<li><code>clear_download</code> <em>bool</em> - clear download after usage</li>
<li><code>no_exist_check</code> <em>bool</em> - disables the check if folder exists</li>
</ul>
<p><a id="hannah.utils.utils.fullname"></a></p>
<h4 id="fullname">fullname</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">fullname</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

<p>Get the full classname of an object including surrounding packages/modules/namespaces</p>
<p><a id="hannah.utils.utils.set_deterministic"></a></p>
<h4 id="set_deterministic">set_deterministic</h4>
<div class="codehilite"><pre><span></span><code><span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">set_deterministic</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">warn_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p>A contextmanager to set deterministic algorithms</p>
<p><a id="hannah.utils.tuple"></a></p>
<h1 id="hannahutilstuple">hannah.utils.tuple</h1>
<p><a id="hannah.utils"></a></p>
<h1 id="hannahutils">hannah.utils</h1>
<p><a id="hannah.normalizer"></a></p>
<h1 id="hannahnormalizer">hannah.normalizer</h1>
<p><a id="hannah.normalizer.FixedPointNormalizer"></a></p>
<h2 id="fixedpointnormalizer-objects">FixedPointNormalizer Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">FixedPointNormalizer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Simple feature normalizer for fixed point models</p>
<p><a id="hannah.normalizer.AdaptiveFixedPointNormalizer"></a></p>
<h2 id="adaptivefixedpointnormalizer-objects">AdaptiveFixedPointNormalizer Objects</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">AdaptiveFixedPointNormalizer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</code></pre></div>

<p>Simple feature normalizer for fixed point models</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../profiling/" class="btn btn-neutral float-left" title="Profiling"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../profiling/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
