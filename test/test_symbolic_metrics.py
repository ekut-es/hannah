from omegaconf import OmegaConf
import torch
from hannah.models.embedded_vision_net.models import search_space
from hannah.nas.functional_operators.executor import BasicExecutor
from hannah.nas.functional_operators.op import Tensor
from hannah.callbacks.summaries import FxMACSummaryCallback
from hannah.nas.parameters.parametrize import set_parametrization


PARAMS = {"ChoiceOp_0.num_blocks": 1,
          "block_9.ChoiceOp_0.residual_choice": 1,
          "block_9.ChoiceOp_0.depth": 0,
          "block_9.pattern_2.ChoiceOp_0.choice": 4,
          "block_9.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_9.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_9.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_9.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_9.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_9.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_9.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_9.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 4,
          "block_9.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_9.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_9.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_9.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_9.pattern_2.Conv2d_0.weight.kernel_size": 3,
          "block_9.pattern_2.Conv2d_0.weight.out_channels": 48,
          "block_9.pattern_1.ChoiceOp_0.choice": 1,
          "block_9.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_9.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_9.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_9.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_9.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_9.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_9.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_9.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_9.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_9.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_9.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_9.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_9.pattern_1.Conv2d_0.weight.kernel_size": 9,
          "block_9.pattern_1.Conv2d_0.weight.out_channels": 288,
          "block_9.pattern_0.ChoiceOp_0.choice": 3,
          "block_9.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_9.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_9.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_9.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_9.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_9.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_9.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_9.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_9.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_9.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_9.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_9.pattern_0.Conv2d_0.stride": 1,
          "block_9.pattern_0.Conv2d_0.weight.kernel_size": 9,
          "block_9.pattern_0.Conv2d_0.weight.out_channels": 384,
          "block_8.ChoiceOp_0.residual_choice": 0,
          "block_8.ChoiceOp_0.depth": 1,
          "block_8.pattern_2.ChoiceOp_0.choice": 1,
          "block_8.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_8.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_8.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_8.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_8.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_8.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 4,
          "block_8.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_8.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_8.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 6,
          "block_8.pattern_2.Conv2d_0.weight.kernel_size": 3,
          "block_8.pattern_2.Conv2d_0.weight.out_channels": 496,
          "block_8.pattern_1.ChoiceOp_0.choice": 0,
          "block_8.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_8.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_8.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_8.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_8.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_8.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_8.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_8.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_8.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_8.pattern_1.Conv2d_0.weight.kernel_size": 3,
          "block_8.pattern_1.Conv2d_0.weight.out_channels": 272,
          "block_8.pattern_0.ChoiceOp_0.choice": 4,
          "block_8.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_8.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_8.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_8.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_8.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_8.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_8.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_8.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_8.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_8.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_8.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 5,
          "block_8.pattern_0.Conv2d_0.stride": 2,
          "block_8.pattern_0.Conv2d_0.weight.kernel_size": 9,
          "block_8.pattern_0.Conv2d_0.weight.out_channels": 232,
          "block_7.ChoiceOp_0.residual_choice": 0,
          "block_7.ChoiceOp_0.depth": 2,
          "block_7.pattern_2.ChoiceOp_0.choice": 0,
          "block_7.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_7.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_7.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_7.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_7.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_7.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_7.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_7.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_7.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_7.pattern_2.Conv2d_0.weight.kernel_size": 3,
          "block_7.pattern_2.Conv2d_0.weight.out_channels": 248,
          "block_7.pattern_1.ChoiceOp_0.choice": 3,
          "block_7.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_7.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_7.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_7.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_7.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_7.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 4,
          "block_7.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_7.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_7.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 2,
          "block_7.pattern_1.Conv2d_0.weight.kernel_size": 5,
          "block_7.pattern_1.Conv2d_0.weight.out_channels": 104,
          "block_7.pattern_0.ChoiceOp_0.choice": 3,
          "block_7.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_7.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_7.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_7.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_7.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_7.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_7.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_7.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_7.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_7.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_7.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 3,
          "block_7.pattern_0.Conv2d_0.stride": 2,
          "block_7.pattern_0.Conv2d_0.weight.kernel_size": 5,
          "block_7.pattern_0.Conv2d_0.weight.out_channels": 336,
          "block_6.ChoiceOp_0.residual_choice": 0,
          "block_6.ChoiceOp_0.depth": 0,
          "block_6.pattern_2.ChoiceOp_0.choice": 3,
          "block_6.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_6.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_6.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_6.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_6.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_6.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_6.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_6.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_6.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_6.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 1,
          "block_6.pattern_2.Conv2d_0.weight.kernel_size": 9,
          "block_6.pattern_2.Conv2d_0.weight.out_channels": 160,
          "block_6.pattern_1.ChoiceOp_0.choice": 2,
          "block_6.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_6.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_6.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_6.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_6.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_6.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_6.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_6.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 2,
          "block_6.pattern_1.Conv2d_0.weight.kernel_size": 9,
          "block_6.pattern_1.Conv2d_0.weight.out_channels": 384,
          "block_6.pattern_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_6.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_6.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_6.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_6.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 4,
          "block_6.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_6.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_6.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_6.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_6.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 3,
          "block_6.pattern_0.Conv2d_0.stride": 1,
          "block_6.pattern_0.Conv2d_0.weight.kernel_size": 3,
          "block_6.pattern_0.Conv2d_0.weight.out_channels": 40,
          "block_5.ChoiceOp_0.residual_choice": 1,
          "block_5.ChoiceOp_0.depth": 1,
          "block_5.pattern_2.ChoiceOp_0.choice": 1,
          "block_5.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_5.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_5.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_5.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_5.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_5.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 4,
          "block_5.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_5.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_5.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 2,
          "block_5.pattern_2.Conv2d_0.weight.kernel_size": 7,
          "block_5.pattern_2.Conv2d_0.weight.out_channels": 272,
          "block_5.pattern_1.ChoiceOp_0.choice": 1,
          "block_5.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_5.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_5.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_5.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_5.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_5.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 4,
          "block_5.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_5.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_5.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 3,
          "block_5.pattern_1.Conv2d_0.weight.kernel_size": 9,
          "block_5.pattern_1.Conv2d_0.weight.out_channels": 400,
          "block_5.pattern_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_5.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_5.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_5.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_5.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_5.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 4,
          "block_5.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_5.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_5.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_5.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_5.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 3,
          "block_5.pattern_0.Conv2d_0.stride": 1,
          "block_5.pattern_0.Conv2d_0.weight.kernel_size": 7,
          "block_5.pattern_0.Conv2d_0.weight.out_channels": 32,
          "block_4.ChoiceOp_0.residual_choice": 0,
          "block_4.ChoiceOp_0.depth": 1,
          "block_4.pattern_2.ChoiceOp_0.choice": 3,
          "block_4.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_4.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_4.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_4.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_4.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_4.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_4.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_4.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_4.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 3,
          "block_4.pattern_2.Conv2d_0.weight.kernel_size": 9,
          "block_4.pattern_2.Conv2d_0.weight.out_channels": 136,
          "block_4.pattern_1.ChoiceOp_0.choice": 1,
          "block_4.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_4.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_4.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_4.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_4.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_4.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_4.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_4.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_4.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 2,
          "block_4.pattern_1.Conv2d_0.weight.kernel_size": 7,
          "block_4.pattern_1.Conv2d_0.weight.out_channels": 208,
          "block_4.pattern_0.ChoiceOp_0.choice": 2,
          "block_4.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_4.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_4.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_4.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_4.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_4.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_4.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_4.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_4.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_4.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_4.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_4.pattern_0.Conv2d_0.stride": 2,
          "block_4.pattern_0.Conv2d_0.weight.kernel_size": 3,
          "block_4.pattern_0.Conv2d_0.weight.out_channels": 320,
          "block_3.ChoiceOp_0.residual_choice": 0,
          "block_3.ChoiceOp_0.depth": 0,
          "block_3.pattern_2.ChoiceOp_0.choice": 4,
          "block_3.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_3.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_3.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_3.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_3.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_3.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_3.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_3.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 16,
          "block_3.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 5,
          "block_3.pattern_2.Conv2d_0.weight.kernel_size": 3,
          "block_3.pattern_2.Conv2d_0.weight.out_channels": 80,
          "block_3.pattern_1.ChoiceOp_0.choice": 3,
          "block_3.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_3.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_3.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_3.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_3.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_3.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_3.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_3.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_3.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 3,
          "block_3.pattern_1.Conv2d_0.weight.kernel_size": 9,
          "block_3.pattern_1.Conv2d_0.weight.out_channels": 272,
          "block_3.pattern_0.ChoiceOp_0.choice": 2,
          "block_3.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_3.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_3.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_3.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_3.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_3.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_3.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_3.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_3.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_3.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_3.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 2,
          "block_3.pattern_0.Conv2d_0.stride": 1,
          "block_3.pattern_0.Conv2d_0.weight.kernel_size": 5,
          "block_3.pattern_0.Conv2d_0.weight.out_channels": 248,
          "block_2.ChoiceOp_0.residual_choice": 1,
          "block_2.ChoiceOp_0.depth": 0,
          "block_2.pattern_2.ChoiceOp_0.choice": 4,
          "block_2.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_2.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_2.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_2.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_2.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_2.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_2.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_2.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_2.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_2.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_2.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 1,
          "block_2.pattern_2.Conv2d_0.weight.kernel_size": 3,
          "block_2.pattern_2.Conv2d_0.weight.out_channels": 280,
          "block_2.pattern_1.ChoiceOp_0.choice": 4,
          "block_2.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_2.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_2.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_2.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_2.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_2.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_2.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_2.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_2.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_2.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_2.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_2.pattern_1.Conv2d_0.weight.kernel_size": 7,
          "block_2.pattern_1.Conv2d_0.weight.out_channels": 432,
          "block_2.pattern_0.ChoiceOp_0.choice": 4,
          "block_2.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_2.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_2.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_2.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_2.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_2.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_2.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_2.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_2.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_2.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_2.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_2.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_2.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 2,
          "block_2.pattern_0.Conv2d_0.stride": 1,
          "block_2.pattern_0.Conv2d_0.weight.kernel_size": 7,
          "block_2.pattern_0.Conv2d_0.weight.out_channels": 88,
          "block_1.ChoiceOp_0.residual_choice": 1,
          "block_1.ChoiceOp_0.depth": 0,
          "block_1.pattern_2.ChoiceOp_0.choice": 4,
          "block_1.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_1.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_1.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_1.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_1.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_1.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_1.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_1.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_1.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 4,
          "block_1.pattern_2.Conv2d_0.weight.kernel_size": 3,
          "block_1.pattern_2.Conv2d_0.weight.out_channels": 248,
          "block_1.pattern_1.ChoiceOp_0.choice": 3,
          "block_1.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_1.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_1.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_1.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_1.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_1.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 3,
          "block_1.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_1.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_1.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 1,
          "block_1.pattern_1.Conv2d_0.weight.kernel_size": 5,
          "block_1.pattern_1.Conv2d_0.weight.out_channels": 488,
          "block_1.pattern_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_1.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_1.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_1.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_1.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_1.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_1.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_1.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_1.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_1.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_1.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 2,
          "block_1.pattern_0.Conv2d_0.stride": 1,
          "block_1.pattern_0.Conv2d_0.weight.kernel_size": 5,
          "block_1.pattern_0.Conv2d_0.weight.out_channels": 120,
          "block_0.ChoiceOp_0.residual_choice": 1,
          "stem_0.Conv2d_0.stride": 2,
          "stem_0.Conv2d_0.weight.kernel_size": 3,
          "stem_0.Conv2d_0.weight.out_channels": 60,
          "block_0.ChoiceOp_0.depth": 0,
          "block_0.pattern_2.ChoiceOp_0.choice": 3,
          "block_0.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_0.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_0.pattern_2.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_0.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_0.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 8,
          "block_0.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_0.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_0.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_0.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 1,
          "block_0.pattern_2.Conv2d_0.weight.kernel_size": 7,
          "block_0.pattern_2.Conv2d_0.weight.out_channels": 352,
          "block_0.pattern_1.ChoiceOp_0.choice": 4,
          "block_0.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_0.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_0.pattern_1.pooling_0.ChoiceOp_0.pool_mode": 0,
          "block_0.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_0.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_0.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_0.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_0.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_0.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 5,
          "block_0.pattern_1.Conv2d_0.weight.kernel_size": 9,
          "block_0.pattern_1.Conv2d_0.weight.out_channels": 392,
          "block_0.pattern_0.ChoiceOp_0.choice": 3,
          "block_0.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 1,
          "block_0.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 3,
          "block_0.pattern_0.pooling_0.ChoiceOp_0.pool_mode": 1,
          "block_0.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 2,
          "block_0.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 10,
          "block_0.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio": 2,
          "block_0.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice": 1,
          "block_0.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups": 4,
          "block_0.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice": 0,
          "block_0.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups": 30,
          "block_0.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio": 1,
          "block_0.pattern_0.Conv2d_0.stride": 1,
          "block_0.pattern_0.Conv2d_0.weight.kernel_size": 9,
          "block_0.pattern_0.Conv2d_0.weight.out_channels": 72}


def test_symbolic_metrics():
    # params = {'ChoiceOp_0.num_blocks': 4, 'block_9.ChoiceOp_0.residual_choice': 0, 'block_9.ChoiceOp_0.depth': 2, 'block_9.pattern_2.ChoiceOp_0.choice': 3, 'block_9.pattern_2.sandglass_block_0.expansion_0.ChoiceOp_0.choice': 0, 'block_9.pattern_2.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 8, 'block_9.pattern_2.sandglass_block_0.reduction_0.ChoiceOp_0.choice': 1, 'block_9.pattern_2.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 4, 'block_9.pattern_2.pooling_0.ChoiceOp_0.pool_mode': 0, 'block_9.pattern_2.reduce_expand_0.expansion_0.ChoiceOp_0.choice': 0, 'block_9.pattern_2.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 2, 'block_9.pattern_2.reduce_expand_0.reduction_0.ChoiceOp_0.choice': 0, 'block_9.pattern_2.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 1, 'block_9.pattern_2.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio': 4, 'block_9.pattern_2.expand_reduce_0.reduction_0.ChoiceOp_0.choice': 0, 'block_9.pattern_2.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 1, 'block_9.pattern_2.expand_reduce_0.expansion_0.ChoiceOp_0.choice': 0, 'block_9.pattern_2.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 8, 'block_9.pattern_2.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio': 6, 'block_9.pattern_2.Conv2d_0.weight.kernel_size': 3, 'block_9.pattern_2.Conv2d_0.weight.out_channels': 304, 'block_9.pattern_1.ChoiceOp_0.choice': 0, 'block_9.pattern_1.sandglass_block_0.expansion_0.ChoiceOp_0.choice': 1, 'block_9.pattern_1.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 8, 'block_9.pattern_1.sandglass_block_0.reduction_0.ChoiceOp_0.choice': 1, 'block_9.pattern_1.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 1, 'block_9.pattern_1.pooling_0.ChoiceOp_0.pool_mode': 1, 'block_9.pattern_1.reduce_expand_0.expansion_0.ChoiceOp_0.choice': 0, 'block_9.pattern_1.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 1, 'block_9.pattern_1.reduce_expand_0.reduction_0.ChoiceOp_0.choice': 1, 'block_9.pattern_1.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 1, 'block_9.pattern_1.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio': 2, 'block_9.pattern_1.expand_reduce_0.reduction_0.ChoiceOp_0.choice': 1, 'block_9.pattern_1.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 16, 'block_9.pattern_1.expand_reduce_0.expansion_0.ChoiceOp_0.choice': 0, 'block_9.pattern_1.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 2, 'block_9.pattern_1.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio': 6, 'block_9.pattern_1.Conv2d_0.weight.kernel_size': 7, 'block_9.pattern_1.Conv2d_0.weight.out_channels': 288, 'block_9.pattern_0.ChoiceOp_0.choice': 2, 'block_9.pattern_0.sandglass_block_0.expansion_0.ChoiceOp_0.choice': 0, 'block_9.pattern_0.sandglass_block_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 8, 'block_9.pattern_0.sandglass_block_0.reduction_0.ChoiceOp_0.choice': 1, 'block_9.pattern_0.sandglass_block_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 1, 'block_9.pattern_0.pooling_0.ChoiceOp_0.pool_mode': 1, 'block_9.pattern_0.reduce_expand_0.expansion_0.ChoiceOp_0.choice': 0, 'block_9.pattern_0.reduce_expand_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 2, 'block_9.pattern_0.reduce_expand_0.reduction_0.ChoiceOp_0.choice': 0, 'block_9.pattern_0.reduce_expand_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 1, 'block_9.pattern_0.reduce_expand_0.reduction_0.Conv2d_0.weight.reduce_ratio': 2, 'block_9.pattern_0.expand_reduce_0.reduction_0.ChoiceOp_0.choice': 1, 'block_9.pattern_0.expand_reduce_0.reduction_0.grouped_pointwise_0.InterleaveChannels_0.groups': 16, 'block_9.pattern_0.expand_reduce_0.expansion_0.ChoiceOp_0.choice': 1, 'block_9.pattern_0.expand_reduce_0.expansion_0.grouped_pointwise_0.InterleaveChannels_0.groups': 8, 'block_9.pattern_0.expand_reduce_0.expansion_0.Conv2d_0.weight.expand_ratio': 3, 'block_9.pattern_0.Conv2d_0.stride': 2, 'block_9.pattern_0.Conv2d_0.weight.kernel_size': 9, 'block_9.pattern_0.Conv2d_0.weight.out_channels': 288, 'block_8.ChoiceOp_0.residual_choice': 1, ...}
    class DummyModule:
        """ Dummy module with relevant fields to demonstrate usage of
        MacSummaryCallback without the need for an actual ImageClassifierModule
        """
        def __init__(self, model, device, example_feature_array) -> None:
            self.model = model
            self.device = device
            self.example_feature_array = example_feature_array

    input_shape = [1, 3, 32, 32]
    input = Tensor(name="input", shape=input_shape, axis=("N", "C", "H", "W"))
    cons = OmegaConf.create([{"name": "weights"}, {"name": "macs"}])
    space = search_space(name="evn", input=input, num_classes=10, constraints=cons)
    set_parametrization(PARAMS, space.parametrization())

    model = BasicExecutor(space)
    model.initialize()
    input_tensor = torch.ones(input_shape)

    module = DummyModule(model, "cpu", input_tensor)
    metrics_predictor = FxMACSummaryCallback()
    summary = metrics_predictor._do_summary(module)

    mac_summary = summary['total_macs'].item()
    mac_symbolic = space.macs.evaluate()

    assert mac_summary == mac_symbolic

    weight_summary = summary['total_weights'].item()
    weights_symbolic = space.weights.evaluate()

    assert weight_summary == weights_symbolic


if __name__ == '__main__':
    test_symbolic_metrics()
